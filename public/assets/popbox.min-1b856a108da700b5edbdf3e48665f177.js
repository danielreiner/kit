(function(){$.fn.popbox=function(e){var t=$.extend({selector:this.selector,open:".open",box:".box",arrow:".arrow",arrow_border:".arrow-border",close:".close"},e),n={open:function(e){e.preventDefault();var r=$(this),i=$(this).parent().find(t.box);i.find(t.arrow).css({left:i.width()/2-10}),i.find(t.arrow_border).css({left:i.width()/2-10}),i.css("display")=="block"?n.close():i.css({display:"block",top:10,left:r.parent().width()/2-i.width()/2})},close:function(){$(t.box).fadeOut("fast")}};return $(document).bind("keyup",function(e){e.keyCode==27&&n.close()}),$(document).bind("click",function(e){$(e.target).closest(t.selector).length||n.close()}),this.each(function(){$(this).css({width:$(t.box).width()}),$(t.open,this).bind("click",n.open),$(t.open,this).parent().find(t.close).bind("click",function(e){e.preventDefault(),n.close()})})}}).call(this);