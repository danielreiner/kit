// FancyZoom.js - v1.1 - http://www.fancyzoom.com
//
// Copyright (c) 2008 Cabel Sasser / Panic Inc
// All rights reserved.
// 
//     Requires: FancyZoomHTML.js
// Instructions: Include JS files in page, call setupZoom() in onLoad. That's it!
//               Any <a href> links to images will be updated to zoom inline.
//               Add rel="nozoom" to your <a href> to disable zooming for an image.
// 
// Redistribution and use of this effect in source form, with or without modification,
// are permitted provided that the following conditions are met:
// 
// * USE OF SOURCE ON COMMERCIAL (FOR-PROFIT) WEBSITE REQUIRES ONE-TIME LICENSE FEE PER DOMAIN.
//   Reasonably priced! Visit www.fancyzoom.com for licensing instructions. Thanks!
//
// * Non-commercial (personal) website use is permitted without license/payment!
//
// * Redistribution of source code must retain the above copyright notice,
//   this list of conditions and the following disclaimer.
//
// * Redistribution of source code and derived works cannot be sold without specific
//   written prior permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
function setupZoom(){prepZooms(),insertZoomHTML(),zoomdiv=document.getElementById(zoomID),zoomimg=document.getElementById(theID)}function prepZooms(){if(!document.getElementsByTagName)return;var e=document.getElementsByTagName("a");for(i=0;i<e.length;i++)e[i].getAttribute("href")&&e[i].getAttribute("href").search(/(.*)\.(jpg|jpeg|gif|png|bmp|tif|tiff)/gi)!=-1&&e[i].getAttribute("rel")!="nozoom"&&(e[i].onclick=function(e){return zoomClick(this,e)},e[i].onmouseover=function(){zoomPreload(this)})}function zoomPreload(e){var t=e.getAttribute("href");imgPreload.src.indexOf(e.getAttribute("href").substr(e.getAttribute("href").lastIndexOf("/")))==-1&&(preloadActive=!0,imgPreload=new Image,imgPreload.onload=function(){preloadActive=!1},imgPreload.src=t)}function preloadAnimStart(){preloadTime=new Date,document.getElementById("ZoomSpin").style.left=myWidth/2+"px",document.getElementById("ZoomSpin").style.top=myHeight/2+myScroll+"px",document.getElementById("ZoomSpin").style.visibility="visible",preloadFrame=1,document.getElementById("SpinImage").src=zoomImagesURI+"zoom-spin-"+preloadFrame+".png",preloadAnimTimer=setInterval("preloadAnim()",100)}function preloadAnim(e){preloadActive!=0?(document.getElementById("SpinImage").src=zoomImagesURI+"zoom-spin-"+preloadFrame+".png",preloadFrame++,preloadFrame>12&&(preloadFrame=1)):(document.getElementById("ZoomSpin").style.visibility="hidden",clearInterval(preloadAnimTimer),preloadAnimTimer=0,zoomIn(preloadFrom))}function zoomClick(e,t){var n=getShift(t);return!t&&window.event&&(window.event.metaKey||window.event.altKey)?!0:t&&(t.metaKey||t.altKey)?!0:(getSize(),preloadActive==1?preloadAnimTimer==0&&(preloadFrom=e,preloadAnimStart()):zoomIn(e,n),!1)}function zoomIn(e,t){zoomimg.src=e.getAttribute("href"),e.childNodes[0].width?(startW=e.childNodes[0].width,startH=e.childNodes[0].height,startPos=findElementPos(e.childNodes[0])):(startW=50,startH=12,startPos=findElementPos(e)),hostX=startPos[0],hostY=startPos[1],document.getElementById("scroller")&&(hostX-=document.getElementById("scroller").scrollLeft),endW=imgPreload.width,endH=imgPreload.height,zoomActive[theID]!=1&&(document.getElementById("ShadowBox")?document.getElementById("ShadowBox").style.visibility="hidden":browserIsIE||(fadeActive.ZoomImage&&(clearInterval(fadeTimer.ZoomImage),fadeActive.ZoomImage=!1,fadeTimer.ZoomImage=!1),document.getElementById("ZoomImage").style.webkitBoxShadow=shadowSettings+"0.0)"),document.getElementById("ZoomClose").style.visibility="hidden",includeCaption&&(document.getElementById(zoomCaptionDiv).style.visibility="hidden",e.getAttribute("title")&&includeCaption?document.getElementById(zoomCaption).innerHTML=e.getAttribute("title"):document.getElementById(zoomCaption).innerHTML=""),zoomOrigW[theID]=startW,zoomOrigH[theID]=startH,zoomOrigX[theID]=hostX,zoomOrigY[theID]=hostY,zoomimg.style.width=startW+"px",zoomimg.style.height=startH+"px",zoomdiv.style.left=hostX+"px",zoomdiv.style.top=hostY+"px",includeFade==1&&setOpacity(0,zoomID),zoomdiv.style.visibility="visible",sizeRatio=endW/endH,endW>myWidth-minBorder&&(endW=myWidth-minBorder,endH=endW/sizeRatio),endH>myHeight-minBorder&&(endH=myHeight-minBorder,endW=endH*sizeRatio),zoomChangeX=myWidth/2-endW/2-hostX,zoomChangeY=myHeight/2-endH/2-hostY+myScroll,zoomChangeW=endW-startW,zoomChangeH=endH-startH,t?tempSteps=zoomSteps*7:tempSteps=zoomSteps,zoomCurrent=0,includeFade==1?(fadeCurrent=0,fadeAmount=-100/tempSteps):fadeAmount=0,zoomTimer[theID]=setInterval("zoomElement('"+zoomID+"', '"+theID+"', "+zoomCurrent+", "+startW+", "+zoomChangeW+", "+startH+", "+zoomChangeH+", "+hostX+", "+zoomChangeX+", "+hostY+", "+zoomChangeY+", "+tempSteps+", "+includeFade+", "+fadeAmount+", 'zoomDoneIn(zoomID)')",zoomTime),zoomActive[theID]=!0)}function zoomOut(e,t){getShift(t)?tempSteps=zoomSteps*7:tempSteps=zoomSteps,zoomActive[theID]!=1&&(document.getElementById("ShadowBox")?document.getElementById("ShadowBox").style.visibility="hidden":browserIsIE||(fadeActive.ZoomImage&&(clearInterval(fadeTimer.ZoomImage),fadeActive.ZoomImage=!1,fadeTimer.ZoomImage=!1),document.getElementById("ZoomImage").style.webkitBoxShadow=shadowSettings+"0.0)"),document.getElementById("ZoomClose").style.visibility="hidden",includeCaption&&document.getElementById(zoomCaption).innerHTML!=""&&(document.getElementById(zoomCaptionDiv).style.visibility="hidden"),startX=parseInt(zoomdiv.style.left),startY=parseInt(zoomdiv.style.top),startW=zoomimg.width,startH=zoomimg.height,zoomChangeX=zoomOrigX[theID]-startX,zoomChangeY=zoomOrigY[theID]-startY,zoomChangeW=zoomOrigW[theID]-startW,zoomChangeH=zoomOrigH[theID]-startH,zoomCurrent=0,includeFade==1?(fadeCurrent=0,fadeAmount=100/tempSteps):fadeAmount=0,zoomTimer[theID]=setInterval("zoomElement('"+zoomID+"', '"+theID+"', "+zoomCurrent+", "+startW+", "+zoomChangeW+", "+startH+", "+zoomChangeH+", "+startX+", "+zoomChangeX+", "+startY+", "+zoomChangeY+", "+tempSteps+", "+includeFade+", "+fadeAmount+", 'zoomDone(zoomID, theID)')",zoomTime),zoomActive[theID]=!0)}function zoomDoneIn(e,t){zoomOpen=!0,e=document.getElementById(e),document.getElementById("ShadowBox")?(setOpacity(0,"ShadowBox"),shadowdiv=document.getElementById("ShadowBox"),shadowLeft=parseInt(e.style.left)-13,shadowTop=parseInt(e.style.top)-8,shadowWidth=e.offsetWidth+26,shadowHeight=e.offsetHeight+26,shadowdiv.style.width=shadowWidth+"px",shadowdiv.style.height=shadowHeight+"px",shadowdiv.style.left=shadowLeft+"px",shadowdiv.style.top=shadowTop+"px",document.getElementById("ShadowBox").style.visibility="visible",fadeElementSetup("ShadowBox",0,100,5)):browserIsIE||fadeElementSetup("ZoomImage",0,.8,5,0,"shadow"),includeCaption&&document.getElementById(zoomCaption).innerHTML!=""&&(zoomcapd=document.getElementById(zoomCaptionDiv),zoomcapd.style.top=parseInt(e.style.top)+(e.offsetHeight+15)+"px",zoomcapd.style.left=myWidth/2-zoomcapd.offsetWidth/2+"px",zoomcapd.style.visibility="visible"),browserIsIE||setOpacity(0,"ZoomClose"),document.getElementById("ZoomClose").style.visibility="visible",browserIsIE||fadeElementSetup("ZoomClose",0,100,5),document.onkeypress=getKey}function zoomDone(e,t){zoomOpen=!1,zoomOrigH[t]="",zoomOrigW[t]="",document.getElementById(e).style.visibility="hidden",zoomActive[t]==0,document.onkeypress=null}function zoomElement(zoomdiv,theID,zoomCurrent,zoomStartW,zoomChangeW,zoomStartH,zoomChangeH,zoomStartX,zoomChangeX,zoomStartY,zoomChangeY,zoomSteps,includeFade,fadeAmount,execWhenDone){zoomCurrent==zoomSteps+1?(zoomActive[theID]=!1,clearInterval(zoomTimer[theID]),execWhenDone!=""&&eval(execWhenDone)):(includeFade==1&&(fadeAmount<0?setOpacity(Math.abs(zoomCurrent*fadeAmount),zoomdiv):setOpacity(100-zoomCurrent*fadeAmount,zoomdiv)),moveW=cubicInOut(zoomCurrent,zoomStartW,zoomChangeW,zoomSteps),moveH=cubicInOut(zoomCurrent,zoomStartH,zoomChangeH,zoomSteps),moveX=cubicInOut(zoomCurrent,zoomStartX,zoomChangeX,zoomSteps),moveY=cubicInOut(zoomCurrent,zoomStartY,zoomChangeY,zoomSteps),document.getElementById(zoomdiv).style.left=moveX+"px",document.getElementById(zoomdiv).style.top=moveY+"px",zoomimg.style.width=moveW+"px",zoomimg.style.height=moveH+"px",zoomCurrent++,clearInterval(zoomTimer[theID]),zoomTimer[theID]=setInterval("zoomElement('"+zoomdiv+"', '"+theID+"', "+zoomCurrent+", "+zoomStartW+", "+zoomChangeW+", "+zoomStartH+", "+zoomChangeH+", "+zoomStartX+", "+zoomChangeX+", "+zoomStartY+", "+zoomChangeY+", "+zoomSteps+", "+includeFade+", "+fadeAmount+", '"+execWhenDone+"')",zoomTime))}function getKey(e){e?theKey=e.keyCode:theKey=event.keyCode,theKey==27&&zoomOut(this,e)}function fadeOut(e){e.id&&fadeElementSetup(e.id,100,0,10)}function fadeIn(e){e.id&&fadeElementSetup(e.id,0,100,10)}function fadeElementSetup(e,t,n,r,i,s){fadeActive[e]==1?fadeQueue[e]=new Array(e,t,n,r):(fadeSteps=r,fadeCurrent=0,fadeAmount=(t-n)/fadeSteps,fadeTimer[e]=setInterval("fadeElement('"+e+"', '"+fadeCurrent+"', '"+fadeAmount+"', '"+fadeSteps+"')",15),fadeActive[e]=!0,fadeMode[e]=s,i==1?fadeClose[e]=!0:fadeClose[e]=!1)}function fadeElement(e,t,n,r){t==r?(clearInterval(fadeTimer[e]),fadeActive[e]=!1,fadeTimer[e]=!1,fadeClose[e]==1&&(document.getElementById(e).style.visibility="hidden"),fadeQueue[e]&&fadeQueue[e]!=0&&(fadeElementSetup(fadeQueue[e][0],fadeQueue[e][1],fadeQueue[e][2],fadeQueue[e][3]),fadeQueue[e]=!1)):(t++,fadeMode[e]=="shadow"?n<0?document.getElementById(e).style.webkitBoxShadow=shadowSettings+Math.abs(t*n)+")":document.getElementById(e).style.webkitBoxShadow=shadowSettings+(100-t*n)+")":n<0?setOpacity(Math.abs(t*n),e):setOpacity(100-t*n,e),clearInterval(fadeTimer[e]),fadeTimer[e]=setInterval("fadeElement('"+e+"', '"+t+"', '"+n+"', '"+r+"')",15))}function setOpacity(e,t){var n=document.getElementById(t).style;navigator.userAgent.indexOf("Firefox")!=-1&&e==100&&(e=99.9999),n.filter="alpha(opacity="+e+")",n.opacity=e/100}function linear(e,t,n,r){return n*e/r+t}function sineInOut(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t}function cubicIn(e,t,n,r){return n*(e/=r)*e*e+t}function cubicOut(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function cubicInOut(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t}function bounceOut(e,t,n,r){return(e/=r)<1/2.75?n*7.5625*e*e+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t}function getSize(){self.innerHeight?(myWidth=window.innerWidth,myHeight=window.innerHeight,myScroll=window.pageYOffset):document.documentElement&&document.documentElement.clientHeight?(myWidth=document.documentElement.clientWidth,myHeight=document.documentElement.clientHeight,myScroll=document.documentElement.scrollTop):document.body&&(myWidth=document.body.clientWidth,myHeight=document.body.clientHeight,myScroll=document.body.scrollTop),window.innerHeight&&window.scrollMaxY?(myScrollWidth=document.body.scrollWidth,myScrollHeight=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(myScrollWidth=document.body.scrollWidth,myScrollHeight=document.body.scrollHeight):(myScrollWidth=document.body.offsetWidth,myScrollHeight=document.body.offsetHeight)}function getShift(e){var t=!1;return!e&&window.event?t=window.event.shiftKey:e&&(t=e.shiftKey,t&&e.stopPropagation()),t}function findElementPos(e){var t=0,n=0;do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return Array(t,n)}var includeCaption=!0,zoomTime=20,zoomSteps=15,includeFade=1,minBorder=90,shadowSettings="0px 5px 25px rgba(0, 0, 0, ",zoomImagesURI="/images-global/zoom/",myWidth=0,myHeight=0,myScroll=0;myScrollWidth=0,myScrollHeight=0;var zoomOpen=!1,preloadFrame=1,preloadActive=!1,preloadTime=0,imgPreload=new Image,preloadAnimTimer=0,zoomActive=new Array,zoomTimer=new Array,zoomOrigW=new Array,zoomOrigH=new Array,zoomOrigX=new Array,zoomOrigY=new Array,zoomID="ZoomBox",theID="ZoomImage",zoomCaption="ZoomCaption",zoomCaptionDiv="ZoomCapDiv";if(navigator.userAgent.indexOf("MSIE")!=-1)var browserIsIE=!0;var fadeActive=new Array,fadeQueue=new Array,fadeTimer=new Array,fadeClose=new Array,fadeMode=new Array;