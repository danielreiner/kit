window.CodeMirror=function(){function e(n,r){if(!(this instanceof e))return new e(n,r);this.options=r=r||{};for(var i in vi)!r.hasOwnProperty(i)&&vi.hasOwnProperty(i)&&(r[i]=vi[i]);l(r),i=this.display=t(n,"string"==typeof r.value?0:r.value.first),i.wrapper.CodeMirror=this,u(this),r.autofocus&&!Gr&&G(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new cr},s(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var o=r.value;"string"==typeof o&&(o=new ki(r.value,r.mode)),z(this,Hn)(this,o),Fr&&setTimeout(br(Q,this,!0),20),Z(this);var a;try{a=document.activeElement==i.input}catch(f){}a||r.autofocus&&!Gr?setTimeout(br(dt,this),20):vt(this),z(this,function(){for(var e in di)di.propertyIsEnumerable(e)&&di[e](this,r[e],mi);for(e=0;e<wi.length;++e)wi[e](this)})()}function t(e,t){var n={},r=n.input=Sr("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none;");Rr?r.style.width="1000px":r.setAttribute("wrap","off"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),n.inputDiv=Sr("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=Sr("div",[Sr("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=Sr("div",[Sr("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=Sr("div",null,"CodeMirror-scrollbar-filler"),n.lineDiv=Sr("div"),n.selectionDiv=Sr("div",null,null,"position: relative; z-index: 1"),n.cursor=Sr("div"," ","CodeMirror-cursor"),n.otherCursor=Sr("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"),n.measure=Sr("div",null,"CodeMirror-measure"),n.lineSpace=Sr("div",[n.measure,n.selectionDiv,n.lineDiv,n.cursor,n.otherCursor],null,"position: relative; outline: none"),n.mover=Sr("div",[Sr("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Sr("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=Sr("div"," ",null,"position: absolute; height: "+_i+"px"),n.gutters=Sr("div",null,"CodeMirror-gutters"),n.lineGutter=null;var i=Sr("div",[n.sizer,n.heightForcer,n.gutters],null,"position: relative; min-height: 100%");return n.scroller=Sr("div",[i],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Sr("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.scroller],"CodeMirror"),Ir&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),Qr&&(r.style.width="0px"),Rr||(n.scroller.draggable=!0),Vr?(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"):Ir&&(n.scrollbarH.style.minWidth=n.scrollbarV.style.minWidth="18px"),n.viewOffset=n.lastSizeC=0,n.showingFrom=n.showingTo=t,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new cr,n.draggingText=!1,n.cachedCharWidth=n.cachedTextHeight=null,n.measureLineCache=[],n.measureLineCachePos=0,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),t.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),t.doc.frontier=t.doc.first,C(t,100),t.state.modeGen++,t.curOp&&V(t)}function r(e){var t=I(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/q(e.display)-3);return function(i){return dn(e.doc,i)?0:n?(Math.ceil(i.text.length/r)||1)*t:t}}function i(e){var t=e.doc,n=r(e);t.iter(function(e){var t=n(e);t!=e.height&&In(e,t)})}function s(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),_(e)}function o(e){u(e),V(e)}function u(e){var t=e.display.gutters,n=e.options.gutters;xr(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(Sr("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none"}function a(e,t){if(0==t.height)return 0;for(var n=t.text.length,r,i=t;r=cn(i,-1);)r=r.find(),i=Bn(e,r.from.line),n+=r.from.ch-r.to.ch;for(i=t;r=hn(i);)r=r.find(),n-=i.text.length-r.from.ch,i=Bn(e,r.to.line),n+=i.text.length-r.to.ch;return n}function f(e){var t=e.display,n=e.doc;t.maxLine=Bn(n,n.first),t.maxLineLength=a(n,t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var r=a(n,e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)})}function l(e){for(var t=!1,n=0;n<e.gutters.length;++n)"CodeMirror-linenumbers"==e.gutters[n]&&(e.lineNumbers?t=!0:e.gutters.splice(n--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function c(e,t){var n=t+2*e.lineSpace.offsetTop;e.sizer.style.minHeight=e.heightForcer.style.top=n+"px";var n=Math.max(n,e.scroller.scrollHeight),r=e.scroller.scrollWidth>e.scroller.clientWidth,i=n>e.scroller.clientHeight;i?(e.scrollbarV.style.display="block",e.scrollbarV.style.bottom=r?kr(e.measure)+"px":"0",e.scrollbarV.firstChild.style.height=n-e.scroller.clientHeight+e.scrollbarV.clientHeight+"px"):e.scrollbarV.style.display="",r?(e.scrollbarH.style.display="block",e.scrollbarH.style.right=i?kr(e.measure)+"px":"0",e.scrollbarH.firstChild.style.width=e.scroller.scrollWidth-e.scroller.clientWidth+e.scrollbarH.clientWidth+"px"):e.scrollbarH.style.display="",r&&i?(e.scrollbarFiller.style.display="block",e.scrollbarFiller.style.height=e.scrollbarFiller.style.width=kr(e.measure)+"px"):e.scrollbarFiller.style.display="",$r&&0===kr(e.measure)&&(e.scrollbarV.style.minWidth=e.scrollbarH.style.minHeight=Jr?"18px":"12px")}function h(e,t,n){var r=e.scroller.scrollTop,i=e.wrapper.clientHeight;return"number"==typeof n?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-e.lineSpace.offsetTop),e=Math.ceil(r+i),{from:Rn(t,r),to:Rn(t,e)}}function p(e){var t=e.display;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=v(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,i=n+"px",s=t.lineDiv.firstChild;s;s=s.nextSibling)if(s.alignable)for(var o=0,u=s.alignable;o<u.length;++o)u[o].style.left=i;e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function d(e){if(!e.options.lineNumbers)return!1;var t=e.doc,t=""+e.options.lineNumberFormatter(t.first+t.size-1+e.options.firstLineNumber),e=e.display;if(t.length!=e.lineNumChars){var n=e.measure.appendChild(Sr("div",[Sr("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt")),r=n.firstChild.offsetWidth,n=n.offsetWidth-r;return e.lineGutter.style.width="",e.lineNumInnerWidth=Math.max(r,e.lineGutter.offsetWidth-n),e.lineNumWidth=e.lineNumInnerWidth+n,e.lineNumChars=e.lineNumInnerWidth?t.length:-1,e.lineGutter.style.width=e.lineNumWidth+"px",!0}return!1}function v(e){return Cr(e.scroller).left-Cr(e.sizer).left}function m(e,t,n){var r=e.display.showingFrom,i=e.display.showingTo;if(t=g(e,t,n))ar(e,"update",e),(e.display.showingFrom!=r||e.display.showingTo!=i)&&ar(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo);return x(e),c(e.display,e.doc.height),t}function g(e,t,n){var r=e.display,i=e.doc;if(r.wrapper.clientWidth){var s=h(r,i,n);if(!(0==t.length&&s.from>r.showingFrom&&s.to<r.showingTo)){d(e)&&(t=[{from:i.first,to:i.first+i.size}]);var o=r.sizer.style.marginLeft=r.gutters.offsetWidth+"px";r.scrollbarH.style.left=e.options.fixedGutter?o:"0";var u=Infinity;if(e.options.lineNumbers)for(o=0;o<t.length;++o)if(t[o].diff){u=t[o].from;break}var o=i.first+i.size,a=Math.max(s.from-e.options.viewportMargin,i.first),s=Math.min(o,s.to+e.options.viewportMargin);r.showingFrom<a&&20>a-r.showingFrom&&(a=Math.max(i.first,r.showingFrom)),r.showingTo>s&&20>r.showingTo-s&&(s=Math.min(o,r.showingTo));if(ii)for(a=qn(pn(i,Bn(i,a)));s<o&&dn(i,Bn(i,s));)++s;var f=[{from:Math.max(r.showingFrom,i.first),to:Math.min(r.showingTo,o)}],f=f[0].from>=f[0].to?[]:b(f,t);if(ii)for(o=0;o<f.length;++o)for(var t=f[o],l;l=hn(Bn(i,t.to-1));){if(l=l.find().from.line,!(l>t.from)){f.splice(o--,1);break}t.to=l}for(o=l=0;o<f.length;++o)t=f[o],t.from<a&&(t.from=a),t.to>s&&(t.to=s),t.from>=t.to?f.splice(o--,1):l+=t.to-t.from;if(l!=s-a||a!=r.showingFrom||s!=r.showingTo){f.sort(function(e,t){return e.from-t.from}),o=document.activeElement,l<.7*(s-a)&&(r.lineDiv.style.display="none"),E(e,a,s,f,u),r.lineDiv.style.display="",document.activeElement!=o&&o.offsetHeight&&o.focus();if(a!=r.showingFrom||s!=r.showingTo||r.lastSizeC!=r.wrapper.clientHeight)r.lastSizeC=r.wrapper.clientHeight;r.showingFrom=a,r.showingTo=s,C(e,100),u=r.lineDiv.offsetTop;for(a=r.lineDiv.firstChild;a;a=a.nextSibling)if(a.lineObj&&(Ir?(f=a.offsetTop+a.offsetHeight,o=f-u,u=f):(o=Cr(a),o=o.bottom-o.top),f=a.lineObj.height-o,2>o&&(o=I(r)),.001<f||-0.001>f))if(In(a.lineObj,o),f=a.lineObj.widgets)for(o=0;o<f.length;++o)f[o].height=f[o].node.offsetHeight;return y(e),h(r,i,n).to>s&&g(e,[],n),!0}y(e)}}else r.showingFrom=r.showingTo=i.first,r.viewOffset=0}function y(e){var t=e.display.viewOffset=Un(e,Bn(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function b(e,t){for(var n=0,r=t.length||0;n<r;++n){for(var i=t[n],s=[],o=i.diff||0,u=0,a=e.length;u<a;++u){var f=e[u];i.to<=f.from&&i.diff?s.push({from:f.from+o,to:f.to+o}):i.to<=f.from||i.from>=f.to?s.push(f):(i.from>f.from&&s.push({from:f.from,to:i.from}),i.to<f.to&&s.push({from:i.to+o,to:f.to+o}))}e=s}return e}function w(e){for(var t=e.display,n={},r={},i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:v(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function E(e,t,n,r,i){function s(t){var n=t.nextSibling;return Rr&&Yr&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):t.parentNode.removeChild(t),n}var o=w(e),u=e.display,a=e.options.lineNumbers;!r.length&&(!Rr||!e.display.currentWheelTarget)&&xr(u.lineDiv);var f=u.lineDiv,l=f.firstChild,c=r.shift(),h=t;for(e.doc.iter(t,n,function(t){c&&c.to==h&&(c=r.shift());if(dn(e.doc,t)){if(0!=t.height&&In(t,0),t.widgets&&l.previousSibling)for(var n=0;n<t.widgets.length;++n)if(t.widgets[n].showIfHidden){var u=l.previousSibling;if(/pre/i.test(u.nodeName)){var p=Sr("div",null,null,"position: relative");u.parentNode.replaceChild(p,u),p.appendChild(u),u=p}p=u.appendChild(Sr("div",[t.widgets[n].node],"CodeMirror-linewidget")),S(t.widgets[n],p,u,o)}}else if(c&&c.from<=h&&c.to>h){for(;l.lineObj!=t;)l=s(l);a&&i<=h&&l.lineNumber&&Nr(l.lineNumber,""+e.options.lineNumberFormatter(h+e.options.firstLineNumber)),l=l.nextSibling}else{if(t.widgets)for(var d=0,v=l;v&&20>d;++d,v=v.nextSibling)if(v.lineObj==t&&/div/i.test(v.nodeName)){n=v;break}var d=e,m=h,g=n,v=kn(d,t),y=t.gutterMarkers,b=d.display;if(!d.options.lineNumbers&&!y&&!t.bgClass&&!t.wrapClass&&!t.widgets)u=v;else{if(g){g.alignable=null;for(var w=!0,E=0,x=g.firstChild,T;x;x=T)if(T=x.nextSibling,/\bCodeMirror-linewidget\b/.test(x.className)){for(var N=0,C=!0;N<t.widgets.length;++N){var k=t.widgets[N],L=!1;k.above||(L=C,C=!1);if(k.node==x.firstChild){S(k,x,g,o),++E,L&&g.insertBefore(v,x);break}}if(N==t.widgets.length){w=!1;break}}else g.removeChild(x);w&&E==t.widgets.length&&(u=g,g.className=t.wrapClass||"")}u||(u=Sr("div",null,t.wrapClass,"position: relative"),u.appendChild(v)),t.bgClass&&u.insertBefore(Sr("div"," ",t.bgClass+" CodeMirror-linebackground"),u.firstChild);if(d.options.lineNumbers||y){p=u.insertBefore(Sr("div",null,null,"position: absolute; left: "+(d.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px"),u.firstChild),d.options.fixedGutter&&(u.alignable||(u.alignable=[])).push(p),d.options.lineNumbers&&(!y||!y["CodeMirror-linenumbers"])&&(u.lineNumber=p.appendChild(Sr("div",""+d.options.lineNumberFormatter(m+d.options.firstLineNumber),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+b.lineNumInnerWidth+"px")));if(y)for(N=0;N<d.options.gutters.length;++N)k=d.options.gutters[N],(m=y.hasOwnProperty(k)&&y[k])&&p.appendChild(Sr("div",[m],"CodeMirror-gutter-elt","left: "+o.gutterLeft[k]+"px; width: "+o.gutterWidth[k]+"px"))}Ir&&(u.style.zIndex=2);if(t.widgets&&u!=g){N=0;for(g=t.widgets;N<g.length;++N)k=g[N],y=Sr("div",[k.node],"CodeMirror-linewidget"),S(k,y,u,o),k.above?u.insertBefore(y,d.options.lineNumbers&&0!=t.height?p:v):u.appendChild(y),ar(k,"redraw")}}if(u!=n)f.insertBefore(u,l);else{for(;l!=n;)l=s(l);l=l.nextSibling}u.lineObj=t}++h});l;)l=s(l)}function S(e,t,n,r){e.noHScroll&&((n.alignable||(n.alignable=[])).push(t),n=r.wrapperWidth,t.style.left=r.fixedPos+"px",e.coverGutter||(n-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=n+"px"),e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function x(e){var t=e.display,n=At(e.doc.sel.from,e.doc.sel.to);if(n||e.options.showCursorWhenSelecting){var r=e.display,i=H(e,e.doc.sel.head,"div");r.cursor.style.left=i.left+"px",r.cursor.style.top=i.top+"px",r.cursor.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",r.cursor.style.display="",i.other?(r.otherCursor.style.display="",r.otherCursor.style.left=i.other.left+"px",r.otherCursor.style.top=i.other.top+"px",r.otherCursor.style.height=.85*(i.other.bottom-i.other.top)+"px"):r.otherCursor.style.display="none"}else t.cursor.style.display=t.otherCursor.style.display="none";n?t.selectionDiv.style.display="none":T(e),e=H(e,e.doc.sel.head,"div"),n=Cr(t.wrapper),r=Cr(t.lineDiv),t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,e.top+r.top-n.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,e.left+r.left-n.left))+"px"}function T(e){function t(e,t,n,r){0>t&&(t=0),o.appendChild(Sr("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function n(n,r,s,o){var f=Bn(i,n),l=f.text.length,c=o?Infinity:-Infinity;return Ar(zn(f),r||0,null==s?l:s,function(i,h,p){var d=P(e,Lt(n,"rtl"==p?h-1:i),"div",f),p=P(e,Lt(n,"rtl"==p?i:h-1),"div",f),v=d.left,m=p.right;3<p.top-d.top&&(t(v,d.top,null,d.bottom),v=a,d.bottom<p.top&&t(v,d.bottom,null,p.top)),null==s&&h==l&&(m=u),null==r&&0==i&&(v=a),c=o?Math.min(p.top,c):Math.max(p.bottom,c),v<a+1&&(v=a),t(v,p.top,m-v,p.bottom)}),c}var r=e.display,i=e.doc,s=e.doc.sel,o=document.createDocumentFragment(),u=r.lineSpace.offsetWidth,a=Tr(e.display.measure,Sr("pre",null,null,"text-align: left")).appendChild(Sr("span","x")).offsetLeft;if(s.from.line==s.to.line)n(s.from.line,s.from.ch,s.to.ch);else{for(var f=Bn(i,s.from.line),l=f,c=[s.from.line,s.from.ch],h;l=hn(l);){l=l.find(),c.push(l.from.ch,l.to.line,l.to.ch);if(l.to.line==s.to.line){c.push(s.to.ch),h=!0;break}l=Bn(i,l.to.line)}if(h)for(s=0;s<c.length;s+=3)n(c[s],c[s+1],c[s+2]);else c=Bn(i,s.to.line),f=s.from.ch?n(s.from.line,s.from.ch,null,!1):Un(e,f)-r.viewOffset,s=s.to.ch?n(s.to.line,cn(c,-1)?null:0,s.to.ch,!0):Un(e,c)-r.viewOffset,f<s&&t(a,f,null,s)}Tr(r.selectionDiv,o),r.selectionDiv.style.display=""}function N(e){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.offsetHeight&&(t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden")},e.options.cursorBlinkRate)}function C(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,br(k,e))}function k(e){var t=e.doc;t.frontier<t.first&&(t.frontier=t.first);if(!(t.frontier>=e.display.showingTo)){var n=+(new Date)+e.options.workTime,r=Kt(t.mode,A(e,t.frontier)),i=[],s;t.iter(t.frontier,Math.min(t.first+t.size,e.display.showingTo+500),function(o){if(t.frontier>=e.display.showingFrom){var u=o.styles;o.styles=Tn(e,o,r);for(var a=!u||u.length!=o.styles.length,f=0;!a&&f<u.length;++f)a=u[f]!=o.styles[f];a&&(s&&s.end==t.frontier?s.end++:i.push(s={start:t.frontier,end:t.frontier+1})),o.stateAfter=Kt(t.mode,r)}else Nn(e,o,r),o.stateAfter=t.frontier%5==0?Kt(t.mode,r):null;++t.frontier;if(+(new Date)>n)return C(e,e.options.workDelay),!0}),i.length&&z(e,function(){for(var e=0;e<i.length;++e)V(this,i[e].start,i[e].end)})()}}function L(e,t){for(var n,r,i=e.doc,s=t,o=t-100;s>o;--s){if(s<=i.first)return i.first;var u=Bn(i,s-1);if(u.stateAfter)return s;u=hr(u.text,null,e.options.tabSize);if(null==r||n>u)r=s-1,n=u}return r}function A(e,t){var n=e.doc,r=e.display;if(!n.mode.startState)return!0;var i=L(e,t),s=i>n.first&&Bn(n,i-1).stateAfter,s=s?Kt(n.mode,s):Qt(n.mode);return n.iter(i,t,function(o){Nn(e,o,s),o.stateAfter=i==t-1||0==i%5||i>=r.showingFrom&&i<r.showingTo?Kt(n.mode,s):null,++i}),s}function O(e,t,n,r){for(var i=-1,r=r||M(e,t),e=n;;e+=i){var s=r[e];if(s)break;0>i&&0==e&&(i=1)}return{left:e<n?s.right:s.left,right:e>n?s.left:s.right,top:s.top,bottom:s.bottom}}function M(e,t){for(var n=e.display,r=e.display.measureLineCache,i=0;i<r.length;++i){var s=r[i];if(s.text==t.text&&s.markedSpans==t.markedSpans&&n.scroller.clientWidth==s.width&&s.classes==t.textClass+"|"+t.bgClass+"|"+t.wrapClass)return s.measure}var o=e.display,u=yr(t.text.length),s=kn(e,t,u);if(Fr&&!Ir&&!e.options.lineWrapping&&100<s.childNodes.length){for(var a=document.createDocumentFragment(),f=s.childNodes.length,i=0,l=Math.ceil(f/10);i<l;++i){for(var c=Sr("div",null,null,"display: inline-block"),h=0;10>h&&f;++h)c.appendChild(s.firstChild),--f;a.appendChild(c)}s.appendChild(a)}Tr(o.measure,s),f=Cr(o.lineDiv),l=[],a=yr(t.text.length),c=s.offsetHeight,qr&&o.measure.first!=s&&Tr(o.measure,s);for(i=0;i<u.length;++i)if(o=u[i]){for(var p=Cr(o),d=Math.max(0,p.top-f.top),v=Math.min(p.bottom-f.top,c),h=0;h<l.length;h+=2){var m=l[h],g=l[h+1];if(!(m>v||g<d))if(m<=d&&g>=v||d<=m&&v>=g||Math.min(v,g)-Math.max(d,m)>=v-d>>1){l[h]=Math.min(d,m),l[h+1]=Math.max(v,g);break}}h==l.length&&l.push(d,v),d=p.right,o.measureRight&&(d=Cr(o.measureRight).left),a[i]={left:p.left-f.left,right:d-f.left,top:h}}for(i=0;i<a.length;++i)if(o=a[i])u=o.top,o.top=l[u],o.bottom=l[u+1];return e.options.lineWrapping||(i=s.lastChild,3==i.nodeType&&(i=s.appendChild(Sr("span","​"))),a.width=Cr(i).right-f.left),s={text:t.text,width:n.scroller.clientWidth,markedSpans:t.markedSpans,measure:a,classes:t.textClass+"|"+t.bgClass+"|"+t.wrapClass},16==r.length?r[++n.measureLineCachePos%16]=s:r.push(s),a}function _(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.display.maxLineChanged=!0,e.display.lineNumChars=null}function D(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=bn(t.widgets[i]);n.top+=s,n.bottom+=s}return"line"==r?n:(r||(r="local"),t=Un(e,t),"local"!=r&&(t-=e.display.viewOffset),"page"==r&&(e=Cr(e.display.lineSpace),t+=e.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop),e=e.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft),n.left+=e,n.right+=e),n.top+=t,n.bottom+=t,n)}function P(e,t,n,r){return r||(r=Bn(e.doc,t.line)),D(e,r,O(e,r,t.ch),n)}function H(e,t,n,r,i){function s(t,s){var o=O(e,r,t,i);return s?o.left=o.right:o.right=o.left,D(e,r,o,n)}r=r||Bn(e.doc,t.line),i||(i=M(e,r));var o=zn(r),t=t.ch;if(!o)return s(t);for(var u,a,f=o[0].level,l=0;l<o.length;++l){var c=o[l],h=c.level%2,p;if(c.from<t&&c.to>t)return s(t,h);var d=h?c.from:c.to;(h?c.to:c.from)==t?(c=l&&c.level<(p=o[l-1]).level?s(p.level%2?p.from:p.to-1,!0):s(h&&c.from!=c.to?t-1:t),h==f?u=c:a=c):d==t&&(p=l<o.length-1&&o[l+1],h||!p||p.from!=p.to)&&(c=p&&c.level<p.level?s(p.level%2?p.to-1:p.from):s(h?t:t-1,!0),h==f?u=c:a=c)}return f&&!t&&(a=s(o[0].to-1)),u?(a&&(u.other=a),u):a}function B(e,t,n){return e=new Lt(e,t),n&&(e.outside=!0),e}function j(e,t,n){var r=e.doc,n=n+e.display.viewOffset;if(0>n)return B(r.first,0,!0);var i=Rn(r,n),s=r.first+r.size-1;if(i>s)return B(r.first+r.size-1,Bn(r,s).text.length,!0);for(0>t&&(t=0);;){var s=Bn(r,i),i=F(e,s,i,t,n),o=(s=hn(s))&&s.find();if(!(s&&i.ch>=o.from.ch))return i;i=o.to.line}}function F(e,t,n,r,i){function s(r){return r=H(e,Lt(n,r),"line",t,f),u=!0,o>r.bottom?Math.max(0,r.left-a):o<r.top?r.left+a:(u=!1,r.left)}var o=i-Un(e,t),u=!1,a=e.display.wrapper.clientWidth,f=M(e,t),l=zn(t),c=t.text.length,h=Mr(t),p=_r(t),d=s(h),i=u,v=s(p),m=u;if(r>v)return B(n,p,m);for(;;){if(l?p==h||p==Hr(t,h,1):1>=p-h){for(h=(r=r-d<v-r)?h:p;Bi.test(t.text.charAt(h));)++h;return i=B(n,h,r?i:m),i.after=r,i}var g=Math.ceil(c/2),y=h+g;if(l)for(var y=h,b=0;b<g;++b)y=Hr(t,y,1);b=s(y);if(b>r){p=y,v=b;if(m=u)v+=1e3;c-=g}else h=y,d=b,i=u,c=g}}function I(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==si){si=Sr("pre");for(var t=0;49>t;++t)si.appendChild(document.createTextNode("x")),si.appendChild(Sr("br"));si.appendChild(document.createTextNode("x"))}return Tr(e.measure,si),t=si.offsetHeight/50,3<t&&(e.cachedTextHeight=t),xr(e.measure),t||1}function q(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=Sr("span","x"),n=Sr("pre",[t]);return Tr(e.measure,n),t=t.offsetWidth,2<t&&(e.cachedCharWidth=t),t||10}function R(e){e.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,updateMaxLine:!1,updateScrollPos:!1,id:++oi},Mi++||(Oi=[])}function U(e){var t=e.curOp,n=e.doc,r=e.display;e.curOp=null,t.updateMaxLine&&f(e);if(r.maxLineChanged&&!e.options.lineWrapping){var i=M(e,r.maxLine).width;r.sizer.style.minWidth=Math.max(0,i+3+_i)+"px",r.maxLineChanged=!1,i=Math.max(0,r.sizer.offsetLeft+r.sizer.offsetWidth-r.scroller.clientWidth),i<n.scrollLeft&&!t.updateScrollPos&&ot(e,Math.min(r.scroller.scrollLeft,i),!0)}var s,o;t.updateScrollPos?s=t.updateScrollPos:t.selectionChanged&&r.scroller.clientHeight&&(s=H(e,n.sel.head),s=Rt(e,s.left,s.top,s.left,s.bottom));if(t.changes.length||s&&null!=s.scrollTop)o=m(e,t.changes,s&&s.scrollTop);!o&&t.selectionChanged&&x(e);if(t.updateScrollPos)r.scroller.scrollTop=r.scrollbarV.scrollTop=n.scrollTop=s.scrollTop,r.scroller.scrollLeft=r.scrollbarH.scrollLeft=n.scrollLeft=s.scrollLeft,p(e);else if(s&&(n=It(e,e.doc.sel.head),e.state.focused)){r=e.display,s=Cr(r.sizer),o=null,0>n.top+s.top?o=!0:n.bottom+s.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1);if(null!=o&&!Kr){if(s="none"==r.cursor.style.display)r.cursor.style.display="",r.cursor.style.left=n.left+"px",r.cursor.style.top=n.top-r.viewOffset+"px";r.cursor.scrollIntoView(o),s&&(r.cursor.style.display="none")}}t.selectionChanged&&N(e),e.state.focused&&t.updateInput&&Q(e,t.userSelChange),n=t.maybeHiddenMarkers,r=t.maybeUnhiddenMarkers;if(n)for(o=0;o<n.length;++o)n[o].lines.length||ur(n[o],"hide");if(r)for(o=0;o<r.length;++o)r[o].lines.length&&ur(r[o],"unhide");var u;--Mi||(u=Oi,Oi=null),t.textChanged&&ur(e,"change",e,t.textChanged),t.selectionChanged&&ur(e,"cursorActivity",e);if(u)for(o=0;o<u.length;++o)u[o]()}function z(e,t){return function(){var n=e||this,r=!n.curOp;r&&R(n);try{var i=t.apply(n,arguments)}finally{r&&U(n)}return i}}function W(e){return function(){var t=this.cm&&!this.cm.curOp,n;t&&R(this.cm);try{n=e.apply(this,arguments)}finally{t&&U(this.cm)}return n}}function X(e,t){var n=!e.curOp,r;n&&R(e);try{r=t()}finally{n&&U(e)}return r}function V(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:n,diff:r})}function $(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){K(e),e.state.focused&&$(e)})}function J(e){function t(){!K(e)&&!n?(n=!0,e.display.poll.set(60,t)):(e.display.pollingFast=!1,$(e))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function K(e){var t=e.display.input,n=e.display.prevInput,r=e.doc,i=r.sel;if(!e.state.focused||Ui(t)||Y(e))return!1;var s=t.value;if(s==n&&At(i.from,i.to))return!1;if(Fr&&s&&0===t.selectionStart)return Q(e,!0),!1;var o=!e.curOp;o&&R(e),i.shift=!1;for(var u=0,a=Math.min(n.length,s.length);u<a&&n[u]==s[u];)++u;return a=i.from,i=i.to,u<n.length?a=Lt(a.line,a.ch-(n.length-u)):e.state.overwrite&&At(a,i)&&!e.state.pasteIncoming&&(i=Lt(i.line,Math.min(Bn(r,i.line).text.length,i.ch+(s.length-u)))),n=e.curOp.updateInput,Et(e.doc,{from:a,to:i,text:Ri(s.slice(u)),origin:e.state.pasteIncoming?"paste":"+input"},"end"),e.curOp.updateInput=n,1e3<s.length?t.value=e.display.prevInput="":e.display.prevInput=s,o&&U(e),e.state.pasteIncoming=!1,!0}function Q(e,t){var n,r,i=e.doc;At(i.sel.from,i.sel.to)?t&&(e.display.prevInput=e.display.input.value=""):(e.display.prevInput="",n=zi&&(100<i.sel.to.line-i.sel.from.line||1e3<(r=e.getSelection()).length),e.display.input.value=n?"-":r||e.getSelection(),e.state.focused&&vr(e.display.input)),e.display.inaccurateSelection=n}function G(e){"nocursor"!=e.options.readOnly&&(!Gr||document.activeElement!=e.display.input)&&e.display.input.focus()}function Y(e){return e.options.readOnly||e.doc.cantEdit}function Z(e){function t(){e.state.focused&&setTimeout(br(G,e),0)}function n(){o.cachedCharWidth=o.cachedTextHeight=null,_(e),X(e,br(V,e))}function r(){for(var e=o.wrapper.parentNode;e&&e!=document.body;e=e.parentNode);e?setTimeout(r,5e3):or(window,"resize",n)}function i(t){(!e.options.onDragEvent||!e.options.onDragEvent(e,er(t)))&&rr(t)}function s(){o.inaccurateSelection&&(o.prevInput="",o.inaccurateSelection=!1,o.input.value=e.getSelection(),vr(o.input))}var o=e.display;sr(o.scroller,"mousedown",z(e,nt)),sr(o.scroller,"dblclick",z(e,tr)),sr(o.lineSpace,"selectstart",function(e){et(o,e)||tr(e)}),ni||sr(o.scroller,"contextmenu",function(t){mt(e,t)}),sr(o.scroller,"scroll",function(){st(e,o.scroller.scrollTop),ot(e,o.scroller.scrollLeft,!0),ur(e,"scroll",e)}),sr(o.scrollbarV,"scroll",function(){st(e,o.scrollbarV.scrollTop)}),sr(o.scrollbarH,"scroll",function(){ot(e,o.scrollbarH.scrollLeft)}),sr(o.scroller,"mousewheel",function(t){ut(e,t)}),sr(o.scroller,"DOMMouseScroll",function(t){ut(e,t)}),sr(o.scrollbarH,"mousedown",t),sr(o.scrollbarV,"mousedown",t),sr(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0}),sr(window,"resize",n),setTimeout(r,5e3),sr(o.input,"keyup",z(e,function(t){(!e.options.onKeyEvent||!e.options.onKeyEvent(e,er(t)))&&16==t.keyCode&&(e.doc.sel.shift=!1)})),sr(o.input,"input",br(J,e)),sr(o.input,"keydown",z(e,ht)),sr(o.input,"keypress",z(e,pt)),sr(o.input,"focus",br(dt,e)),sr(o.input,"blur",br(vt,e)),e.options.dragDrop&&(sr(o.scroller,"dragstart",function(t){var n=e;if(!et(n.display,t)){var r=n.getSelection();t.dataTransfer.setData("Text",r),t.dataTransfer.setDragImage&&!Xr&&(r=Sr("img",null,null,"position: fixed; left: 0; top: 0;"),Wr&&(r.width=r.height=1,n.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),Wr&&r.parentNode.removeChild(r))}}),sr(o.scroller,"dragenter",i),sr(o.scroller,"dragover",i),sr(o.scroller,"drop",z(e,rt))),sr(o.scroller,"paste",function(t){et(o,t)||(G(e),J(e))}),sr(o.input,"paste",function(){e.state.pasteIncoming=!0,J(e)}),sr(o.input,"cut",s),sr(o.input,"copy",s),Vr&&sr(o.sizer,"mouseup",function(){document.activeElement==o.input&&o.input.blur(),G(e)})}function et(e,t){for(var n=t.target||t.srcElement;n!=e.wrapper;n=n.parentNode)if(!n||/\bCodeMirror-(?:line)?widget\b/.test(n.className)||n.parentNode==e.sizer&&n!=e.mover)return!0}function tt(e,t,n){var r=e.display;if(!n&&(n=t.target||t.srcElement,n==r.scrollbarH||n==r.scrollbarH.firstChild||n==r.scrollbarV||n==r.scrollbarV.firstChild||n==r.scrollbarFiller))return null;var i,s,r=Cr(r.lineSpace);try{i=t.clientX,s=t.clientY}catch(o){return null}return j(e,i-r.left,s-r.top)}function nt(e){function t(e){if("single"==l)Ht(i.doc,_t(o,a),e);else if(d=_t(o,d),v=_t(o,v),"double"==l){var t=Vt(Bn(o,e.line).text,e);Ot(e,d)?Ht(i.doc,t.from,v):Ht(i.doc,d,t.to)}else"triple"==l&&(Ot(e,d)?Ht(i.doc,v,_t(o,Lt(e.line,0))):Ht(i.doc,d,_t(o,Lt(e.line+1,0))))}function n(e){var r=++g,u=tt(i,e,!0);if(u)if(At(u,c)){var a=e.clientY<m.top?-20:e.clientY>m.bottom?20:0;a&&setTimeout(z(i,function(){g==r&&(s.scroller.scrollTop+=a,n(e))}),50)}else{i.state.focused||dt(i),c=u,t(u);var f=h(s,o);(u.line>=f.to||u.line<f.from)&&setTimeout(z(i,function(){g==r&&n(e)}),150)}}function r(e){g=Infinity;var n=tt(i,e);n&&t(n),tr(e),G(i),or(document,"mousemove",y),or(document,"mouseup",b)}var i=this,s=i.display,o=i.doc,u=o.sel;u.shift=e.shiftKey;if(et(s,e))Rr||(s.scroller.draggable=!1,setTimeout(function(){s.scroller.draggable=!0},100));else if(!it(i,e)){var a=tt(i,e);switch(ir(e)){case 3:ni&&mt.call(i,i,e);return;case 2:a&&Ht(i.doc,a),setTimeout(br(G,i),20),tr(e);return}if(a){i.state.focused||dt(i);var f=+(new Date),l="single";ai&&ai.time>f-400&&At(ai.pos,a)?(l="triple",tr(e),setTimeout(br(G,i),20),$t(i,a.line)):ui&&ui.time>f-400&&At(ui.pos,a)?(l="double",ai={time:f,pos:a},tr(e),f=Vt(Bn(o,a.line).text,a),Ht(i.doc,f.from,f.to)):ui={time:f,pos:a};var c=a;if(i.options.dragDrop&&ji&&!Y(i)&&!At(u.from,u.to)&&!Ot(a,u.from)&&!Ot(u.to,a)&&"single"==l){var p=z(i,function(t){Rr&&(s.scroller.draggable=!1),i.state.draggingText=!1,or(document,"mouseup",p),or(s.scroller,"drop",p),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(tr(t),Ht(i.doc,a),G(i))});Rr&&(s.scroller.draggable=!0),i.state.draggingText=p,s.scroller.dragDrop&&s.scroller.dragDrop(),sr(document,"mouseup",p),sr(s.scroller,"drop",p)}else{tr(e),"single"==l&&Ht(i.doc,_t(o,a));var d=u.from,v=u.to,m=Cr(s.wrapper),g=0,y=z(i,function(e){!Fr&&!ir(e)?r(e):n(e)}),b=z(i,r);sr(document,"mousemove",y),sr(document,"mouseup",b)}}else(e.target||e.srcElement)==s.scroller&&tr(e)}}function rt(e){var t=this;if(!(et(t.display,e)||t.options.onDragEvent&&t.options.onDragEvent(t,er(e)))){tr(e);var n=tt(t,e,!0),r=e.dataTransfer.files;if(n&&!Y(t))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,s=Array(i),o=0,e=function(e,r){var u=new FileReader;u.onload=function(){s[r]=u.result,++o==i&&(n=_t(t.doc,n),kt(t.doc,s.join(""),n,"around","paste"))},u.readAsText(e)},u=0;u<i;++u)e(r[u],u);else if(t.state.draggingText&&!Ot(n,t.doc.sel.from)&&!Ot(t.doc.sel.to,n))t.state.draggingText(e),setTimeout(br(G,t),20);else try{if(s=e.dataTransfer.getData("Text")){var u=t.doc.sel.from,a=t.doc.sel.to;Bt(t.doc,n,n),t.state.draggingText&&kt(t.doc,"",u,a,"paste"),t.replaceSelection(s,null,"paste"),G(t),dt(t)}}catch(f){}}}function it(e,t){var n=e.display;try{var r=t.clientX,i=t.clientY}catch(s){return!1}if(r>=Math.floor(Cr(n.gutters).right))return!1;tr(t);if(!lr(e,"gutterClick"))return!0;var o=Cr(n.lineDiv);if(i>o.bottom)return!0;i-=o.top-n.viewOffset;for(o=0;o<e.options.gutters.length;++o){var u=n.gutters.childNodes[o];if(u&&Cr(u).right>=r){n=Rn(e.doc,i),ar(e,"gutterClick",e,n,e.options.gutters[o],t);break}}return!0}function st(e,t){2>Math.abs(e.doc.scrollTop-t)||(e.doc.scrollTop=t,jr||m(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),jr&&m(e,[]))}function ot(e,t,n){!(n?t==e.doc.scrollLeft:2>Math.abs(e.doc.scrollLeft-t))&&(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,p(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t)&&(e.display.scrollbarH.scrollLeft=t)}function ut(e,t){var n=t.wheelDeltaX,r=t.wheelDeltaY;null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta);if(r&&Yr&&Rr)for(var i=t.target;i!=o;i=i.parentNode)if(i.lineObj){e.display.currentWheelTarget=i;break}var s=e.display,o=s.scroller;if(n&&!jr&&!Wr&&null!=li)r&&st(e,Math.max(0,Math.min(o.scrollTop+r*li,o.scrollHeight-o.clientHeight))),ot(e,Math.max(0,Math.min(o.scrollLeft+n*li,o.scrollWidth-o.clientWidth))),tr(t),s.wheelStartX=null;else{if(r&&null!=li){var i=r*li,u=e.doc.scrollTop,a=u+s.wrapper.clientHeight;0>i?u=Math.max(0,u+i-50):a=Math.min(e.doc.height,a+i+50),m(e,[],{top:u,bottom:a})}20>fi&&(null==s.wheelStartX?(s.wheelStartX=o.scrollLeft,s.wheelStartY=o.scrollTop,s.wheelDX=n,s.wheelDY=r,setTimeout(function(){if(s.wheelStartX!=null){var e=o.scrollLeft-s.wheelStartX,t=o.scrollTop-s.wheelStartY,e=t&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX;s.wheelStartX=s.wheelStartY=null,e&&(li=(li*fi+e)/(fi+1),++fi)}},200)):(s.wheelDX+=n,s.wheelDY+=r))}}function at(e,t,n){if("string"==typeof t&&(t=Ei[t],!t))return!1;e.display.pollingFast&&K(e)&&(e.display.pollingFast=!1);var r=e.doc,i=r.sel.shift,s=!1;try{Y(e)&&(e.state.suppressEdits=!0),n&&(r.sel.shift=!1),s=t(e)!=Di}finally{r.sel.shift=i,e.state.suppressEdits=!1}return s}function ft(e){var t=e.state.keyMaps.slice(0);return t.push(e.options.keyMap),e.options.extraKeys&&t.unshift(e.options.extraKeys),t}function lt(e,t){var n=Gt(e.options.keyMap),r=n.auto;clearTimeout(ci),r&&!Zt(t)&&(ci=setTimeout(function(){Gt(e.options.keyMap)==n&&(e.options.keyMap=r.call?r.call(null,e):r)},50));var i=en
(t,!0),s=!1;return i?(s=ft(e),s=t.shiftKey?Yt("Shift-"+i,s,function(t){return at(e,t,!0)})||Yt(i,s,function(t){if("string"==typeof t&&/^go[A-Z]/.test(t))return at(e,t)}):Yt(i,s,function(t){return at(e,t)}),"stop"==s&&(s=!1),s&&(tr(t),N(e),qr&&(t.oldKeyCode=t.keyCode,t.keyCode=0)),s):!1}function ct(e,t,n){if(n=Yt("'"+n+"'",ft(e),function(t){return at(e,t,!0)}))tr(t),N(e);return n}function ht(e){this.state.focused||dt(this),Fr&&27==e.keyCode&&(e.returnValue=!1);if(!this.options.onKeyEvent||!this.options.onKeyEvent(this,er(e))){var t=e.keyCode;this.doc.sel.shift=16==t||e.shiftKey;var n=lt(this,e);Wr&&(hi=n?t:null,!n&&88==t&&!zi&&(Yr?e.metaKey:e.ctrlKey)&&this.replaceSelection(""))}}function pt(e){var t=this;if(!t.options.onKeyEvent||!t.options.onKeyEvent(t,er(e))){var n=e.keyCode,r=e.charCode;if(Wr&&n==hi)hi=null,tr(e);else if(!(Wr&&(!e.which||10>e.which)||Vr)||!lt(t,e))n=String.fromCharCode(null==r?n:r),this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!Y(this)&&-1<this.doc.mode.electricChars.indexOf(n)&&setTimeout(z(t,function(){Ut(t,t.doc.sel.to.line,"smart")}),75),ct(t,e,n)||J(t)}}function dt(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(ur(e,"focus",e),e.state.focused=!0,-1==e.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(e.display.wrapper.className+=" CodeMirror-focused"),Q(e,!0)),$(e),N(e))}function vt(e){e.state.focused&&(ur(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function mt(e,t){function n(){r.inputDiv.style.position="relative",r.input.style.cssText=u,qr&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=o),$(e);if(null!=r.input.selectionStart&&(!Fr||qr)){clearTimeout(pi);var t=r.input.value=" "+(At(i.from,i.to)?"":r.input.value),n=0;r.prevInput=" ",r.input.selectionStart=1,r.input.selectionEnd=t.length;var s=function(){r.prevInput==" "&&r.input.selectionStart==0?z(e,Ei.selectAll)(e):n++<10?pi=setTimeout(s,500):Q(e)};pi=setTimeout(s,200)}}var r=e.display,i=e.doc.sel;if(!et(r,t)){var s=tt(e,t),o=r.scroller.scrollTop;if(s&&!Wr){(At(i.from,i.to)||Ot(s,i.from)||!Ot(s,i.to))&&z(e,Bt)(e.doc,s,s);var u=r.input.style.cssText;r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",G(e),Q(e,!0),At(i.from,i.to)&&(r.input.value=r.prevInput=" ");if(ni){rr(t);var a=function(){or(window,"mouseup",a),setTimeout(n,20)};sr(window,"mouseup",a)}else setTimeout(n,50)}}}function gt(e){return Lt(e.from.line+e.text.length-1,dr(e.text).length+(1==e.text.length?e.from.ch:0))}function yt(e,t,n){if(!Ot(t.from,n))return _t(e,n);var r=t.text.length-1-(t.to.line-t.from.line);return n.line>t.to.line+r?(t=n.line-r,r=e.first+e.size-1,t>r?Lt(r,Bn(e,r).text.length):Dt(n,Bn(e,t).text.length)):n.line==t.to.line+r?Dt(n,dr(t.text).length+(1==t.text.length?t.from.ch:0)+Bn(e,t.to.line).text.length-t.to.ch):(e=n.line-t.from.line,Dt(n,t.text[e].length+(e?0:t.from.ch)))}function bt(e,t,n){if(n&&"object"==typeof n)return{anchor:yt(e,t,n.anchor),head:yt(e,t,n.head)};if("start"==n)return{anchor:t.from,head:t.from};var r=gt(t);return"around"==n?{anchor:t.from,head:r}:"end"==n?{anchor:r,head:r}:(n=function(e){if(Ot(e,t.from))return e;if(!Ot(t.to,e))return r;var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=r.ch-t.to.ch),Lt(n,i)},{anchor:n(e.sel.anchor),head:n(e.sel.head)})}function wt(e,t){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,update:function(t,n,r,i){t&&(this.from=_t(e,t)),n&&(this.to=_t(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)},cancel:function(){this.canceled=!0}};return ur(e,"beforeChange",e,n),e.cm&&ur(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Et(e,t,n,r){if(e.cm){if(!e.cm.curOp)return z(e.cm,Et)(e,t,n,r);if(e.cm.state.suppressEdits)return}if(lr(e,"beforeChange")||e.cm&&lr(e.cm,"beforeChange"))if(t=wt(e,t),!t)return;if(r=ri&&!r&&ln(e,t.from,t.to)){for(var i=r.length-1;1<=i;--i)St(e,{from:r[i].from,to:r[i].to,text:[""]});r.length&&St(e,{from:r[0].from,to:r[0].to,text:t.text},n)}else St(e,t,n)}function St(e,t,n){n=bt(e,t,n),$n(e,t,n,e.cm?e.cm.curOp.id:NaN),Nt(e,t,n,an(e,t));var r=[];Pn(e,function(e,n){!n&&-1==mr(r,e.history)&&(Yn(e.history,t),r.push(e.history)),Nt(e,t,null,an(e,t))})}function xt(e,t){var n=e.history,r=("undo"==t?n.done:n.undone).pop();if(r){n.dirtyCounter+="undo"==t?-1:1;var i={changes:[],anchorBefore:r.anchorAfter,headBefore:r.headAfter,anchorAfter:r.anchorBefore,headAfter:r.headBefore};("undo"==t?n.undone:n.done).push(i);for(n=r.changes.length-1;0<=n;--n){var s=r.changes[n];s.origin=t,i.changes.push(Vn(e,s));var o=n?bt(e,s,null):{anchor:r.anchorBefore,head:r.headBefore};Nt(e,s,o,fn(e,s));var u=[];Pn(e,function(e,t){!t&&-1==mr(u,e.history)&&(Yn(e.history,s),u.push(e.history)),Nt(e,s,null,fn(e,s))})}}}function Tt(e,t){function n(e){return Lt(e.line+t,e.ch)}e.first+=t,e.cm&&V(e.cm,e.first,e.first,t),e.sel.head=n(e.sel.head),e.sel.anchor=n(e.sel.anchor),e.sel.from=n(e.sel.from),e.sel.to=n(e.sel.to)}function Nt(e,t,n,r){if(e.cm&&!e.cm.curOp)return z(e.cm,Nt)(e,t,n,r);if(t.to.line<e.first)Tt(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);Tt(e,i),t={from:Lt(e.first,0),to:Lt(t.to.line+i,t.to.ch),text:[dr(t.text)],origin:t.origin}}i=e.lastLine(),t.to.line>i&&(t={from:t.from,to:Lt(i,Bn(e,i).text.length),text:[t.text[0]],origin:t.origin}),n||(n=bt(e,t,null)),e.cm?Ct(e.cm,t,r,n):Mn(e,t,r,n)}}function Ct(e,t,n,i){var s=e.doc,o=e.display,u=t.from,f=t.to,l=!1,c=u.line;e.options.lineWrapping||(c=qn(pn(s,Bn(s,u.line))),s.iter(c,f.line+1,function(e){if(e==o.maxLine)return l=!0})),Mn(s,t,n,i,r(e)),e.options.lineWrapping||(s.iter(c,u.line+t.text.length,function(e){var t=a(s,e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),s.frontier=Math.min(s.frontier,u.line),C(e,400),V(e,u.line,f.line+1,t.text.length-(f.line-u.line)-1);if(lr(e,"change"))if(t={from:u,to:f,text:t.text,origin:t.origin},e.curOp.textChanged){for(e=e.curOp.textChanged;e.next;e=e.next);e.next=t}else e.curOp.textChanged=t}function kt(e,t,n,r,i){r||(r=n);if(Ot(r,n))var s=r,r=n,n=s;"string"==typeof t&&(t=Ri(t)),Et(e,{from:n,to:r,text:t,origin:i},null)}function Lt(e,t){if(!(this instanceof Lt))return new Lt(e,t);this.line=e,this.ch=t}function At(e,t){return e.line==t.line&&e.ch==t.ch}function Ot(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Mt(e){return Lt(e.line,e.ch)}function _t(e,t){if(t.line<e.first)return Lt(e.first,0);var n=e.first+e.size-1;return t.line>n?Lt(n,Bn(e,n).text.length):Dt(t,Bn(e,t.line).text.length)}function Dt(e,t){var n=e.ch;return null==n||n>t?Lt(e.line,t):0>n?Lt(e.line,0):e}function Pt(e,t){return t>=e.first&&t<e.first+e.size}function Ht(e,t,n,r){if(e.sel.shift||e.sel.extend){var i=e.sel.anchor;if(n){var s=Ot(t,i);s!=Ot(n,i)?(i=t,t=n):s!=Ot(t,n)&&(t=n)}Bt(e,i,t,r)}else Bt(e,t,n||t,r);e.cm&&(e.cm.curOp.userSelChange=!0)}function Bt(e,t,n,r,i){if(!i&&lr(e,"beforeSelectionChange")||e.cm&&lr(e.cm,"beforeSelectionChange"))t={anchor:t,head:n},ur(e,"beforeSelectionChange",e,t),e.cm&&ur(e.cm,"beforeSelectionChange",e.cm,t),t.anchor=_t(e,t.anchor),t.head=_t(e,t.head),n=t.head,t=t.anchor;var s=e.sel;s.goalColumn=null;if(i||!At(t,s.anchor))t=Ft(e,t,r,"push"!=i);if(i||!At(n,s.head))n=Ft(e,n,r,"push"!=i);if(!At(s.anchor,t)||!At(s.head,n))s.anchor=t,s.head=n,r=Ot(n,t),s.from=r?n:t,s.to=r?t:n,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0),ar(e,"cursorActivity",e)}function jt(e){Bt(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function Ft(e,t,n,r){var i=!1,s=t,o=n||1;e.cantEdit=!1;e:for(;;){var u=Bn(e,s.line),a;if(u.markedSpans){for(var f=0;f<u.markedSpans.length;++f){var l=u.markedSpans[f],c=l.marker;if((null==l.from||(c.inclusiveLeft?l.from<=s.ch:l.from<s.ch))&&(null==l.to||(c.inclusiveRight?l.to>=s.ch:l.to>s.ch)))if(r&&c.clearOnEnter)(a||(a=[])).push(c);else if(c.atomic){f=c.find()[0>o?"from":"to"];if(At(f,s)&&(f.ch+=o,0>f.ch?f=f.line>e.first?_t(e,Lt(f.line-1)):null:f.ch>u.text.length&&(f=f.line<e.first+e.size-1?Lt(f.line+1,0):null),!f)){if(i)return r?(e.cantEdit=!0,Lt(e.first,0)):Ft(e,t,n,!0);i=!0,f=t,o=-o}s=f;continue e}}if(a)for(f=0;f<a.length;++f)a[f].clear()}return s}}function It(e,t){for(;;){var n=!1,r=H(e,t),i=Rt(e,r.left,r.top,r.left,r.bottom),s=e.doc.scrollTop,o=e.doc.scrollLeft;null!=i.scrollTop&&(st(e,i.scrollTop),1<Math.abs(e.doc.scrollTop-s)&&(n=!0)),null!=i.scrollLeft&&(ot(e,i.scrollLeft),1<Math.abs(e.doc.scrollLeft-o)&&(n=!0));if(!n)return r}}function qt(e,t,n,r,i){t=Rt(e,t,n,r,i),null!=t.scrollTop&&st(e,t.scrollTop),null!=t.scrollLeft&&ot(e,t.scrollLeft)}function Rt(e,t,n,r,i){var s=e.display,o=s.lineSpace.offsetTop,n=n+o,i=i+o,u=s.scroller.clientHeight-_i,a=s.scroller.scrollTop,f={},e=e.doc.height+2*o,l=n<o+10,o=i+o>e-10;return n<a?f.scrollTop=l?0:Math.max(0,n):i>a+u&&(f.scrollTop=(o?e:i)-u),n=s.scroller.clientWidth-_i,i=s.scroller.scrollLeft,t+=s.gutters.offsetWidth,r+=s.gutters.offsetWidth,s=s.gutters.offsetWidth,u=t<s+10,t<i+s||u?(u&&(t=0),f.scrollLeft=Math.max(0,t-10-s)):r>n+i-3&&(f.scrollLeft=r+10-n),f}function Ut(e,t,n,r){var i=e.doc;n||(n="add");if("smart"==n)if(e.doc.mode.indent)var s=A(e,t);else n="prev";var o=e.options.tabSize,u=Bn(i,t),a=hr(u.text,null,o),f=u.text.match(/^\s*/)[0],l;if("smart"==n&&(l=e.doc.mode.indent(s,u.text.slice(f.length),u.text),l==Di)){if(!r)return;n="prev"}"prev"==n?l=t>i.first?hr(Bn(i,t-1).text,null,o):0:"add"==n?l=a+e.options.indentUnit:"subtract"==n&&(l=a-e.options.indentUnit),l=Math.max(0,l),n="",r=0;if(e.options.indentWithTabs)for(i=Math.floor(l/o);i;--i)r+=o,n+="	";r<l&&(n+=pr(l-r)),n!=f&&kt(e.doc,n,Lt(t,0),Lt(t,f.length),"+input"),u.stateAfter=null}function zt(e,t,n){var r=t,i=t,s=e.doc;return"number"==typeof t?i=Bn(s,Math.max(s.first,Math.min(t,s.first+s.size-1))):r=qn(t),null==r||!n(i,r)?null:(V(e,r,r+1),i)}function Wt(e,t,n,r,i){function s(t){var r=(i?Hr:Br)(a,u,n,!0);if(null==r){if(t=!t)t=o+n,t<e.first||t>=e.first+e.size?t=f=!1:(o=t,t=a=Bn(e,t));if(!t)return f=!1;u=i?(0>n?_r:Mr)(a):0>n?a.text.length:0}else u=r;return!0}var o=t.line,u=t.ch,a=Bn(e,o),f=!0;if("char"==r)s();else if("column"==r)s(!0);else if("word"==r)for(t=!1;!(0>n)||s();){if(wr(a.text.charAt(u)))t=!0;else if(t){0>n&&(n=1,s());break}if(0<n&&!s())break}return t=Ft(e,Lt(o,u),n,!0),f||(t.hitSide=!0),t}function Xt(e,t,n,r){var i=e.doc,s=t.left,o;"page"==r?(r=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),o=t.top+n*r):"line"==r&&(o=0<n?t.bottom+3:t.top-3);for(;;){var u=j(e,s,o);if(!u.outside)break;if(0>n?0>=o:o>=i.height){u.hitSide=!0;break}o+=5*n}return u}function Vt(e,t){var n=t.ch,r=t.ch;if(e){!1===t.after||r==e.length?--n:++r;for(var i=e.charAt(n),i=wr(i)?wr:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!wr(e)};0<n&&i(e.charAt(n-1));)--n;for(;r<e.length&&i(e.charAt(r));)++r}return{from:Lt(t.line,n),to:Lt(t.line,r)}}function $t(e,t){Ht(e.doc,Lt(t,0),_t(e.doc,Lt(t+1,0)))}function Jt(t,n,r,i){e.defaults[t]=n,r&&(di[t]=i?function(e,t,n){n!=mi&&r(e,t,n)}:r)}function Kt(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={},r;for(r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Qt(e,t,n){return e.startState?e.startState(t,n):!0}function Gt(e){return"string"==typeof e?Si[e]:e}function Yt(e,t,n){function r(t){var t=Gt(t),i=t[e];if(!1===i)return"stop";if(null!=i&&n(i))return!0;if(t.nofallthrough)return"stop";t=t.fallthrough;if(null==t)return!1;if("[object Array]"!=Object.prototype.toString.call(t))return r(t);for(var i=0,s=t.length;i<s;++i){var o=r(t[i]);if(o)return o}return!1}for(var i=0;i<t.length;++i){var s=r(t[i]);if(s)return s}}function Zt(e){return e=Wi[e.keyCode],"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function en(e,t){var n=Wi[e.keyCode];if(null==n||e.altGraphKey)return!1;e.altKey&&(n="Alt-"+n);if(ti?e.metaKey:e.ctrlKey)n="Ctrl-"+n;if(ti?e.ctrlKey:e.metaKey)n="Cmd-"+n;return!t&&e.shiftKey&&(n="Shift-"+n),n}function tn(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8}function nn(e,t){this.lines=[],this.type=t,this.doc=e}function rn(e,t,n,r,i){if(r&&r.shared)return on(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return z(e.cm,rn)(e,t,n,r,i);var s=new nn(e,i);if("range"==i&&!Ot(t,n))return s;r&&gr(r,s),s.replacedWith&&(s.collapsed=!0,s.replacedWith=Sr("span",[s.replacedWith],"CodeMirror-widget")),s.collapsed&&(ii=!0);var o=t.line,u=0,a,f,l=e.cm,c;e.iter(o,n.line+1,function(r){l&&s.collapsed&&!l.options.lineWrapping&&pn(e,r)==l.display.maxLine&&(c=!0);var i={from:null,to:null,marker:s};u+=r.text.length,o==t.line&&(i.from=t.ch,u-=t.ch),o==n.line&&(i.to=n.ch,u-=r.text.length-n.ch),s.collapsed&&(o==n.line&&(f=cn(r,n.ch)),o==t.line?a=cn(r,t.ch):In(r,0)),r.markedSpans=r.markedSpans?r.markedSpans.concat([i]):[i],i.marker.attachLine(r),++o}),s.collapsed&&e.iter(t.line,n.line+1,function(t){dn(e,t)&&In(t,0)}),s.readOnly&&(ri=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory());if(s.collapsed){if(a!=f)throw Error("Inserting collapsed marker overlapping an existing one");s.size=u,s.atomic=!0}return l&&(c&&(l.curOp.updateMaxLine=!0),(s.className||s.startStyle||s.endStyle||s.collapsed)&&V(l,t.line,n.line+1),s.atomic&&jt(l)),s}function sn(e,t){this.markers=e,this.primary=t;for(var n=0,r=this;n<e.length;++n)e[n].parent=this,sr(e[n],"clear",function(){r.clear()})}function on(e,t,n,r,i){r=gr(r),r.shared=!1;var s=[rn(e,t,n,r,i)],o=s[0];return Pn(e,function(e){s.push(rn(e,_t(e,t),_t(e,n),r,i));for(var u=0;u<e.linked.length;++u)if(e.linked[u].isParent)return;o=dr(s)}),new sn(s,o)}function un(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function an(e,t){var n=Pt(e,t.from.line)&&Bn(e,t.from.line).markedSpans,r=Pt(e,t.to.line)&&Bn(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,s=t.to.ch,o=At(t.from,t.to);if(n)for(var u=0,a;u<n.length;++u){var f=n[u],l=f.marker;if(null==f.from||(l.inclusiveLeft?f.from<=i:f.from<i)||"bookmark"==l.type&&f.from==i&&(!o||!f.marker.insertLeft)){var c=null==f.to||(l.inclusiveRight?f.to>=i:f.to>i);(a||(a=[])).push({from:f.from,to:c?null:f.to,marker:l})}}n=a;if(r)for(var u=0,h;u<r.length;++u)if(a=r[u],f=a.marker,null==a.to||(f.inclusiveRight?a.to>=s:a.to>s)||"bookmark"==f.type&&a.from==s&&(!o||a.marker.insertLeft))l=null==a.from||(f.inclusiveLeft?a.from<=s:a.from<s),(h||(h=[])).push({from:l?null:a.from-s,to:null==a.to?null:a.to-s,marker:f});r=h,o=1==t.text.length,h=dr(t.text).length+(o?i:0);if(n)for(s=0;s<n.length;++s)u=n[s],null==u.to&&((a=un(r,u.marker))?o&&(u.to=null==a.to?null:a.to+h):u.to=i);if(r)for(s=0;s<r.length;++s)(u=r[s],null!=u.to&&(u.to+=h),null==u.from)?(a=un(n,u.marker),a||(u.from=h,o&&(n||(n=[])).push(u))):(u.from+=h,o&&(n||(n=[])).push(u));i=[n];if(!o){var o=t.text.length-2,p;if(0<o&&n)for(s=0;s<n.length;++s)null==n[s].to&&(p||(p=[])).push({from:null,to:null,marker:n[s].marker});for(s=0;s<o;++s)i.push(p);i.push(r)}return i}function fn(e,t){var n;if(n=t["spans_"+e.id]){for(var r=0,i=[];r<t.text.length;++r)i.push(Jn(n[r]));n=i}else n=null;r=an(e,t);if(!n)return r;if(!r)return n;for(i=0;i<n.length;++i){var s=n[i],o=r[i];if(s&&o){var u=0;e:for(;u<o.length;++u){for(var a=o[u],f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}}else o&&(n[i]=o)}return n}function ln(e,t,n){var r=null;e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;n.readOnly&&(!r||-1==mr(r,n))&&(r||(r=[])).push(n)}});if(!r)return null;e=[{from:t,to:n}];for(t=0;t<r.length;++t)for(var n=r[t],i=n.find(),s=0;s<e.length;++s){var o=e[s];if(!Ot(o.to,i.from)&&!Ot(i.to,o.from)){var u=[s,1];(Ot(o.from,i.from)||!n.inclusiveLeft&&At(o.from,i.from))&&u.push({from:o.from,to:i.from}),(Ot(i.to,o.to)||!n.inclusiveRight&&At(o.to,i.to))&&u.push({from:i.to,to:o.to}),e.splice.apply(e,u),s+=u.length-1}}return e}function cn(e,t){var n=ii&&e.markedSpans,r;if(n)for(var i,s=0;s<n.length;++s)if(i=n[s],i.marker.collapsed&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!r||r.width<i.marker.width))r=i.marker;return r}function hn(e){return cn(e,e.text.length+1)}function pn(e,t){for(var n;n=cn(t,-1);)t=Bn(e,n.find().from.line);return t}function dn(e,t){var n=ii&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed&&(null==r.from||0==r.from&&r.marker.inclusiveLeft&&vn(e,t,r)))return!0}function vn(e,t,n){if(null==n.to)return t=n.marker.find().to,t=Bn(e,t.line),vn(e,t,un(t.markedSpans,n.marker));if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r,i=0;i<t.markedSpans.length;++i)if(r=t.markedSpans[i],r.marker.collapsed&&r.from==n.to&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&vn(e,t,r))return!0}function mn(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function gn(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function yn(e){return function(){var t=!this.cm.curOp;t&&R(this.cm);try{var n=e.apply(this,arguments)}finally{t&&U(this.cm)}return n}}function bn(e){return null!=e.height?e.height:((!e.node.parentNode||1!=e.node.parentNode.nodeType)&&Tr(e.cm.display.measure,Sr("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}function wn(e,t,n,r){var i=new xi(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),zt(e,t,function(t){(t.widgets||(t.widgets=[])).push(i),i.line=t;if(!dn(e.doc,t)||i.showIfHidden){var n=Un(e,t)<e.display.scroller.scrollTop;In(t,t.height+bn(i)),n&&(e.curOp.updateScrollPos={scrollTop:e.doc.scrollTop+i.height,scrollLeft:e.doc.scrollLeft})}return!0}),i}function En(e,t,n){return e={text:e},gn(e,t),e.height=n?n(e):1,e}function Sn(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),mn(e),gn(e,n),t=r?r(e):1,t!=e.height&&In(e,t),ar(e,"change")}function xn(e,t,n,r,i){var s=e.options.flattenSpans,o="",u=null,e=new tn(t,e.options.tabSize);for(""==t&&n.blankLine&&n.blankLine(r);!e.eol();){var a=n.token(e,r);5e3<e.pos&&(s=!1,e.pos=Math.min(t.length,e.start+5e4),a=null);var f=e.current();e.start=e.pos,!s||u!=a?(o&&i(o,u),o=f,u=a):o+=f}o&&i(o,u)}function Tn(e,t,n){var r=[e.state.modeGen];xn(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)});for(n=0;n<e.state.overlays.length;++n){var i=e.state.overlays[n],s=1;xn(e,t.text,i.mode,!0,function(e,t){for(var n=s,o=e.length;o;){var u=r[s],a=u.length;a<=o?o-=a:(r.splice(s,1,u.slice(0,o),r[s+1],u.slice(o)),o=0),s+=2}if(t)if(i.opaque)r.splice(n,s-n,e,t),s=n+2;else for(;n<s;n+=2)u=r[n+1],r[n+1]=u?u+" "+t:t})}return r}function Nn(e,t,n){var r=e.doc.mode,e=new tn(t.text,e.options.tabSize);for(""==t.text&&r.blankLine&&r.blankLine(n);!e.eol()&&5e3>=e.pos;)r.token(e,n),e.start=e.pos}function Cn(e){return e?Ti[e]||(Ti[e]="cm-"+e.replace(/ +/g," cm-")):null}function kn(e,t,n){for(var r,i=t,s,o,u=!0;r=cn(i,-1);)u=!1,i=Bn(e.doc,r.find().from.line),s||(s=i);r={pre:Sr("pre"),col:0,pos:0,display:!n,measure:null,addedOne:!1,cm:e},i.textClass&&(r.pre.className=i.textClass);do{r.measure=i==t&&n,r.pos=0,r.addToken=r.measure?An:Ln,n&&o&&i!=t&&!r.addedOne&&(n[0]=r.pre.appendChild(Lr(e.display.measure)),r.addedOne=!0);var a=i;o=r;var f=i;if(!f.styles||f.styles[0]!=e.state.modeGen)f.styles=Tn(e,f,f.stateAfter=A(e,qn(f)));e:{var l=a,f=f.styles;if(a=l.markedSpans)for(var l=l.text.length,c=0,h=1,p="",d=void 0,v=0,m=void 0,g=void 0,y=void 0,b=void 0;;){if(v==c){for(var m=g=y="",b=null,v=Infinity,w=null,E=0;E<a.length;++E){var S=a[E],x=S.marker;if(S.from<=c&&(null==S.to||S.to>c)){if(null!=S.to&&v>S.to&&(v=S.to,g=""),x.className&&(m+=" "+x.className),x.startStyle&&S.from==c&&(y+=" "+x.startStyle),x.endStyle&&S.to==v&&(g+=" "+x.endStyle),x.collapsed&&(!b||b.marker.width<x.width))b=S}else S.from>c&&v>S.from&&(v=S.from);"bookmark"==x.type&&S.from==c&&x.replacedWith&&(w=x.replacedWith)}if(b&&(b.from||0)==c)if(On(o,(null==b.to?l:b.to)-c,null!=b.from&&b.marker.replacedWith),null==b.to){f=b.marker.find();break e}w&&!b&&On(o,0,w)}if(c>=l)break;for(w=Math.min(l,v);;){if(p){E=c+p.length,b||(S=E>w?p.slice(0,w-c):p,o.addToken(o,S,d?d+m:m,y,c+S.length==v?g:""));if(E>=w){p=p.slice(w-c),c=w;break}c=E,y=""}p=f[h++],d=Cn(f[h++])}}else for(var h=1;h<f.length;h+=2)o.addToken(o,f[h],Cn(f[h+1]));f=void 0}o=i==s,f&&(i=Bn(e.doc,f.to.line),u=!1)}while(f);n&&!r.addedOne&&(n[0]=r.pre.appendChild(u?Sr("span"," "):Lr(e.display.measure))),!r.pre.firstChild&&!dn(e.doc,t)&&r.pre.appendChild(document.createTextNode(" "));var T;return n&&Fr&&(T=zn(i))&&(i=T.length-1,T[i].from==T[i].to&&--i,t=T[i],T=T[i-1],t.from+1==t.to&&T&&t.level<T.level&&(n=n[r.pos-1]))&&n.parentNode.insertBefore(n.measureRight=Lr(e.display.measure),n.nextSibling),r.pre}function Ln(e,t,n,r,i){if(t){if(Ni.test(t))for(var s=document.createDocumentFragment(),o=0;;){Ni.lastIndex=o;var u=Ni.exec(t),a=u?u.index-o:t.length-o;a&&(s.appendChild(document.createTextNode(t.slice(o,o+a))),e.col+=a);if(!u)break;o+=a+1,"	"==u[0]?(u=e.cm.options.tabSize,u-=e.col%u,s.appendChild(Sr("span",pr(u),"cm-tab")),e.col+=u):(a=Sr("span","•","cm-invalidchar"),a.title="\\u"+u[0].charCodeAt(0).toString(16),s.appendChild(a),e.col+=1)}else{e.col+=t.length;var s=document.createTextNode(t)}if(n||r||i||e.measure)return t=n||"",r&&(t+=r),i&&(t+=i),e.pre.appendChild(Sr("span",[s],t));e.pre.appendChild(s)}}function An(e,t,n,r,i){for(var s=0;s<t.length;++s){var o=t.charAt(s),u=0==s;""<=o&&"">o&&s<t.length-1?(o=t.slice(s,s+2),++s):s&&e.cm.options.lineWrapping&&Fi.test(t.slice(s-1,s+1))&&e.pre.appendChild(Sr("wbr")),e.measure[e.pos]=Ln(e,o,n,u&&r,s==t.length-1&&i),e.pos+=o.length}t.length&&(e.addedOne=!0)}function On(e,t,n){n&&(e.display||(n=n.cloneNode(!0)),e.pre.appendChild(n),e.measure&&t&&(e.measure[e.pos]=n,e.addedOne=!0)),e.pos+=t}function Mn(e,t,n,r,i){function s(e){return n?n[e]:null}var o=t.from,u=t.to,a=t.text,f=Bn(e,o.line),l=Bn(e,u.line),c=dr(a),h=s(a.length-1),p=u.line-o.line;if(0==o.ch&&0==u.ch&&""==c){for(var d=0,v=a.length-1,m=[];d<v;++d)m.push(En(a[d],s(d),i));Sn(l,l.text,h,i),p&&e.remove(o.line,p),m.length&&e.insert(o.line,m)}else if(f==l)if(1==a.length)Sn(f,f.text.slice(0,o.ch)+c+f.text.slice(u.ch),h,i);else{m=[],d=1;for(v=a.length-1;d<v;++d)m.push(En(a[d],s(d),i));m.push(En(c+f.text.slice(u.ch),h,i)),Sn(f,f.text.slice(0,o.ch)+a[0],s(0),i),e.insert(o.line+1,m)}else if(1==a.length)Sn(f,f.text.slice(0,o.ch)+a[0]+l.text.slice(u.ch),s(0),i),e.remove(o.line+1,p);else{Sn(f,f.text.slice(0,o.ch)+a[0],s(0),i),Sn(l,c+l.text.slice(u.ch),h,i),d=1,v=a.length-1;for(m=[];d<v;++d)m.push(En(a[d],s(d),i));1<p&&e.remove(o.line+1,p-1),e.insert(o.line+1,m)}ar(e,"change",e,t),Bt(e,r.anchor,r.head,null,!0)}function _n(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,r=0;t<n;++t)e[t].parent=this,r+=e[t].height;this.height=r}function Dn(e){this.children=e;for(var t=0,n=0,r=0,i=e.length;r<i;++r){var s=e[r],t=t+s.chunkSize(),n=n+s.height;s.parent=this}this.size=t,this.height=n,this.parent=null}function Pn(e,t,n){function r(e,i,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var u=e.linked[o];if(u.doc!=i){var a=s&&u.sharedHist;if(!n||a)t(u.doc,a),r(u.doc,e,a)}}}r(e,null,!0)}function Hn(e,t){if(t.cm)throw Error("This document is already in use.");e.doc=t,t.cm=e,i(e),n(e),e.options.lineWrapping||f(e),e.options.mode=t.modeOption,V(e)}function Bn(e,t){for(t-=e.first;!e.lines;)for(var n=0;;++n){var r=e.children[n],i=r.chunkSize();if(t<i){e=r;break}t-=i}return e.lines[t]}function jn(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text,i==n.line&&(e=e.slice(0,n.ch)),i==t.line&&(e=e.slice(t.ch)),r.push(e),++i}),r}function Fn(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function In(e,t){for(var n=t-e.height,r=e;r;r=r.parent)r.height+=n}function qn(e){if(null==e.parent)return null;for(var t=e.parent,e=mr(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var r=0;n.children[r]!=t;++r)e+=n.children[r].chunkSize();return e+t.first}function Rn(e,t){var n=e.first;e:do{for(var r=0,i=e.children.length;r<i;++r){var s=e.children[r],o=s.height;if(t<o){e=s;continue e}t-=o,n+=s.chunkSize()}return n}while(!e.lines);r=0;for(i=e.lines.length;r<i;++r){s=e.lines[r].height;if(t<s)break;t-=s}return n+r}function Un(e,t){for(var t=pn(e.doc,t),n=0,r=t.parent,i=0;i<r.lines.length;++i){var s=r.lines[i];if(s==t)break;n+=s.height}for(s=r.parent;s;r=s,s=r.parent)for(i=0;i<s.children.length;++i){var o=s.children[i];if(o==r)break;n+=o.height}return n}function zn(e){var t=e.order;return null==t&&(t=e.order=Xi(e.text)),t}function Wn(){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function Xn(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function Vn(e,t){var n={from:t.from,to:gt(t),text:jn(e,t.from,t.to)};return Xn(e,n,t.from.line,t.to.line+1),Pn(e,function(e){Xn(e,n,t.from.line,t.to.line+1)},!0),n}function $n(e,t,n,r){var i=e.history;i.undone.length=0;var s=+(new Date),o=dr(i.done);if(o&&(i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastTime>s-600||"*"==t.origin.charAt(0)))){var u=dr(o.changes);At(t.from,t.to)&&At(t.from,u.to)?u.to=gt(t):o.changes.push(Vn(e,t)),o.anchorAfter=n.anchor,o.headAfter=n.head}else{o={changes:[Vn(e,t)],anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:n.anchor,headAfter:n.head};for(i.done.push(o);i.done.length>i.undoDepth;)i.done.shift();0>i.dirtyCounter?i.dirtyCounter=NaN:i.dirtyCounter++}i.lastTime=s,i.lastOp=r,i.lastOrigin=t.origin}function Jn(e){if(!e)return null;for(var t=0,n;t<e.length;++t)e[t].marker.explicitlyCleared?n||(n=e.slice(0,t)):n&&n.push(e[t]);return n?n.length?n:null:e}function Kn(e,t){for(var n=0,r=[];n<e.length;++n){var i=e[n],s=i.changes,o=[];r.push({changes:o,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter});for(i=0;i<s.length;++i){var u=s[i],a;o.push({from:u.from,to:u.to,text:u.text});if(t)for(var f in u)(a=f.match(/^spans_(\d+)$/))&&-1<mr(t,Number(a[1]))&&(dr(o)[f]=u[f],delete u[f])}}return r}function Qn(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Gn(e,t,n,r){for(var i=0;i<e.length;++i){for(var s=e[i],o=!0,u=0;u<s.changes.length;++u){var a=s.changes[u];s.copied||(a.from=Mt(a.from),a.to=Mt(a.to));if(n<a.from.line)a.from.line+=r,a.to.line+=r;else if(t<=a.to.line){o=!1;break}}s.copied||(s.anchorBefore=Mt(s.anchorBefore),s.headBefore=Mt(s.headBefore),s.anchorAfter=Mt(s.anchorAfter),s.readAfter=Mt(s.headAfter),s.copied=!0),o?(Qn(s.anchorBefore),Qn(s.headBefore),Qn(s.anchorAfter),Qn(s.headAfter)):(e.splice(0,i+1),i=0)}}function Yn(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;Gn(e.done,n,r,i),Gn(e.undone,n,r,i)}function Zn(){rr(this)}function er(e){return e.stop||(e.stop=Zn),e}function tr(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function nr(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function rr(e){tr(e),nr(e)}function ir(e){var t=e.which;return null==t&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),Yr&&e.ctrlKey&&1==t&&(t=3),t}function sr(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}),(e[t]||(e[t]=[])).push(n))}function or(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else if(e=e._handlers&&e._handlers[t])for(t=0;t<e.length;++t)if(e[t]==n){e.splice(t,1);break}}function ur(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function ar(e,t){function n(e){return function(){e.apply(null,i)}}var r=e._handlers&&e._handlers[t];if(r){var i=Array.prototype.slice.call(arguments,2);Oi||(++Mi,Oi=[],setTimeout(fr,0));for(var s=0;s<r.length;++s)Oi.push(n(r[s]))}}function fr(){--Mi;var e=Oi;Oi=null;for(var t=0;t<e.length;++t)e[t]()}function lr(e,t){var n=e._handlers&&e._handlers[t];return n&&0<n.length}function cr(){this.id=null}function hr(e,t,n){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var r=0,i=0;r<t;++r)"	"==e.charAt(r)?i+=n-i%n:++i;return i}function pr(e){for(;Pi.length<=e;)Pi.push(dr(Pi)+" ");return Pi[e]}function dr(e){return e[e.length-1]}function vr(e){Qr?(e.selectionStart=0,e.selectionEnd=e.value.length):e.select()}function mr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;++n)if(e[n]==t)return n;return-1}function gr(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function yr(e){for(var t=[],n=0;n<e;++n)t.push(void 0);return t}function br(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function wr(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||Hi.test(e))}function Er(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Sr(e,t,n,r){e=document.createElement(e),n&&(e.className=n),r&&(e.style.cssText=r);if("string"==typeof t)Nr(e,t);else if(t)for(n=0;n<t.length;++n)e.appendChild(t[n]);return e}function xr(e){if(Fr)for(;e.firstChild;)e.removeChild(e.firstChild);else e.innerHTML="";return e}function Tr(e,t){return xr(e).appendChild(t)}function Nr(e,t){qr?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function Cr(e){return e.getBoundingClientRect()}function kr(e){if(null!=Ii)return Ii;var t=Sr("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return Tr(e,t),t.offsetWidth&&(Ii=t.offsetHeight-t.clientHeight),Ii||0}function Lr(e){if(null==qi){var t=Sr("span","​");Tr(e,Sr("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(qi=1>=t.offsetWidth&&2<t.offsetHeight&&!Ir)}return qi?Sr("span","​"):Sr("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Ar(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=0;i<e.length;++i){var s=e[i];(s.from<n&&s.to>t||t==n&&s.to==t)&&r(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr")}}function Or(e){return e.level%2?e.from:e.to}function Mr(e){return(e=zn(e))?e[0].level%2?e[0].to:e[0].from:0}function _r(e){var t=zn(e);return t?Or(dr(t)):e.text.length}function Dr(e,t){var n=Bn(e.doc,t),r=pn(e.doc,n);return r!=n&&(t=qn(r)),n=zn(r),r=n?n[0].level%2?_r(r):Mr(r):0,Lt(t,r)}function Pr(e,t){for(var n,r;n=hn(r=Bn(e.doc,t));)t=n.find().to.line;return n=zn(r),r=n?n[0].level%2?Mr(r):_r(r):r.text.length,Lt(t,r)}function Hr(e,t,n,r){var i=zn(e);if(!i)return Br(e,t,n,r);for(var r=r?function(t,n){do t+=n;while(0<t&&Bi.test(e.text.charAt(t)));return t}:function(e,t){return e+t},s=i[0].level,o=0;o<i.length;++o){var u=i[o],a=u.level%2==s;if(u.from<t&&u.to>t||a&&(u.from==t||u.to==t))break}for(t=r(t,u.level%2?-n:n);null!=t;)if(u.level%2==s){if(!(t<u.from||t>u.to))break;t=(u=i[o+=n])&&(0<n==u.level%2?r(u.to,-1):r(u.from,1))}else if(t==(u.level%2?u.to:u.from))t=(u=i[--o])&&Or(u);else{if(t!=Or(u))break;t=(u=i[++o])&&(u.level%2?u.to:u.from)}return 0>t||t>e.text.length?null:t}function Br(e,t,n,r){t+=n;if(r)for(;0<t&&Bi.test(e.text.charAt(t));)t+=n;return 0>t||t>e.text.length?null:t}var jr=/gecko\/\d/i.test(navigator.userAgent),Fr=/MSIE \d/.test(navigator.userAgent),Ir=Fr&&(null==document.documentMode||8>document.documentMode),qr=Fr&&(null==document.documentMode||9>document.documentMode),Rr=/WebKit\//.test(navigator.userAgent),Ur=Rr&&/Qt\/\d+\.\d+/.test(navigator.userAgent),zr=/Chrome\//.test(navigator.userAgent),Wr=/Opera\//.test(navigator.userAgent),Xr=/Apple Computer/.test(navigator.vendor),Vr=/KHTML\//.test(navigator.userAgent),$r=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Jr=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Kr=/PhantomJS/.test(navigator.userAgent),Qr=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Gr=Qr||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),Yr=Qr||/Mac/.test(navigator.platform),Zr=/windows/i.test(navigator.platform),ei=Wr&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);ei&&(ei=Number(ei[1]));var ti=Yr&&(Ur||Wr&&(null==ei||12.11>ei)),ni=jr||Fr&&!qr,ri=!1,ii=!1,si,oi=0,ui,ai,fi=0,li=null;Fr?li=-0.53:jr?li=15:zr?li=-0.7:Xr&&(li=-1/3);var ci,hi=null,pi;e.Pos=Lt,e.prototype={focus:function(){window.focus(),G(this),dt(this),J(this)},setOption:function(e,t){var n=this.options,r=n[e];n[e]==t&&"mode"!=e||(n[e]=
t,di.hasOwnProperty(e)&&z(this,di[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e){this.state.keyMaps.push(e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(("string"==typeof e?t[n].name:t[n])==e)return t.splice(n,1),!0},addOverlay:z(null,function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,V(this)}),removeOverlay:z(null,function(e){for(var t=this.state.overlays,n=0;n<t.length;++n)if(t[n].modeSpec==e){t.splice(n,1),this.state.modeGen++,V(this);break}}),indentLine:z(null,function(e,t,n){"string"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),Pt(this.doc,e)&&Ut(this,e,t,n)}),indentSelection:z(null,function(e){var t=this.doc.sel;if(At(t.from,t.to))return Ut(this,t.from.line,e);for(var n=t.to.line-(t.to.ch?0:1),t=t.from.line;t<=n;++t)Ut(this,t,e)}),getTokenAt:function(e){for(var t=this.doc,e=_t(t,e),n=A(this,e.line),r=this.doc.mode,t=Bn(t,e.line),t=new tn(t.text,this.options.tabSize);t.pos<e.ch&&!t.eol();){t.start=t.pos;var i=r.token(t,n)}return{start:t.start,end:t.pos,string:t.current(),className:i||null,type:i||null,state:n}},getStateAfter:function(e){var t=this.doc,e=Math.max(t.first,Math.min(null==e?t.first+t.size-1:e,t.first+t.size-1));return A(this,e+1)},cursorCoords:function(e,t){var n;return n=this.doc.sel,n=null==e?n.head:"object"==typeof e?_t(this.doc,e):e?n.from:n.to,H(this,n,t||"page")},charCoords:function(e,t){return P(this,_t(this.doc,e),t||"page")},coordsChar:function(e){var t=Cr(this.display.lineSpace);return j(this,e.left-t.left-(window.pageXOffset||(document.documentElement||document.body).scrollLeft),e.top-t.top-(window.pageYOffset||(document.documentElement||document.body).scrollTop))},defaultTextHeight:function(){return I(this.display)},setGutterMarker:z(null,function(e,t,n){return zt(this,e,function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&Er(r)&&(e.gutterMarkers=null),!0})}),clearGutter:z(null,function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,V(t,r,r+1),Er(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineClass:z(null,function(e,t,n){return zt(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[r]){if(RegExp("\\b"+n+"\\b").test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:z(null,function(e,t,n){return zt(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var s=i.replace(RegExp("^"+n+"\\b\\s*|\\s*\\b"+n+"\\b"),"");if(s==i)return!1;e[r]=s||null}return!0})}),addLineWidget:z(null,function(e,t,n){return wn(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!Pt(this.doc,e))return null;var t=e,e=Bn(this.doc,e);if(!e)return null}else if(t=qn(e),null==t)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,r,i){var s=this.display,e=H(this,_t(this.doc,e)),o=e.bottom,u=e.left;t.style.position="absolute",s.sizer.appendChild(t);if("over"==r)o=e.top;else if("above"==r||"near"==r){var a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+s.lineSpace.offsetTop+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&qt(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:z(null,ht),execCommand:function(e){return Ei[e](this)},findPosH:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var s=0,e=_t(this.doc,e);s<t&&(e=Wt(this.doc,e,i,n,r),!e.hitSide);++s);return e},moveH:z(null,function(e,t){var n=this.doc.sel,n=n.shift||n.extend||At(n.from,n.to)?Wt(this.doc,n.head,e,t,this.options.rtlMoveVisually):0>e?n.from:n.to;Ht(this.doc,n,n,e)}),deleteH:z(null,function(e,t){var n=this.doc.sel;At(n.from,n.to)?kt(this.doc,"",n.from,Wt(this.doc,n.head,e,t,!1),"+delete"):kt(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var s=0,e=_t(this.doc,e);s<t&&(e=H(this,e,"div"),null==r?r=e.left:e.left=r,e=Xt(this,e,i,n),!e.hitSide);++s);return e},moveV:z(null,function(e,t){var n=this.doc.sel,r=H(this,n.head,"div");null!=n.goalColumn&&(r.left=n.goalColumn);var i=Xt(this,r,e,t);"page"==t&&(this.display.scrollbarV.scrollTop+=P(this,i,"div").top-r.top),Ht(this.doc,i,i,e),n.goalColumn=r.left}),toggleOverwrite:function(){this.display.cursor.className=(this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+" CodeMirror-overwrite":this.display.cursor.className.replace(" CodeMirror-overwrite","")},scrollTo:z(null,function(e,t){this.curOp.updateScrollPos={scrollLeft:e,scrollTop:t}}),getScrollInfo:function(){var e=this.display.scroller,t=_i;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:function(e){"number"==typeof e&&(e=Lt(e,0)),!e||null!=e.line?(e=e?_t(this.doc,e):this.doc.sel.head,It(this,e)):qt(this,e.left,e.top,e.right,e.bottom)},setSize:function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(""+e)?e+"px":e}null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.refresh()},on:function(e,t){sr(this,e,t)},off:function(e,t){or(this,e,t)},operation:function(e){return X(this,e)},refresh:z(null,function(){_(this),this.curOp.updateScrollPos={scrollTop:this.doc.scrollTop,scrollLeft:this.doc.scrollLeft},V(this)}),swapDoc:z(null,function(e){var t=this.doc;return t.cm=null,Hn(this,e),_(this),this.curOp.updateScrollPos={scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var di=e.optionHandlers={},vi=e.defaults={},mi=e.Init={toString:function(){return"CodeMirror.Init"}};Jt("value","",function(e,t){e.setValue(t)},!0),Jt("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Jt("indentUnit",2,n,!0),Jt("indentWithTabs",!1),Jt("smartIndent",!0),Jt("tabSize",4,function(e){n(e),_(e),V(e)},!0),Jt("electricChars",!0),Jt("rtlMoveVisually",!Zr),Jt("theme","default",function(e){s(e),o(e)},!0),Jt("keyMap","default",function(e){var t=Si[e.options.keyMap].style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(t?" cm-keymap-"+t:"")}),Jt("extraKeys",null),Jt("onKeyEvent",null),Jt("onDragEvent",null),Jt("lineWrapping",!1,function(e){e.options.lineWrapping?(e.display.wrapper.className=e.display.wrapper.className+" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),f(e)),i(e),V(e),_(e),setTimeout(function(){c(e.display,e.doc.height)},100)},!0),Jt("gutters",[],function(e){l(e.options),o(e)},!0),Jt("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?v(e.display)+"px":"0",e.refresh()},!0),Jt("lineNumbers",!1,function(e){l(e.options),o(e)},!0),Jt("firstLineNumber",1,o,!0),Jt("lineNumberFormatter",function(e){return e},o,!0),Jt("showCursorWhenSelecting",!1,x,!0),Jt("readOnly",!1,function(e,t){t=="nocursor"?(vt(e),e.display.input.blur()):t||Q(e,!0)}),Jt("dragDrop",!0),Jt("cursorBlinkRate",530),Jt("cursorHeight",1),Jt("workTime",100),Jt("workDelay",100),Jt("flattenSpans",!0),Jt("pollInterval",100),Jt("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),Jt("viewportMargin",10,function(e){e.refresh()},!0),Jt("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Jt("autofocus",null);var gi=e.modes={},yi=e.mimeModes={};e.defineMode=function(t,n){!e.defaults.mode&&"null"!=t&&(e.defaults.mode=t);if(2<arguments.length){n.dependencies=[];for(var r=2;r<arguments.length;++r)n.dependencies.push(arguments[r])}gi[t]=n},e.defineMIME=function(e,t){yi[e]=t},e.resolveMode=function(t){if("string"==typeof t&&yi.hasOwnProperty(t))t=yi[t];else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),r=gi[n.name];if(!r)return e.getMode(t,"text/plain");r=r(t,n);if(bi.hasOwnProperty(n.name)){var i=bi[n.name],s;for(s in i)i.hasOwnProperty(s)&&(r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=i[s])}return r.name=n.name,r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var bi=e.modeExtensions={};e.extendMode=function(e,t){var n=bi.hasOwnProperty(e)?bi[e]:bi[e]={};gr(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineOption=Jt;var wi=[];e.defineInitHook=function(e){wi.push(e)},e.copyState=Kt,e.startState=Qt,e.innerMode=function(e,t){for(;e.innerMode;)var n=e.innerMode(t),t=n.state,e=n.mode;return n||{mode:e,state:t}};var Ei=e.commands={selectAll:function(e){e.setSelection(Lt(e.firstLine(),0),Lt(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=!At(t,n);!r&&e.getLine(t.line).length==t.ch?e.replaceRange("",t,Lt(t.line+1,0),"+delete"):e.replaceRange("",t,r?n:Lt(t.line),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",Lt(t,0),Lt(t),"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(Lt(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Lt(e.lastLine()))},goLineStart:function(e){e.extendSelection(Dr(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=Dr(e,t.line),r=e.getLineHandle(n.line),i=zn(r);!i||0==i[0].level?(r=Math.max(0,r.text.search(/\S/)),e.extendSelection(Lt(n.line,t.line==n.line&&t.ch<=r&&t.ch?0:r))):e.extendSelection(n)},goLineEnd:function(e){e.extendSelection(Pr(e,e.getCursor().line))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("	","end","+input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);0<t.ch&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),Lt(t.line,t.ch-1),Lt(t.line,t.ch+1))},newlineAndIndent:function(e){z(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},Si=e.keyMap={};Si.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},Si.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordBefore","Ctrl-Delete":"delWordAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},Si.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordBefore","Ctrl-Alt-Backspace":"delWordAfter","Alt-Delete":"delWordAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},Si["default"]=Yr?Si.macDefault:Si.pcDefault,Si.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},e.lookupKey=Yt,e.isModifierKey=Zt,e.keyName=en,e.fromTextArea=function(t,n){function r(){t.value=l.getValue()}n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex);if(null==n.autofocus){var i=document.body;try{i=document.activeElement}catch(s){}n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form){sr(t.form,"submit",r);var o=t.form,u=o.submit;try{var a=o.submit=function(){r(),o.submit=u,o.submit(),o.submit=a}}catch(f){}}t.style.display="none";var l=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return l.save=r,l.getTextArea=function(){return t},l.toTextArea=function(){r(),t.parentNode.removeChild(l.getWrapperElement()),t.style.display="",t.form&&(or(t.form,"submit",r),typeof t.form.submit=="function"&&(t.form.submit=u))},l},tn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},backUp:function(e){this.pos-=e},column:function(){return hr(this.string,this.start,this.tabSize)},indentation:function(){return hr(this.string,null,this.tabSize)},match:function(e,t,n){if("string"!=typeof e)return(e=this.string.slice(this.pos).match(e))&&0<e.index?null:(e&&!1!==t&&(this.pos+=e[0].length),e);if((n?this.string.toLowerCase():this.string).indexOf(n?e.toLowerCase():e,this.pos)==this.pos)return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)}},e.StringStream=tn,e.TextMarker=nn,nn.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;t&&R(e);for(var n=null,r=null,i=0;i<this.lines.length;++i){var s=this.lines[i],o=un(s.markedSpans,this);null!=o.to&&(r=qn(s));for(var u=s,f=s.markedSpans,l=o,c=void 0,h=0;h<f.length;++h)f[h]!=l&&(c||(c=[])).push(f[h]);u.markedSpans=c,null!=o.from?n=qn(s):this.collapsed&&!dn(this.doc,s)&&e&&In(s,I(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(i=0;i<this.lines.length;++i)s=pn(e.doc,this.lines[i]),o=a(e.doc,s),o>e.display.maxLineLength&&(e.display.maxLine=s,e.display.maxLineLength=o,e.display.maxLineChanged=!0);null!=n&&e&&V(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.collapsed&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&jt(e)),t&&U(e),ar(this,"clear")}},nn.prototype.find=function(){for(var e,t,n=0;n<this.lines.length;++n){var r=this.lines[n],i=un(r.markedSpans,this);if(null!=i.from||null!=i.to)r=qn(r),null!=i.from&&(e=Lt(r,i.from)),null!=i.to&&(t=Lt(r,i.to))}return"bookmark"==this.type?e:e&&{from:e,to:t}},nn.prototype.getOptions=function(e){var t=this.replacedWith;return{className:this.className,inclusiveLeft:this.inclusiveLeft,inclusiveRight:this.inclusiveRight,atomic:this.atomic,collapsed:this.collapsed,clearOnEnter:this.clearOnEnter,replacedWith:e?t&&t.cloneNode(!0):t,readOnly:this.readOnly,startStyle:this.startStyle,endStyle:this.endStyle}},nn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||-1==mr(t.maybeHiddenMarkers,this))&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},nn.prototype.detachLine=function(e){this.lines.splice(mr(this.lines,e),1),!this.lines.length&&this.doc.cm&&(e=this.doc.cm.curOp,(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this))},e.SharedTextMarker=sn,sn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ar(this,"clear")}},sn.prototype.find=function(){return this.primary.find()},sn.prototype.getOptions=function(e){return e=this.primary.getOptions(e),e.shared=!0,e};var xi=e.LineWidget=function(e,t,n){for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};xi.prototype.clear=yn(function(){var e=this.line.widgets,t=qn(this.line);if(null!=t&&e){for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(this.line.widgets=null),In(this.line,Math.max(0,this.line.height-bn(this))),V(this.cm,t,t+1)}}),xi.prototype.changed=yn(function(){var e=this.height;this.height=null;if(e=bn(this)-e)In(this.line,this.line.height+e),e=qn(this.line),V(this.cm,e,e+1)});var Ti={},Ni=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g;_n.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;n<r;++n){var i=this.lines[n];this.height-=i.height;var s=i;s.parent=null,mn(s),ar(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e)),e=0;for(n=t.length;e<n;++e)t[e].parent=this},iterN:function(e,t,n){for(t=e+t;e<t;++e)if(n(this.lines[e]))return!0}},Dn.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(e<i){var s=Math.min(t,i-e),o=r.height;r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null);if(0==(t-=s))break;e=0}else e-=i}25>this.size-t&&(n=[],this.collapse(n),this.children=[new _n(n)],this.children[0].parent=this)},collapse:function(e){for(var t=0,n=this.children.length;t<n;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0,i=this.children.length;r<i;++r){var s=this.children[r],o=s.chunkSize();if(e<=o){s.insertInner(e,t,n);if(s.lines&&50<s.lines.length){for(;50<s.lines.length;)e=s.lines.splice(s.lines.length-25,25),e=new _n(e),s.height-=e.height,this.children.splice(r+1,0,e),e.parent=this;this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(10>=this.children.length)){var e=this;do{var t=e.children.splice(e.children.length-5,5),t=new Dn(t);if(e.parent){e.size-=t.size,e.height-=t.height;var n=mr(e.parent.children,e);e.parent.children.splice(n+1,0,t)}else n=new Dn(e.children),n.parent=e,e.children=[n,t],e=n;t.parent=e.parent}while(10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0,i=this.children.length;r<i;++r){var s=this.children[r],o=s.chunkSize();if(e<o){o=Math.min(t,o-e);if(s.iterN(e,o,n))return!0;if(0==(t-=o))break;e=0}else e-=o}}};var Ci=0,ki=e.Doc=function(e,t,n){if(!(this instanceof ki))return new ki(e,t,n);null==n&&(n=0),Dn.call(this,[new _n([En("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=Wn(),this.frontier=n,n=Lt(n,0),this.sel={from:n,to:n,head:n,anchor:n,shift:!1,extend:!1,goalColumn:null},this.id=++Ci,this.modeOption=t,"string"==typeof e&&(e=Ri(e)),Mn(this,{from:n,to:n,text:e},null,{head:n,anchor:n})};ki.prototype=function(e,t){function n(){}n.prototype=e;var r=new n;return t&&gr(t,r),r}(Dn.prototype,{iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0,i=t.length;r<i;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Fn(this,this.first,this.first+this.size);return!1===e?t:t.join(e||"\n")},setValue:function(e){var t=Lt(this.first,0),n=this.first+this.size-1;Et(this,{from:t,to:Lt(n,Bn(this,n).text.length),text:Ri(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,n,r){t=_t(this,t),n=n?_t(this,n):t,kt(this,e,t,n,r)},getRange:function(e,t,n){return e=jn(this,_t(this,e),_t(this,t)),!1===n?e:e.join(n||"\n")},getLine:function(e){return(e=this.getLineHandle(e))&&e.text},setLine:function(e,t){Pt(this,e)&&kt(this,t,Lt(e,0),_t(this,Lt(e)))},removeLine:function(e){Pt(this,e)&&kt(this,"",Lt(e,0),_t(this,Lt(e+1,0)))},getLineHandle:function(e){if(Pt(this,e))return Bn(this,e)},getLineNumber:function(e){return qn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return _t(this,e)},getCursor:function(e){var t=this.sel;return Mt(null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||!1===e?t.to:t.from)},somethingSelected:function(){return!At(this.sel.head,this.sel.anchor)},setCursor:W(function(e,t,n){e=_t(this,"number"==typeof e?Lt(e,t||0):e),n?Ht(this,e):Bt(this,e,e)}),setSelection:W(function(e,t){Bt(this,_t(this,e),_t(this,t||e))}),extendSelection:W(function(e,t){Ht(this,_t(this,e),t&&_t(this,t))}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,n){Et(this,{from:this.sel.from,to:this.sel.to,text:Ri(e),origin:n},t||"around")},undo:W(function(){xt(this,"undo")}),redo:W(function(){xt(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=Wn()},markClean:function(){this.history.dirtyCounter=0,this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return 0==this.history.dirtyCounter},getHistory:function(){return{done:Kn(this.history.done),undone:Kn(this.history.undone)}},setHistory:function(e){var t=this.history=Wn();t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,n){return rn(this,_t(this,e),_t(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft},e=_t(this,e);return rn(this,e,e,n,"bookmark")},findMarksAt:function(e){var e=_t(this,e),t=[],n=Bn(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},getAllMarks:function(){var e=[];return this.iter(function(t){if(t=t.markedSpans)for(var n=0;n<t.length;++n)null!=t[n].from&&e.push(t[n].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){r=r.text.length+1;if(r>e)return t=e,!0;e-=r,++n}),_t(this,Lt(n,t))},indexFromPos:function(e){var e=_t(this,e),t=e.ch;return e.line<this.first||0>e.ch?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new ki(Fn(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;return null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to),t=new ki(Fn(this,t,n),e.mode||this.modeOption,t),e.sharedHist&&(t.history=this.history),(this.linked||(this.linked=[])).push({doc:t,sharedHist:e.sharedHist}),t.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],t},unlinkDoc:function(t){t instanceof e&&(t=t.doc);if(this.linked)for(var n=0;n<this.linked.length;++n)if(this.linked[n].doc==t){this.linked.splice(n,1),t.unlinkDoc(this);break}if(t.history==this.history){var r=[t.id];Pn(t,function(e){r.push(e.id)},!0),t.history=Wn(),t.history.done=Kn(this.history.done,r),t.history.undone=Kn(this.history.undone,r)}},iterLinkedDocs:function(e){Pn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ki.prototype.eachLine=ki.prototype.iter;var Li=["iter","insert","remove","copy","getEditor"],Ai;for(Ai in ki.prototype)ki.prototype.hasOwnProperty(Ai)&&0>mr(Li,Ai)&&(e.prototype[Ai]=function(e){return function(){return e.apply(this.doc,arguments)}}(ki.prototype[Ai]));e.e_stop=rr,e.e_preventDefault=tr,e.e_stopPropagation=nr;var Oi,Mi=0;e.on=sr,e.off=or,e.signal=ur;var _i=30,Di=e.Pass={toString:function(){return"CodeMirror.Pass"}};cr.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},e.countColumn=hr;var Pi=[""],Hi=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,Bi=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;e.replaceGetRect=function(e){Cr=e};var ji=function(){if(qr)return!1;var e=Sr("div");return"draggable"in e||"dragDrop"in e}(),Fi=/^$/;jr?Fi=/$'/:Xr?Fi=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:zr&&(Fi=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);var Ii,qi,Ri=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;t<=r;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var s=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),o=s.indexOf("\r");-1!=o?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)};e.splitLines=Ri;var Ui=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return!t||t.parentElement()!=e?!1:0!=t.compareEndPoints("StartToEnd",t)},zi=function(){var e=Sr("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Wi={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};e.keyNames=Wi,function(){for(var e=0;10>e;e++)Wi[e+48]=""+e;for(e=65;90>=e;e++)Wi[e]=String.fromCharCode(e);for(e=1;12>=e;e++)Wi[e+111]=Wi[e+63235]="F"+e}();var Xi=function(){function e(e){return 255>=e?t.charAt(e):1424<=e&&1524>=e?"R":1536<=e&&1791>=e?n.charAt(e-1536):1792<=e&&2220>=e?"r":"L"}var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/;return function(t){if(!r.test(t))return!1;for(var n=t.length,a=[],f=0,l;f<n;++f)a.push(e(t.charCodeAt(f)));for(var f=0,c="L";f<n;++f)l=a[f],"m"==l?a[f]=c:c=l;f=0;for(c="L";f<n;++f)l=a[f],"1"==l&&"r"==c?a[f]="n":s.test(l)&&(c=l,"r"==l&&(a[f]="R"));f=1;for(c=a[0];f<n-1;++f)l=a[f],"+"==l&&"1"==c&&"1"==a[f+1]?a[f]="1":","==l&&c==a[f+1]&&("1"==c||"n"==c)&&(a[f]=c),c=l;for(f=0;f<n;++f)if(l=a[f],","==l)a[f]="N";else if("%"==l){for(c=f+1;c<n&&"%"==a[c];++c);var h=f&&"!"==a[f-1]||c<n-1&&"1"==a[c]?"1":"N";for(l=f;l<c;++l)a[l]=h;f=c-1}f=0;for(c="L";f<n;++f)l=a[f],"L"==c&&"1"==l?a[f]="L":s.test(l)&&(c=l);for(f=0;f<n;++f)if(i.test(a[f])){for(c=f+1;c<n&&i.test(a[c]);++c);l="L"==(c<n-1?a[c]:"L"),h="L"==(f?a[f-1]:"L")||l?"L":"R";for(l=f;l<c;++l)a[l]=h;f=c-1}for(var c=[],p,f=0;f<n;)if(o.test(a[f])){l=f;for(++f;f<n&&o.test(a[f]);++f);c.push({from:l,to:f,level:0})}else{var d=f,h=c.length;for(++f;f<n&&"L"!=a[f];++f);for(l=d;l<f;)if(u.test(a[l])){d<l&&c.splice(h,0,{from:d,to:l,level:1}),d=l;for(++l;l<f&&u.test(a[l]);++l);c.splice(h,0,{from:d,to:l,level:2}),d=l}else++l;d<f&&c.splice(h,0,{from:d,to:f,level:1})}return 1==c[0].level&&(p=t.match(/^\s+/))&&(c[0].from=p[0].length,c.unshift({from:0,to:p[0].length,level:0})),1==dr(c).level&&(p=t.match(/\s+$/))&&(dr(c).to-=p[0].length,c.push({from:n-p[0].length,to:n,level:0})),c[0].level!=dr(c).level&&c.push({from:n,to:n,level:c[0].level}),c}}();return e.version="3.1",e}();