window.CodeMirror=function(){function e(n,r){var i,o,a;if(!(this instanceof e))return new e(n,r);this.options=r=r||{};for(i in ci)!r.hasOwnProperty(i)&&ci.hasOwnProperty(i)&&(r[i]=ci[i]);l(r),i=this.display=t(n,"string"==typeof r.value?0:r.value.first),i.wrapper.CodeMirror=this,u(this),r.autofocus&&!Gr&&G(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new cr},s(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),o=r.value,"string"==typeof o&&(o=new xi(r.value,r.mode)),z(this,Hn)(this,o),Fr&&setTimeout(br(Q,this,!0),20),Z(this);try{a=document.activeElement==i.input}catch(f){}a||r.autofocus&&!Gr?setTimeout(br(dt,this),20):vt(this),z(this,function(){for(var e in li)li.propertyIsEnumerable(e)&&li[e](this,r[e],hi);for(e=0;e<mi.length;++e)mi[e](this)})()}function t(e,t){var n={},r=n.input=Sr("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none;"),i;return Rr?r.style.width="1000px":r.setAttribute("wrap","off"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),n.inputDiv=Sr("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=Sr("div",[Sr("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=Sr("div",[Sr("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=Sr("div",null,"CodeMirror-scrollbar-filler"),n.lineDiv=Sr("div"),n.selectionDiv=Sr("div",null,null,"position: relative; z-index: 1"),n.cursor=Sr("div"," ","CodeMirror-cursor"),n.otherCursor=Sr("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"),n.measure=Sr("div",null,"CodeMirror-measure"),n.lineSpace=Sr("div",[n.measure,n.selectionDiv,n.lineDiv,n.cursor,n.otherCursor],null,"position: relative; outline: none"),n.mover=Sr("div",[Sr("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Sr("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=Sr("div"," ",null,"position: absolute; height: "+Li+"px"),n.gutters=Sr("div",null,"CodeMirror-gutters"),n.lineGutter=null,i=Sr("div",[n.sizer,n.heightForcer,n.gutters],null,"position: relative; min-height: 100%"),n.scroller=Sr("div",[i],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Sr("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.scroller],"CodeMirror"),Ir&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),Qr&&(r.style.width="0px"),Rr||(n.scroller.draggable=!0),Vr?(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"):Ir&&(n.scrollbarH.style.minWidth=n.scrollbarV.style.minWidth="18px"),n.viewOffset=n.lastSizeC=0,n.showingFrom=n.showingTo=t,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new cr,n.draggingText=!1,n.cachedCharWidth=n.cachedTextHeight=null,n.measureLineCache=[],n.measureLineCachePos=0,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),t.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),t.doc.frontier=t.doc.first,C(t,100),t.state.modeGen++,t.curOp&&V(t)}function r(e){var t=I(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/q(e.display)-3);return function(i){return dn(e.doc,i)?0:n?(Math.ceil(i.text.length/r)||1)*t:t}}function i(e){var t=e.doc,n=r(e);t.iter(function(e){var t=n(e);t!=e.height&&In(e,t)})}function s(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),_(e)}function o(e){u(e),V(e)}function u(e){var t=e.display.gutters,n=e.options.gutters,r,i,s;xr(t);for(r=0;r<n.length;++r)i=n[r],s=t.appendChild(Sr("div",null,"CodeMirror-gutter "+i)),"CodeMirror-linenumbers"==i&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px");t.style.display=r?"":"none"}function a(e,t){var n,r,i;if(0==t.height)return 0;n=t.text.length;for(i=t;r=cn(i,-1);)r=r.find(),i=Bn(e,r.from.line),n+=r.from.ch-r.to.ch;for(i=t;r=hn(i);)r=r.find(),n-=i.text.length-r.from.ch,i=Bn(e,r.to.line),n+=i.text.length-r.to.ch;return n}function f(e){var t=e.display,n=e.doc;t.maxLine=Bn(n,n.first),t.maxLineLength=a(n,t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var r=a(n,e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)})}function l(e){for(var t=!1,n=0;n<e.gutters.length;++n)"CodeMirror-linenumbers"==e.gutters[n]&&(e.lineNumbers?t=!0:e.gutters.splice(n--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function c(e,t){var n=t+2*e.lineSpace.offsetTop;e.sizer.style.minHeight=e.heightForcer.style.top=n+"px";var n=Math.max(n,e.scroller.scrollHeight),r=e.scroller.scrollWidth>e.scroller.clientWidth,i=n>e.scroller.clientHeight;i?(e.scrollbarV.style.display="block",e.scrollbarV.style.bottom=r?kr(e.measure)+"px":"0",e.scrollbarV.firstChild.style.height=n-e.scroller.clientHeight+e.scrollbarV.clientHeight+"px"):e.scrollbarV.style.display="",r?(e.scrollbarH.style.display="block",e.scrollbarH.style.right=i?kr(e.measure)+"px":"0",e.scrollbarH.firstChild.style.width=e.scroller.scrollWidth-e.scroller.clientWidth+e.scrollbarH.clientWidth+"px"):e.scrollbarH.style.display="",r&&i?(e.scrollbarFiller.style.display="block",e.scrollbarFiller.style.height=e.scrollbarFiller.style.width=kr(e.measure)+"px"):e.scrollbarFiller.style.display="",$r&&0===kr(e.measure)&&(e.scrollbarV.style.minWidth=e.scrollbarH.style.minHeight=Jr?"18px":"12px")}function h(e,t,n){var r=e.scroller.scrollTop,i=e.wrapper.clientHeight,s;return"number"==typeof n?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-e.lineSpace.offsetTop),s=Math.ceil(r+i),{from:Rn(t,r),to:Rn(t,s)}}function p(e){var t=e.display,n,r,i;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){var s=v(t)-t.scroller.scrollLeft+e.doc.scrollLeft,o=t.gutters.offsetWidth,u=s+"px";for(n=t.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable){r=0;for(i=n.alignable;r<i.length;++r)i[r].style.left=u}e.options.fixedGutter&&(t.gutters.style.left=s+o+"px")}}function d(e){if(!e.options.lineNumbers)return!1;var t=e.doc,t=""+e.options.lineNumberFormatter(t.first+t.size-1+e.options.firstLineNumber),e=e.display;if(t.length!=e.lineNumChars){var n=e.measure.appendChild(Sr("div",[Sr("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt")),r=n.firstChild.offsetWidth,n=n.offsetWidth-r;return e.lineGutter.style.width="",e.lineNumInnerWidth=Math.max(r,e.lineGutter.offsetWidth-n),e.lineNumWidth=e.lineNumInnerWidth+n,e.lineNumChars=e.lineNumInnerWidth?t.length:-1,e.lineGutter.style.width=e.lineNumWidth+"px",!0}return!1}function v(e){return Cr(e.scroller).left-Cr(e.sizer).left}function m(e,t,n){var r=e.display.showingFrom,i=e.display.showingTo,t=g(e,t,n);return t&&(ar(e,"update",e),(e.display.showingFrom!=r||e.display.showingTo!=i)&&ar(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),x(e),c(e.display,e.doc.height),t}function g(e,t,n){var r=e.display,i=e.doc,s,o,u,a,f,l,c,p,v,m,w,S;if(r.wrapper.clientWidth){if(s=h(r,i,n),0!=t.length||!(s.from>r.showingFrom)||!(s.to<r.showingTo)){if(d(e)&&(t=[{from:i.first,to:i.first+i.size}]),o=r.sizer.style.marginLeft=r.gutters.offsetWidth+"px",r.scrollbarH.style.left=e.options.fixedGutter?o:"0",u=Infinity,e.options.lineNumbers)for(c=0;c<t.length;++c)if(t[c].diff){u=t[c].from;break}c=i.first+i.size,o=Math.max(s.from-e.options.viewportMargin,i.first),s=Math.min(c,s.to+e.options.viewportMargin);if(r.showingFrom<o&&20>o-r.showingFrom&&(o=Math.max(i.first,r.showingFrom)),r.showingTo>s&&20>r.showingTo-s&&(s=Math.min(c,r.showingTo)),Ui)for(o=qn(pn(i,Bn(i,o)));s<c&&dn(i,Bn(i,s));)++s;if(a=[{from:Math.max(r.showingFrom,i.first),to:Math.min(r.showingTo,c)}],a=a[0].from>=a[0].to?[]:b(a,t),Ui)for(c=0;c<a.length;++c)for(t=a[c];f=hn(Bn(i,t.to-1));){if(l=f.find().from.line,!(l>t.from)){a.splice(c--,1);break}t.to=l}for(c=l=0;c<a.length;++c)t=a[c],t.from<o&&(t.from=o),t.to>s&&(t.to=s),t.from>=t.to?a.splice(c--,1):l+=t.to-t.from;if(l!=s-o||o!=r.showingFrom||s!=r.showingTo){a.sort(function(e,t){return e.from-t.from}),c=document.activeElement,l<.7*(s-o)&&(r.lineDiv.style.display="none"),E(e,o,s,a,u),r.lineDiv.style.display="",document.activeElement!=c&&c.offsetHeight&&c.focus(),(u=o!=r.showingFrom||s!=r.showingTo||r.lastSizeC!=r.wrapper.clientHeight)&&(r.lastSizeC=r.wrapper.clientHeight),r.showingFrom=o,r.showingTo=s,C(e,100),u=r.lineDiv.offsetTop;for(a=r.lineDiv.firstChild;a;a=a.nextSibling)if(a.lineObj&&(Ir?(v=a.offsetTop+a.offsetHeight,p=v-u,u=v):(m=Cr(a),p=m.bottom-m.top),w=a.lineObj.height-p,2>p&&(p=I(r)),(.001<w||-0.001>w)&&(In(a.lineObj,p),S=a.lineObj.widgets,S)))for(c=0;c<S.length;++c)S[c].height=S[c].node.offsetHeight;return y(e),h(r,i,n).to>s&&g(e,[],n),!0}y(e)}}else r.showingFrom=r.showingTo=i.first,r.viewOffset=0}function y(e){var t=e.display.viewOffset=Un(e,Bn(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function b(e,t){for(var n,r,i,s=0,o=t.length||0;s<o;++s){var u=t[s],a=[],f=u.diff||0;n=0;for(r=e.length;n<r;++n)i=e[n],u.to<=i.from&&u.diff?a.push({from:i.from+f,to:i.to+f}):u.to<=i.from||u.from>=i.to?a.push(i):(u.from>i.from&&a.push({from:i.from,to:u.from}),u.to<i.to&&a.push({from:u.to+f,to:i.to+f}));e=a}return e}function w(e){for(var t=e.display,n={},r={},i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:v(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function E(e,t,n,r,i){function s(t){var n=t.nextSibling;return Rr&&Yr&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):t.parentNode.removeChild(t),n}var o=w(e),u=e.display,a=e.options.lineNumbers,f,l,c,h;r.length||Rr&&e.display.currentWheelTarget||xr(u.lineDiv),f=u.lineDiv,l=f.firstChild,c=r.shift(),h=t;for(e.doc.iter(t,n,function(t){var n,u,p,d,v;if(c&&c.to==h&&(c=r.shift()),dn(e.doc,t)){if(0!=t.height&&In(t,0),t.widgets&&l.previousSibling)for(n=0;n<t.widgets.length;++n)t.widgets[n].showIfHidden&&(u=l.previousSibling,/pre/i.test(u.nodeName)&&(p=Sr("div",null,null,"position: relative"),u.parentNode.replaceChild(p,u),p.appendChild(u),u=p),d=u.appendChild(Sr("div",[t.widgets[n].node],"CodeMirror-linewidget")),S(t.widgets[n],d,u,o))}else if(c&&c.from<=h&&c.to>h){for(;l.lineObj!=t;)l=s(l);a&&i<=h&&l.lineNumber&&Nr(l.lineNumber,""+e.options.lineNumberFormatter(h+e.options.firstLineNumber)),l=l.nextSibling}else{if(t.widgets){u=0;for(p=l;p&&20>u;++u,p=p.nextSibling)if(p.lineObj==t&&/div/i.test(p.nodeName)){n=p;break}}var m;u=e;var g=h;d=n,p=kn(u,t);var y=t.gutterMarkers,b=u.display,w,E,x,T,N,C,k,L,A;if(!u.options.lineNumbers&&!y&&!t.bgClass&&!t.wrapClass&&!t.widgets)m=p;else{if(d){d.alignable=null,w=!0,E=0;for(x=d.firstChild;x;x=T)if(T=x.nextSibling,/\bCodeMirror-linewidget\b/.test(x.className)){A=0;for(N=!0;A<t.widgets.length;++A)if(L=t.widgets[A],C=!1,L.above||(C=N,N=!1),L.node==x.firstChild){S(L,x,d,o),++E,C&&d.insertBefore(p,x);break}if(A==t.widgets.length){w=!1;break}}else d.removeChild(x);w&&E==t.widgets.length&&(m=d,d.className=t.wrapClass||"")}if(m||(m=Sr("div",null,t.wrapClass,"position: relative"),m.appendChild(p)),t.bgClass&&m.insertBefore(Sr("div"," ",t.bgClass+" CodeMirror-linebackground"),m.firstChild),(u.options.lineNumbers||y)&&(k=m.insertBefore(Sr("div",null,null,"position: absolute; left: "+(u.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px"),m.firstChild),u.options.fixedGutter&&(m.alignable||(m.alignable=[])).push(k),!u.options.lineNumbers||y&&y["CodeMirror-linenumbers"]||(m.lineNumber=k.appendChild(Sr("div",""+u.options.lineNumberFormatter(g+u.options.firstLineNumber),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+b.lineNumInnerWidth+"px"))),y))for(L=0;L<u.options.gutters.length;++L)A=u.options.gutters[L],(g=y.hasOwnProperty(A)&&y[A])&&k.appendChild(Sr("div",[g],"CodeMirror-gutter-elt","left: "+o.gutterLeft[A]+"px; width: "+o.gutterWidth[A]+"px"));if(Ir&&(m.style.zIndex=2),t.widgets&&m!=d){A=0;for(d=t.widgets;A<d.length;++A)L=d[A],y=Sr("div",[L.node],"CodeMirror-linewidget"),S(L,y,m,o),L.above?m.insertBefore(y,u.options.lineNumbers&&0!=t.height?k:p):m.appendChild(y),ar(L,"redraw")}}if(v=m,v!=n)f.insertBefore(v,l);else{for(;l!=n;)l=s(l);l=l.nextSibling}v.lineObj=t}++h});l;)l=s(l)}function S(e,t,n,r){e.noHScroll&&((n.alignable||(n.alignable=[])).push(t),n=r.wrapperWidth,t.style.left=r.fixedPos+"px",e.coverGutter||(n-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=n+"px"),e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function x(e){var t=e.display,n=At(e.doc.sel.from,e.doc.sel.to);if(n||e.options.showCursorWhenSelecting){var r=e.display,i=H(e,e.doc.sel.head,"div");r.cursor.style.left=i.left+"px",r.cursor.style.top=i.top+"px",r.cursor.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",r.cursor.style.display="",i.other?(r.otherCursor.style.display="",r.otherCursor.style.left=i.other.left+"px",r.otherCursor.style.top=i.other.top+"px",r.otherCursor.style.height=.85*(i.other.bottom-i.other.top)+"px"):r.otherCursor.style.display="none"}else t.cursor.style.display=t.otherCursor.style.display="none";n?t.selectionDiv.style.display="none":T(e),e=H(e,e.doc.sel.head,"div"),n=Cr(t.wrapper),r=Cr(t.lineDiv),t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,e.top+r.top-n.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,e.left+r.left-n.left))+"px"}function T(e){function t(e,t,n,r){0>t&&(t=0),o.appendChild(Sr("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function n(n,r,s,o){var f=Bn(i,n),l=f.text.length,c=o?Infinity:-Infinity;return Ar(zn(f),r||0,null==s?l:s,function(i,h,p){var d=P(e,Lt(n,"rtl"==p?h-1:i),"div",f),p=P(e,Lt(n,"rtl"==p?i:h-1),"div",f),v=d.left,m=p.right;3<p.top-d.top&&(t(v,d.top,null,d.bottom),v=a,d.bottom<p.top&&t(v,d.bottom,null,p.top)),null==s&&h==l&&(m=u),null==r&&0==i&&(v=a),c=o?Math.min(p.top,c):Math.max(p.bottom,c),v<a+1&&(v=a),t(v,p.top,m-v,p.bottom)}),c}var r=e.display,i=e.doc,s=e.doc.sel,o=document.createDocumentFragment(),u=r.lineSpace.offsetWidth,a=Tr(e.display.measure,Sr("pre",null,null,"text-align: left")).appendChild(Sr("span","x")).offsetLeft,f,l,c;if(s.from.line==s.to.line)n(s.from.line,s.from.ch,s.to.ch);else{var h=l=Bn(i,s.from.line);c=[s.from.line,s.from.ch];for(var p;h=hn(h);){if(f=h.find(),c.push(f.from.ch,f.to.line,f.to.ch),f.to.line==s.to.line){c.push(s.to.ch),p=!0;break}h=Bn(i,f.to.line)}if(p)for(s=0;s<c.length;s+=3)n(c[s],c[s+1],c[s+2]);else c=Bn(i,s.to.line),l=s.from.ch?n(s.from.line,s.from.ch,null,!1):Un(e,l)-r.viewOffset,s=s.to.ch?n(s.to.line,cn(c,-1)?null:0,s.to.ch,!0):Un(e,c)-r.viewOffset,l<s&&t(a,l,null,s)}Tr(r.selectionDiv,o),r.selectionDiv.style.display=""}function N(e){var t=e.display,n;clearInterval(t.blinker),n=!0,t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.offsetHeight&&(t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden")},e.options.cursorBlinkRate)}function C(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,br(k,e))}function k(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.showingTo)){var n=+(new Date)+e.options.workTime,r=Kt(t.mode,A(e,t.frontier)),i=[],s;t.iter(t.frontier,Math.min(t.first+t.size,e.display.showingTo+500),function(o){var u,a,f;if(t.frontier>=e.display.showingFrom){u=o.styles,o.styles=Tn(e,o,r),a=!u||u.length!=o.styles.length;for(f=0;!a&&f<u.length;++f)a=u[f]!=o.styles[f];a&&(s&&s.end==t.frontier?s.end++:i.push(s={start:t.frontier,end:t.frontier+1})),o.stateAfter=Kt(t.mode,r)}else Nn(e,o,r),o.stateAfter=0==t.frontier%5?Kt(t.mode,r):null;return++t.frontier,+(new Date)>n?(C(e,e.options.workDelay),!0):void 0}),i.length&&z(e,function(){for(var e=0;e<i.length;++e)V(this,i[e].start,i[e].end)})()}}function L(e,t){for(var n,r,i=e.doc,s,o,u=t,a=t-100;u>a;--u){if(u<=i.first)return i.first;if(s=Bn(i,u-1),s.stateAfter)return u;o=hr(s.text,null,e.options.tabSize),(null==r||n>o)&&(r=u-1,n=o)}return r}function A(e,t){var n=e.doc,r=e.display,i,s;return n.mode.startState?(i=L(e,t),s=i>n.first&&Bn(n,i-1).stateAfter,s=s?Kt(n.mode,s):Qt(n.mode),n.iter(i,t,function(o){Nn(e,o,s),o.stateAfter=i==t-1||0==i%5||i>=r.showingFrom&&i<r.showingTo?Kt(n.mode,s):null,++i}),s):!0}function O(e,t,n,r){for(var i=-1,s,r=r||M(e,t),e=n;s=r[e],!s;e+=i)0>i&&0==e&&(i=1);return{left:e<n?s.right:s.left,right:e>n?s.left:s.right,top:s.top,bottom:s.bottom}}function M(e,t){for(var n=e.display,r=e.display.measureLineCache,i,s,o=0;o<r.length;++o)if(s=r[o],s.text==t.text&&s.markedSpans==t.markedSpans&&n.scroller.clientWidth==s.width&&s.classes==t.textClass+"|"+t.bgClass+"|"+t.wrapClass)return s.measure;var u=e.display,o=yr(t.text.length),a=kn(e,t,o),f,l,c,h,p,d,v,m,g,y;if(Fr&&!Ir&&!e.options.lineWrapping&&100<a.childNodes.length){var b=document.createDocumentFragment(),w=a.childNodes.length;v=0;for(f=Math.ceil(w/10);v<f;++v){l=Sr("div",null,null,"display: inline-block");for(c=0;10>c&&w;++c)l.appendChild(a.firstChild),--w;b.appendChild(l)}a.appendChild(b)}Tr(u.measure,a),f=Cr(u.lineDiv),l=[],b=yr(t.text.length),w=a.offsetHeight,qr&&u.measure.first!=a&&Tr(u.measure,a);for(v=0;v<o.length;++v)if(m=o[v]){u=Cr(m),d=Math.max(0,u.top-f.top);var E=Math.min(u.bottom-f.top,w);for(c=0;c<l.length;c+=2)if((h=l[c],p=l[c+1],!(h>E)&&!(p<d))&&(h<=d&&p>=E||d<=h&&E>=p||Math.min(E,p)-Math.max(d,h)>=E-d>>1)){l[c]=Math.min(d,h),l[c+1]=Math.max(E,p);break}c==l.length&&l.push(d,E),d=u.right,m.measureRight&&(d=Cr(m.measureRight).left),b[v]={left:u.left-f.left,right:d-f.left,top:c}}for(v=0;v<b.length;++v)(m=b[v])&&(g=m.top,m.top=l[g],m.bottom=l[g+1]);return i=(e.options.lineWrapping||(y=a.lastChild,3==y.nodeType&&(y=a.appendChild(Sr("span","​"))),b.width=Cr(y).right-f.left),b),s={text:t.text,width:n.scroller.clientWidth,markedSpans:t.markedSpans,measure:i,classes:t.textClass+"|"+t.bgClass+"|"+t.wrapClass},16==r.length?r[++n.measureLineCachePos%16]=s:r.push(s),i}function _(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.display.maxLineChanged=!0,e.display.lineNumChars=null}function D(e,t,n,r){var i,s,o,u,a;if(t.widgets)for(i=0;i<t.widgets.length;++i)t.widgets[i].above&&(s=bn(t.widgets[i]),n.top+=s,n.bottom+=s);return"line"==r?n:(r||(r="local"),o=Un(e,t),"local"!=r&&(o-=e.display.viewOffset),"page"==r&&(u=Cr(e.display.lineSpace),o+=u.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop),a=u.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft),n.left+=a,n.right+=a),n.top+=o,n.bottom+=o,n)}function P(e,t,n,r){return r||(r=Bn(e.doc,t.line)),D(e,r,O(e,r,t.ch),n)}function H(e,t,n,r,i){function s(t,s){var o=O(e,r,t,i);return s?o.left=o.right:o.right=o.left,D(e,r,o,n)}var o,u,a,f,l,c,h,p,d,v;if(r=r||Bn(e.doc,t.line),i||(i=M(e,r)),o=zn(r),t=t.ch,!o)return s(t);f=o[0].level;for(l=0;l<o.length;++l){if(c=o[l],h=c.level%2,c.from<t&&c.to>t)return s(t,h);(d=h?c.to:c.from,p=h?c.from:c.to,d==t)?(p=l&&c.level<(v=o[l-1]).level?s(v.level%2?v.from:v.to-1,!0):s(h&&c.from!=c.to?t-1:t),h==f?u=p:a=p):p==t&&(v=l<o.length-1&&o[l+1],!!h||!v||v.from!=v.to)&&(p=v&&c.level<v.level?s(v.level%2?v.to-1:v.from):s(h?t:t-1,!0),h==f?u=p:a=p)}return(f&&!t&&(a=s(o[0].to-1)),!u)?a:(a&&(u.other=a),u)}function B(e,t,n){return e=new Lt(e,t),n&&(e.outside=!0),e}function j(e,t,n){var r=e.doc,i,s;if(n+=e.display.viewOffset,0>n)return B(r.first,0,!0);if(i=Rn(r,n),s=r.first+r.size-1,i>s)return B(r.first+r.size-1,Bn(r,s).text.length,!0);for(0>t&&(t=0);;){s=Bn(r,i),i=F(e,s,i,t,n);var o=(s=hn(s))&&s.find();if(!(s&&i.ch>=o.from.ch))return i;i=o.to.line}}function F(e,t,n,r,i){function s(r){return r=H(e,Lt(n,r),"line",t,f),(u=!0,o>r.bottom)?Math.max(0,r.left-a):o<r.top?r.left+a:(u=!1,r.left)}var o=i-Un(e,t),u=!1,a=e.display.wrapper.clientWidth,f=M(e,t),l=zn(t),c=t.text.length,h=Mr(t),p=_r(t),d=s(h),i=u,v=s(p),m=u,g,y,b,w;if(r>v)return B(n,p,m);for(;;){if(l?p==h||p==Hr(t,h,1):1>=p-h){for(h=(r=r-d<v-r)?h:p;_i.test(t.text.charAt(h));)++h;return g=B(n,h,r?i:m),g.after=r,g}if(y=Math.ceil(c/2),b=h+y,l){b=h;for(w=0;w<y;++w)b=Hr(t,b,1)}w=s(b),w>r?(p=b,v=w,(m=u)&&(v+=1e3),c-=y):(h=b,d=w,i=u,c=y)}}function I(e){var t,n;if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ti){ti=Sr("pre");for(t=0;49>t;++t)ti.appendChild(document.createTextNode("x")),ti.appendChild(Sr("br"));ti.appendChild(document.createTextNode("x"))}return Tr(e.measure,ti),n=ti.offsetHeight/50,3<n&&(e.cachedTextHeight=n),xr(e.measure),n||1}function q(e){var t,n,r;return null!=e.cachedCharWidth?e.cachedCharWidth:(t=Sr("span","x"),n=Sr("pre",[t]),Tr(e.measure,n),r=t.offsetWidth,2<r&&(e.cachedCharWidth=r),r||10)}function R(e){e.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,updateMaxLine:!1,updateScrollPos:!1,id:++ni},ki++||(Ci=[])}function U(e){var t=e.curOp,n=e.doc,r=e.display,i,s,o,u,a,l,c,h;e.curOp=null,t.updateMaxLine&&f(e),r.maxLineChanged&&!e.options.lineWrapping&&(i=M(e,r.maxLine).width,r.sizer.style.minWidth=Math.max(0,i+3+Li)+"px",r.maxLineChanged=!1,s=Math.max(0,r.sizer.offsetLeft+r.sizer.offsetWidth-r.scroller.clientWidth),s<n.scrollLeft&&!t.updateScrollPos&&ot(e,Math.min(r.scroller.scrollLeft,s),!0)),t.updateScrollPos?o=t.updateScrollPos:t.selectionChanged&&r.scroller.clientHeight&&(a=H(e,n.sel.head),o=Rt(e,a.left,a.top,a.left,a.bottom)),(t.changes.length||o&&null!=o.scrollTop)&&(u=m(e,t.changes,o&&o.scrollTop)),!u&&t.selectionChanged&&x(e),t.updateScrollPos?(r.scroller.scrollTop=r.scrollbarV.scrollTop=n.scrollTop=o.scrollTop,r.scroller.scrollLeft=r.scrollbarH.scrollLeft=n.scrollLeft=o.scrollLeft,p(e)):o&&(n=It(e,e.doc.sel.head),e.state.focused&&(r=e.display,i=Cr(r.sizer),s=null,0>n.top+i.top?s=!0:n.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(s=!1),null==s||Kr||(c="none"==r.cursor.style.display,c&&(r.cursor.style.display="",r.cursor.style.left=n.left+"px",r.cursor.style.top=n.top-r.viewOffset+"px"),r.cursor.scrollIntoView(s),c&&(r.cursor.style.display="none"))));if(t.selectionChanged&&N(e),e.state.focused&&t.updateInput&&Q(e,t.userSelChange),l=t.maybeHiddenMarkers,c=t.maybeUnhiddenMarkers,l)for(n=0;n<l.length;++n)l[n].lines.length||ur(l[n],"hide");if(c)for(n=0;n<c.length;++n)c[n].lines.length&&ur(c[n],"unhide");if(--ki||(h=Ci,Ci=null),t.textChanged&&ur(e,"change",e,t.textChanged),t.selectionChanged&&ur(e,"cursorActivity",e),h)for(n=0;n<h.length;++n)h[n]()}function z(e,t){return function(){var n=e||this,r=!n.curOp,i;r&&R(n);try{i=t.apply(n,arguments)}finally{r&&U(n)}return i}}function W(e){return function(){var t=this.cm&&!this.cm.curOp,n;t&&R(this.cm);try{n=e.apply(this,arguments)}finally{t&&U(this.cm)}return n}}function X(e,t){var n=!e.curOp,r;n&&R(e);try{r=t()}finally{n&&U(e)}return r}function V(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:n,diff:r})}function $(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){K(e),e.state.focused&&$(e)})}function J(e){function t(){K(e)||n?(e.display.pollingFast=!1,$(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function K(e){var t=e.display.input,n=e.display.prevInput,r=e.doc,i=r.sel,s,o,u,a,f,l,c;if(!e.state.focused||zi(t)||Y(e)||(s=t.value,s==n&&At(i.from,i.to)))return!1;if(Fr&&s&&0===t.selectionStart)return Q(e,!0),!1;(o=!e.curOp)&&R(e),i.shift=!1,u=0;for(a=Math.min(n.length,s.length);u<a&&n[u]==s[u];)++u;return f=i.from,l=i.to,u<n.length?f=Lt(f.line,f.ch-(n.length-u)):e.state.overwrite&&At(f,l)&&!e.state.pasteIncoming&&(l=Lt(l.line,Math.min(Bn(r,l.line).text.length,l.ch+(s.length-u)))),c=e.curOp.updateInput,Et(e.doc,{from:f,to:l,text:ji(s.slice(u)),origin:e.state.pasteIncoming?"paste":"+input"},"end"),e.curOp.updateInput=c,1e3<s.length?t.value=e.display.prevInput="":e.display.prevInput=s,o&&U(e),e.state.pasteIncoming=!1,!0}function Q(e,t){var n,r,i=e.doc;At(i.sel.from,i.sel.to)?t&&(e.display.prevInput=e.display.input.value=""):(e.display.prevInput="",n=Wi&&(100<i.sel.to.line-i.sel.from.line||1e3<(r=e.getSelection()).length),e.display.input.value=n?"-":r||e.getSelection(),e.state.focused&&vr(e.display.input)),e.display.inaccurateSelection=n}function G(e){"nocursor"==e.options.readOnly||Gr&&document.activeElement==e.display.input||e.display.input.focus()}function Y(e){return e.options.readOnly||e.doc.cantEdit}function Z(e){function t(){e.state.focused&&setTimeout(br(G,e),0)}function n(){o.cachedCharWidth=o.cachedTextHeight=null,_(e),X(e,br(V,e))}function r(){for(var e=o.wrapper.parentNode;e&&e!=document.body;e=e.parentNode);e?setTimeout(r,5e3):or(window,"resize",n)}function i(t){e.options.onDragEvent&&e.options.onDragEvent(e,er(t))||rr(t)}function s(){o.inaccurateSelection&&(o.prevInput="",o.inaccurateSelection=!1,o.input.value=e.getSelection(),vr(o.input))}var o=e.display;sr(o.scroller,"mousedown",z(e,nt)),sr(o.scroller,"dblclick",z(e,tr)),sr(o.lineSpace,"selectstart",function(e){et(o,e)||tr(e)}),qi||sr(o.scroller,"contextmenu",function(t){mt(e,t)}),sr(o.scroller,"scroll",function(){st(e,o.scroller.scrollTop),ot(e,o.scroller.scrollLeft,!0),ur(e,"scroll",e)}),sr(o.scrollbarV,"scroll",function(){st(e,o.scrollbarV.scrollTop)}),sr(o.scrollbarH,"scroll",function(){ot(e,o.scrollbarH.scrollLeft)}),sr(o.scroller,"mousewheel",function(t){ut(e,t)}),sr(o.scroller,"DOMMouseScroll",function(t){ut(e,t)}),sr(o.scrollbarH,"mousedown",t),sr(o.scrollbarV,"mousedown",t),sr(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0}),sr(window,"resize",n),setTimeout(r,5e3),sr(o.input,"keyup",z(e,function(t){e.options.onKeyEvent&&e.options.onKeyEvent(e,er(t))||16==t.keyCode&&(e.doc.sel.shift=!1)})),sr(o.input,"input",br(J,e)),sr(o.input,"keydown",z(e,ht)),sr(o.input,"keypress",z(e,pt)),sr(o.input,"focus",br(dt,e)),sr(o.input,"blur",br(vt,e)),e.options.dragDrop&&(sr(o.scroller,"dragstart",function(t){var n=e,r,i;et(n.display,t)||(r=n.getSelection(),t.dataTransfer.setData("Text",r),t.dataTransfer.setDragImage&&!Xr&&(i=Sr("img",null,null,"position: fixed; left: 0; top: 0;"),Wr&&(i.width=i.height=1,n.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),Wr&&i.parentNode.removeChild(i)))}),sr(o.scroller,"dragenter",i),sr(o.scroller,"dragover",i),sr(o.scroller,"drop",z(e,rt))),sr(o.scroller,"paste",function(t){et(o,t)||(G(e),J(e))}),sr(o.input,"paste",function(){e.state.pasteIncoming=!0,J(e)}),sr(o.input,"cut",s),sr(o.input,"copy",s),Vr&&sr(o.sizer,"mouseup",function(){document.activeElement==o.input&&o.input.blur(),G(e)})}function et(e,t){for(var n=t.target||t.srcElement;n!=e.wrapper;n=n.parentNode)if(!n||/\bCodeMirror-(?:line)?widget\b/.test(n.className)||n.parentNode==e.sizer&&n!=e.mover)return!0}function tt(e,t,n){var r=e.display,i,s,o;if(!n&&(i=t.target||t.srcElement,i==r.scrollbarH||i==r.scrollbarH.firstChild||i==r.scrollbarV||i==r.scrollbarV.firstChild||i==r.scrollbarFiller))return null;n=Cr(r.lineSpace);try{s=t.clientX,o=t.clientY}catch(u){return null}return j(e,s-n.left,o-n.top)}function nt(e){function t(e){if("single"==l)Ht(i.doc,_t(o,a),e);else if(v=_t(o,v),m=_t(o,m),"double"==l){var t=Vt(Bn(o,e.line).text,e);Ot(e,v)?Ht(i.doc,t.from,m):Ht(i.doc,v,t.to)}else"triple"==l&&(Ot(e,v)?Ht(i.doc,m,_t(o,Lt(e.line,0))):Ht(i.doc,v,_t(o,Lt(e.line+1,0))))}function n(e){var r=++y,u=tt(i,e,!0),a,f;u&&(At(u,p)?(f=e.clientY<g.top?-20:e.clientY>g.bottom?20:0,f&&setTimeout(z(i,function(){y==r&&(s.scroller.scrollTop+=f,n(e))}),50)):(i.state.focused||dt(i),p=u,t(u),a=h(s,o),(u.line>=a.to||u.line<a.from)&&setTimeout(z(i,function(){y==r&&n(e)}),150)))}function r(e){y=Infinity;var n=tt(i,e);n&&t(n),tr(e),G(i),or(document,"mousemove",b),or(document,"mouseup",w)}var i=this,s=i.display,o=i.doc,u=o.sel,a,f,l,c,p,d,v,m,g,y,b,w;if(u.shift=e.shiftKey,et(s,e))Rr||(s.scroller.draggable=!1,setTimeout(function(){s.scroller.draggable=!0},100));else if(!it(i,e)){a=tt(i,e);switch(ir(e)){case 3:qi&&mt.call(i,i,e);return;case 2:a&&Ht(i.doc,a),setTimeout(br(G,i),20),tr(e);return}a?(i.state.focused||dt(i),f=+(new Date),l="single",ii&&ii.time>f-400&&At(ii.pos,a)?(l="triple",tr(e),setTimeout(br(G,i),20),$t(i,a.line)):ri&&ri.time>f-400&&At(ri.pos,a)?(l="double",ii={time:f,pos:a},tr(e),c=Vt(Bn(o,a.line).text,a),Ht(i.doc,c.from,c.to)):ri={time:f,pos:a},p=a,i.options.dragDrop&&Di&&!Y(i)&&!At(u.from,u.to)&&!Ot(a,u.from)&&!Ot(u.to,a)&&"single"==l)?(d=z(i,function(t){Rr&&(s.scroller.draggable=!1),i.state.draggingText=!1,or(document,"mouseup",d),or(s.scroller,"drop",d),10>Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)&&(tr(t),Ht(i.doc,a),G(i))}),Rr&&(s.scroller.draggable=!0),i.state.draggingText=d,s.scroller.dragDrop&&s.scroller.dragDrop(),sr(document,"mouseup",d),sr(s.scroller,"drop",d)):(tr(e),"single"==l&&Ht(i.doc,_t(o,a)),v=u.from,m=u.to,g=Cr(s.wrapper),y=0,b=z(i,function(e){Fr||ir(e)?n(e):r(e)}),w=z(i,r),sr(document,"mousemove",b),sr(document,"mouseup",w)):(e.target||e.srcElement)==s.scroller&&tr(e)}}function rt(e){var t=this,n,r,i,s,o;if(!et(t.display,e)&&(!t.options.onDragEvent||!t.options.onDragEvent(t,er(e)))&&(tr(e),n=tt(t,e,!0),r=e.dataTransfer.files,n&&!Y(t)))if(r&&r.length&&window.FileReader&&window.File){var u=r.length;i=Array(u);var a=0;s=function(e,r){var s=new FileReader;s.onload=function(){i[r]=s.result,++a==u&&(n=_t(t.doc,n),kt(t.doc,i.join(""),n,"around","paste"))},s.readAsText(e)};for(e=0;e<u;++e)s(r[e],e)}else if(t.state.draggingText&&!Ot(n,t.doc.sel.from)&&!Ot(t.doc.sel.to,n))t.state.draggingText(e),setTimeout(br(G,t),20);else try{(i=e.dataTransfer.getData("Text"))&&(s=t.doc.sel.from,o=t.doc.sel.to,Bt(t.doc,n,n),t.state.draggingText&&kt(t.doc,"",s,o,"paste"),t.replaceSelection(i,null,"paste"),G(t),dt(t))}catch(f){}}function it(e,t){var n=e.display,r,i,s,o;try{r=t.clientX,i=t.clientY}catch(u){return!1}if(r>=Math.floor(Cr(n.gutters).right))return!1;if((tr(t),!lr(e,"gutterClick"))||(s=Cr(n.lineDiv),i>s.bottom))return!0;i-=s.top-n.viewOffset;for(s=0;s<e.options.gutters.length;++s)if(o=n.gutters.childNodes[s],o&&Cr(o).right>=r){n=Rn(e.doc,i),r=e.options.gutters[s],ar(e,"gutterClick",e,n,r,t);break}return!0}function st(e,t){2>Math.abs(e.doc.scrollTop-t)||(e.doc.scrollTop=t,jr||m(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),jr&&m(e,[]))}function ot(e,t,n){(n?t==e.doc.scrollLeft:2>Math.abs(e.doc.scrollLeft-t))||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,p(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function ut(e,t){var n=t.wheelDeltaX,r=t.wheelDeltaY,i,s,o;if(null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta),r&&Yr&&Rr)for(i=t.target;i!=o;i=i.parentNode)if(i.lineObj){e.display.currentWheelTarget=i;break}if(s=e.display,o=s.scroller,n&&!jr&&!Wr&&null!=oi)r&&st(e,Math.max(0,Math.min(o.scrollTop+r*oi,o.scrollHeight-o.clientHeight))),ot(e,Math.max(0,Math.min(o.scrollLeft+n*oi,o.scrollWidth-o.clientWidth))),tr(t),s.wheelStartX=null;else{if(r&&null!=oi){i=r*oi;var u=e.doc.scrollTop,a=u+s.wrapper.clientHeight;0>i?u=Math.max(0,u+i-50):a=Math.min(e.doc.height,a+i+50),m(e,[],{top:u,bottom:a})}20>si&&(null==s.wheelStartX?(s.wheelStartX=o.scrollLeft,s.wheelStartY=o.scrollTop,s.wheelDX=n,s.wheelDY=r,setTimeout(function(){if(null!=s.wheelStartX){var e=o.scrollLeft-s.wheelStartX,t=o.scrollTop-s.wheelStartY,e=t&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX;(s.wheelStartX=s.wheelStartY=null,e)&&(oi=(oi*si+e)/(si+1),++si)}},200)):(s.wheelDX+=n,s.wheelDY+=r))}}function at(e,t,n){if("string"==typeof t&&(t=gi[t],!t))return!1;e.display.pollingFast&&K(e)&&(e.display.pollingFast=!1);var r=e.doc,i=r.sel.shift,s=!1;try{Y(e)&&(e.state.suppressEdits=!0),n&&(r.sel.shift=!1),s=t(e)!=Ai}finally{r.sel.shift=i,e.state.suppressEdits=!1}return s}function ft(e){var t=e.state.keyMaps.slice(0);return t.push(e.options.keyMap),e.options.extraKeys&&t.unshift(e.options.extraKeys),t}function lt(e,t){var n=Gt(e.options.keyMap),r=n.auto,i,s,o;return(clearTimeout(ui),r&&!Zt(t)&&(ui=setTimeout(function(){Gt(e.options.keyMap)==n&&(e.options.keyMap=r.call?r.call(null,e):r)},50)
),i=en(t,!0),s=!1,!i)?!1:(o=ft(e),s=t.shiftKey?Yt("Shift-"+i,o,function(t){return at(e,t,!0)})||Yt(i,o,function(t){if(typeof t=="string"&&/^go[A-Z]/.test(t))return at(e,t)}):Yt(i,o,function(t){return at(e,t)}),"stop"==s&&(s=!1),s&&(tr(t),N(e),qr&&(t.oldKeyCode=t.keyCode,t.keyCode=0)),s)}function ct(e,t,n){return n=Yt("'"+n+"'",ft(e),function(t){return at(e,t,!0)}),n&&(tr(t),N(e)),n}function ht(e){var t,n;(this.state.focused||dt(this),Fr&&27==e.keyCode&&(e.returnValue=!1),this.options.onKeyEvent&&this.options.onKeyEvent(this,er(e)))||(t=e.keyCode,this.doc.sel.shift=16==t||e.shiftKey,n=lt(this,e),Wr&&(ai=n?t:null,n||88!=t||Wi||(Yr?!e.metaKey:!e.ctrlKey)||this.replaceSelection("")))}function pt(e){var t=this,n,r,i;if(!t.options.onKeyEvent||!t.options.onKeyEvent(t,er(e)))(n=e.keyCode,r=e.charCode,Wr&&n==ai)?(ai=null,tr(e)):(Wr&&(!e.which||10>e.which)||Vr)&&lt(t,e)||(i=String.fromCharCode(null==r?n:r),this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!Y(this)&&-1<this.doc.mode.electricChars.indexOf(i)&&setTimeout(z(t,function(){Ut(t,t.doc.sel.to.line,"smart")}),75),ct(t,e,i))||J(t)}function dt(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(ur(e,"focus",e),e.state.focused=!0,-1==e.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(e.display.wrapper.className+=" CodeMirror-focused"),Q(e,!0)),$(e),N(e))}function vt(e){e.state.focused&&(ur(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function mt(e,t){function n(){var t,n,s;r.inputDiv.style.position="relative",r.input.style.cssText=u,qr&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=o),$(e),null!=r.input.selectionStart&&(!Fr||qr)&&(clearTimeout(fi),t=r.input.value=" "+(At(i.from,i.to)?"":r.input.value),n=0,r.prevInput=" ",r.input.selectionStart=1,r.input.selectionEnd=t.length,s=function(){" "==r.prevInput&&0==r.input.selectionStart?z(e,gi.selectAll)(e):10>n++?fi=setTimeout(s,500):Q(e)},fi=setTimeout(s,200))}var r=e.display,i=e.doc.sel,s,o,u,a;et(r,t)||(s=tt(e,t),o=r.scroller.scrollTop,s&&!Wr)&&((At(i.from,i.to)||Ot(s,i.from)||!Ot(s,i.to))&&z(e,Bt)(e.doc,s,s),u=r.input.style.cssText,r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",G(e),Q(e,!0),At(i.from,i.to)&&(r.input.value=r.prevInput=" "),qi?(rr(t),a=function(){or(window,"mouseup",a),setTimeout(n,20)},sr(window,"mouseup",a)):setTimeout(n,50))}function gt(e){return Lt(e.from.line+e.text.length-1,dr(e.text).length+(1==e.text.length?e.from.ch:0))}function yt(e,t,n){var r,i,s,o;return Ot(t.from,n)?(r=t.text.length-1-(t.to.line-t.from.line),n.line>t.to.line+r)?(i=n.line-r,s=e.first+e.size-1,i>s)?Lt(s,Bn(e,s).text.length):Dt(n,Bn(e,i).text.length):n.line==t.to.line+r?Dt(n,dr(t.text).length+(1==t.text.length?t.from.ch:0)+Bn(e,t.to.line).text.length-t.to.ch):(o=n.line-t.from.line,Dt(n,t.text[o].length+(o?0:t.from.ch))):_t(e,n)}function bt(e,t,n){var r,i;return n&&"object"==typeof n?{anchor:yt(e,t,n.anchor),head:yt(e,t,n.head)}:"start"==n?{anchor:t.from,head:t.from}:(r=gt(t),"around"==n)?{anchor:t.from,head:r}:"end"==n?{anchor:r,head:r}:(i=function(e){if(Ot(e,t.from))return e;if(!Ot(t.to,e))return r;var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=r.ch-t.to.ch),Lt(n,i)},{anchor:i(e.sel.anchor),head:i(e.sel.head)})}function wt(e,t){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,update:function(t,n,r,i){t&&(this.from=_t(e,t)),n&&(this.to=_t(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)},cancel:function(){this.canceled=!0}};return(ur(e,"beforeChange",e,n),e.cm&&ur(e.cm,"beforeChange",e.cm,n),n.canceled)?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Et(e,t,n,r){var i;if(e.cm){if(!e.cm.curOp)return z(e.cm,Et)(e,t,n,r);if(e.cm.state.suppressEdits)return}if(!lr(e,"beforeChange")&&(!e.cm||!lr(e.cm,"beforeChange"))||(t=wt(e,t),t))if(i=Ri&&!r&&ln(e,t.from,t.to),i){for(r=i.length-1;1<=r;--r)St(e,{from:i[r].from,to:i[r].to,text:[""]});i.length&&St(e,{from:i[0].from,to:i[0].to,text:t.text},n)}else St(e,t,n)}function St(e,t,n){var n=bt(e,t,n),r;$n(e,t,n,e.cm?e.cm.curOp.id:NaN),Nt(e,t,n,an(e,t)),r=[],Pn(e,function(e,n){n||-1!=mr(r,e.history)||(Yn(e.history,t),r.push(e.history)),Nt(e,t,null,an(e,t))})}function xt(e,t){var n=e.history,r=("undo"==t?n.done:n.undone).pop(),i,s,o,u;if(r){n.dirtyCounter+="undo"==t?-1:1,i={changes:[],anchorBefore:r.anchorAfter,headBefore:r.headAfter,anchorAfter:r.anchorBefore,headAfter:r.headBefore},("undo"==t?n.undone:n.done).push(i);for(n=r.changes.length-1;0<=n;--n)s=r.changes[n],s.origin=t,i.changes.push(Vn(e,s)),o=n?bt(e,s,null):{anchor:r.anchorBefore,head:r.headBefore},Nt(e,s,o,fn(e,s)),u=[],Pn(e,function(e,t){t||-1!=mr(u,e.history)||(Yn(e.history,s),u.push(e.history)),Nt(e,s,null,fn(e,s))})}}function Tt(e,t){function n(e){return Lt(e.line+t,e.ch)}e.first+=t,e.cm&&V(e.cm,e.first,e.first,t),e.sel.head=n(e.sel.head),e.sel.anchor=n(e.sel.anchor),e.sel.from=n(e.sel.from),e.sel.to=n(e.sel.to)}function Nt(e,t,n,r){var i,s;if(e.cm&&!e.cm.curOp)return z(e.cm,Nt)(e,t,n,r);t.to.line<e.first?Tt(e,t.text.length-1-(t.to.line-t.from.line)):t.from.line>e.lastLine()||(t.from.line<e.first&&(i=t.text.length-1-(e.first-t.from.line),Tt(e,i),t={from:Lt(e.first,0),to:Lt(t.to.line+i,t.to.ch),text:[dr(t.text)],origin:t.origin}),s=e.lastLine(),t.to.line>s&&(t={from:t.from,to:Lt(s,Bn(e,s).text.length),text:[t.text[0]],origin:t.origin}),n||(n=bt(e,t,null)),e.cm?Ct(e.cm,t,r,n):Mn(e,t,r,n))}function Ct(e,t,n,i){var s=e.doc,o=e.display,u=t.from,f=t.to,l=!1,c=u.line,h;if(e.options.lineWrapping||(c=qn(pn(s,Bn(s,u.line))),s.iter(c,f.line+1,function(e){if(e==o.maxLine)return l=!0,!0})),Mn(s,t,n,i,r(e)),e.options.lineWrapping||(s.iter(c,u.line+t.text.length,function(e){var t=a(s,e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),s.frontier=Math.min(s.frontier,u.line),C(e,400),h=t.text.length-(f.line-u.line)-1,V(e,u.line,f.line+1,h),lr(e,"change"))if(t={from:u,to:f,text:t.text,origin:t.origin},e.curOp.textChanged){for(e=e.curOp.textChanged;e.next;e=e.next);e.next=t}else e.curOp.textChanged=t}function kt(e,t,n,r,i){if(r||(r=n),Ot(r,n))var s=r,r=n,n=s;"string"==typeof t&&(t=ji(t)),Et(e,{from:n,to:r,text:t,origin:i},null)}function Lt(e,t){if(!(this instanceof Lt))return new Lt(e,t);this.line=e,this.ch=t}function At(e,t){return e.line==t.line&&e.ch==t.ch}function Ot(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Mt(e){return Lt(e.line,e.ch)}function _t(e,t){if(t.line<e.first)return Lt(e.first,0);var n=e.first+e.size-1;return t.line>n?Lt(n,Bn(e,n).text.length):Dt(t,Bn(e,t.line).text.length)}function Dt(e,t){var n=e.ch;return null==n||n>t?Lt(e.line,t):0>n?Lt(e.line,0):e}function Pt(e,t){return t>=e.first&&t<e.first+e.size}function Ht(e,t,n,r){var i,s;e.sel.shift||e.sel.extend?(i=e.sel.anchor,n&&(s=Ot(t,i),s!=Ot(n,i)?(i=t,t=n):s!=Ot(t,n)&&(t=n)),Bt(e,i,t,r)):Bt(e,t,n||t,r),e.cm&&(e.cm.curOp.userSelChange=!0)}function Bt(e,t,n,r,i){var s,o;if(!i&&lr(e,"beforeSelectionChange")||e.cm&&lr(e.cm,"beforeSelectionChange"))n={anchor:t,head:n},t=(ur(e,"beforeSelectionChange",e,n),e.cm&&ur(e.cm,"beforeSelectionChange",e.cm,n),n.anchor=_t(e,n.anchor),n.head=_t(e,n.head),n),n=t.head,t=t.anchor;(s=e.sel,s.goalColumn=null,(i||!At(t,s.anchor))&&(t=Ft(e,t,r,"push"!=i)),(i||!At(n,s.head))&&(n=Ft(e,n,r,"push"!=i)),At(s.anchor,t)&&At(s.head,n))||(s.anchor=t,s.head=n,o=Ot(n,t),s.from=o?n:t,s.to=o?t:n,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0),ar(e,"cursorActivity",e))}function jt(e){Bt(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function Ft(e,t,n,r){var i=!1,s=t,o=n||1,u,a,f,l,c,h;e.cantEdit=!1;e:for(;;){if(u=Bn(e,s.line),u.markedSpans){for(h=0;h<u.markedSpans.length;++h)if(f=u.markedSpans[h],l=f.marker,(null==f.from||(l.inclusiveLeft?f.from<=s.ch:f.from<s.ch))&&(null==f.to||(l.inclusiveRight?f.to>=s.ch:f.to>s.ch)))if(r&&l.clearOnEnter)(a||(a=[])).push(l);else if(l.atomic){if(c=l.find()[0>o?"from":"to"],At(c,s)&&(c.ch+=o,0>c.ch?c=c.line>e.first?_t(e,Lt(c.line-1)):null:c.ch>u.text.length&&(c=c.line<e.first+e.size-1?Lt(c.line+1,0):null),!c)){if(i)return r?(e.cantEdit=!0,Lt(e.first,0)):Ft(e,t,n,!0);i=!0,c=t,o=-o}s=c;continue e}if(a)for(h=0;h<a.length;++h)a[h].clear()}return s}}function It(e,t){for(;;){var n=!1,r=H(e,t),i=Rt(e,r.left,r.top,r.left,r.bottom),s=e.doc.scrollTop,o=e.doc.scrollLeft;if(null!=i.scrollTop&&(st(e,i.scrollTop),1<Math.abs(e.doc.scrollTop-s)&&(n=!0)),null!=i.scrollLeft&&(ot(e,i.scrollLeft),1<Math.abs(e.doc.scrollLeft-o)&&(n=!0)),!n)return r}}function qt(e,t,n,r,i){t=Rt(e,t,n,r,i),null!=t.scrollTop&&st(e,t.scrollTop),null!=t.scrollLeft&&ot(e,t.scrollLeft)}function Rt(e,t,n,r,i){var s=e.display,o=s.lineSpace.offsetTop,u,a,f,l,n=n+o,i=i+o,c=s.scroller.clientHeight-Li,h=s.scroller.scrollTop,p={},e=e.doc.height+2*o,d=i+o>e-10;return n<h?p.scrollTop=n<o+10?0:Math.max(0,n):i>h+c&&(p.scrollTop=(d?e:i)-c),u=s.scroller.clientWidth-Li,a=s.scroller.scrollLeft,t+=s.gutters.offsetWidth,r+=s.gutters.offsetWidth,f=s.gutters.offsetWidth,l=t<f+10,t<a+f||l?(l&&(t=0),p.scrollLeft=Math.max(0,t-10-f)):r>u+a-3&&(p.scrollLeft=r+10-u),p}function Ut(e,t,n,r){var i=e.doc,s;n||(n="add"),"smart"==n&&(e.doc.mode.indent?s=A(e,t):n="prev");var o=e.options.tabSize,u=Bn(i,t),a=hr(u.text,null,o),f=u.text.match(/^\s*/)[0],l;if("smart"==n&&(l=e.doc.mode.indent(s,u.text.slice(f.length),u.text),l==Ai)){if(!r)return;n="prev"}if("prev"==n?l=t>i.first?hr(Bn(i,t-1).text,null,o):0:"add"==n?l=a+e.options.indentUnit:"subtract"==n&&(l=a-e.options.indentUnit),l=Math.max(0,l),n="",r=0,e.options.indentWithTabs)for(i=Math.floor(l/o);i;--i)r+=o,n+="	";r<l&&(n+=pr(l-r)),n!=f&&kt(e.doc,n,Lt(t,0),Lt(t,f.length),"+input"),u.stateAfter=null}function zt(e,t,n){var r=t,i=t,s=e.doc;return("number"==typeof t?i=Bn(s,Math.max(s.first,Math.min(t,s.first+s.size-1))):r=qn(t),null==r)||!n(i,r)?null:(V(e,r,r+1),i)}function Wt(e,t,n,r,i){function s(t){var r=(i?Hr:Br)(a,u,n,!0);if(null==r){if(t=!t)t=o+n,t=t<e.first||t>=e.first+e.size?f=!1:(o=t,a=Bn(e,t));if(!t)return f=!1;u=i?(0>n?_r:Mr)(a):0>n?a.text.length:0}else u=r;return!0}var o=t.line,u=t.ch,a=Bn(e,o),f=!0,l;if("char"==r)s();else if("column"==r)s(!0);else if("word"==r)for(t=!1;!(0>n)||s();){if(wr(a.text.charAt(u)))t=!0;else if(t){0>n&&(n=1,s());break}if(0<n&&!s())break}return l=Ft(e,Lt(o,u),n,!0),f||(l.hitSide=!0),l}function Xt(e,t,n,r){var i=e.doc,s=t.left,o,u,a;for("page"==r?(u=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),o=t.top+n*u):"line"==r&&(o=0<n?t.bottom+3:t.top-3);a=j(e,s,o),!!a.outside;){if(0>n?0>=o:o>=i.height){a.hitSide=!0;break}o+=5*n}return a}function Vt(e,t){var n=t.ch,r=t.ch,i;if(e){!1===t.after||r==e.length?--n:++r,i=e.charAt(n);for(i=wr(i)?wr:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!wr(e)};0<n&&i(e.charAt(n-1));)--n;for(;r<e.length&&i(e.charAt(r));)++r}return{from:Lt(t.line,n),to:Lt(t.line,r)}}function $t(e,t){Ht(e.doc,Lt(t,0),_t(e.doc,Lt(t+1,0)))}function Jt(t,n,r,i){e.defaults[t]=n,r&&(li[t]=i?function(e,t,n){n!=hi&&r(e,t,n)}:r)}function Kt(e,t){var n,r,i;if(!0===t)return t;if(e.copyState)return e.copyState(t);n={};for(r in t)i=t[r],i instanceof Array&&(i=i.concat([])),n[r]=i;return n}function Qt(e,t,n){return e.startState?e.startState(t,n):!0}function Gt(e){return"string"==typeof e?yi[e]:e}function Yt(e,t,n){function r(t){var i,s,o;if(t=Gt(t),i=t[e],!1===i)return"stop";if(null!=i&&n(i))return!0;if(t.nofallthrough)return"stop";if(s=t.fallthrough,null==s)return!1;if("[object Array]"!=Object.prototype.toString.call(s))return r(s);t=0;for(i=s.length;t<i;++t)if(o=r(s[t]),o)return o;return!1}for(var i,s=0;s<t.length;++s)if(i=r(t[s]),i)return i}function Zt(e){return e=Xi[e.keyCode],"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function en(e,t){var n=Xi[e.keyCode];return null==n||e.altGraphKey?!1:(e.altKey&&(n="Alt-"+n),(Ii?e.metaKey:e.ctrlKey)&&(n="Ctrl-"+n),(Ii?e.ctrlKey:e.metaKey)&&(n="Cmd-"+n),!t&&e.shiftKey&&(n="Shift-"+n),n)}function tn(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8}function nn(e,t){this.lines=[],this.type=t,this.doc=e}function rn(e,t,n,r,i){var s;if(r&&r.shared)return on(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return z(e.cm,rn)(e,t,n,r,i);if(s=new nn(e,i),"range"==i&&!Ot(t,n))return s;r&&gr(r,s),s.replacedWith&&(s.collapsed=!0,s.replacedWith=Sr("span",[s.replacedWith],"CodeMirror-widget")),s.collapsed&&(Ui=!0);var o=t.line,u=0,a,f,l=e.cm,c;if(e.iter(o,n.line+1,function(r){l&&s.collapsed&&!l.options.lineWrapping&&pn(e,r)==l.display.maxLine&&(c=!0);var i={from:null,to:null,marker:s};u+=r.text.length,o==t.line&&(i.from=t.ch,u-=t.ch),o==n.line&&(i.to=n.ch,u-=r.text.length-n.ch),s.collapsed&&(o==n.line&&(f=cn(r,n.ch)),o==t.line?a=cn(r,t.ch):In(r,0)),r.markedSpans=r.markedSpans?r.markedSpans.concat([i]):[i],i.marker.attachLine(r),++o}),s.collapsed&&e.iter(t.line,n.line+1,function(t){dn(e,t)&&In(t,0)}),s.readOnly&&(Ri=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed){if(a!=f)throw Error("Inserting collapsed marker overlapping an existing one");s.size=u,s.atomic=!0}return l&&(c&&(l.curOp.updateMaxLine=!0),(s.className||s.startStyle||s.endStyle||s.collapsed)&&V(l,t.line,n.line+1),s.atomic&&jt(l)),s}function sn(e,t){this.markers=e,this.primary=t;for(var n=0,r=this;n<e.length;++n)e[n].parent=this,sr(e[n],"clear",function(){r.clear()})}function on(e,t,n,r,i){r=gr(r),r.shared=!1;var s=[rn(e,t,n,r,i)],o=s[0];return Pn(e,function(e){s.push(rn(e,_t(e,t),_t(e,n),r,i));for(var u=0;u<e.linked.length;++u)if(e.linked[u].isParent)return;o=dr(s)}),new sn(s,o)}function un(e,t){var n,r;if(e)for(n=0;n<e.length;++n)if(r=e[n],r.marker==t)return r}function an(e,t){var n=Pt(e,t.from.line)&&Bn(e,t.from.line).markedSpans,r=Pt(e,t.to.line)&&Bn(e,t.to.line).markedSpans,i,s,o,u;if(!n&&!r)return null;var a=t.from.ch,f=t.to.ch,l=At(t.from,t.to),c,h,p;if(n)for(c=0;c<n.length;++c){var d=n[c],v=d.marker;null!=d.from&&!(v.inclusiveLeft?d.from<=a:d.from<a)&&("bookmark"!=v.type||d.from!=a||l&&d.marker.insertLeft)||(p=null==d.to||(v.inclusiveRight?d.to>=a:d.to>a),(h||(h=[])).push({from:d.from,to:p?null:d.to,marker:v}))}var n=h,m;if(r)for(c=0;c<r.length;++c)h=r[c],p=h.marker,(null==h.to||(p.inclusiveRight?h.to>=f:h.to>f)||"bookmark"==p.type&&h.from==f&&(!l||h.marker.insertLeft))&&(m=null==h.from||(p.inclusiveLeft?h.from<=f:h.from<f),(i||(i=[])).push({from:m?null:h.from-f,to:null==h.to?null:h.to-f,marker:p}));f=i,l=1==t.text.length,m=dr(t.text).length+(l?a:0);if(n)for(r=0;r<n.length;++r)i=n[r],null==i.to&&(s=un(f,i.marker),s?l&&(i.to=null==s.to?null:s.to+m):i.to=a);if(f)for(r=0;r<f.length;++r)i=f[r],null!=i.to&&(i.to+=m),null==i.from?(s=un(n,i.marker),s||(i.from=m,l&&(n||(n=[])).push(i))):(i.from+=m,l&&(n||(n=[])).push(i));if(s=[n],!l){if(o=t.text.length-2,0<o&&n)for(r=0;r<n.length;++r)null==n[r].to&&(u||(u=[])).push({from:null,to:null,marker:n[r].marker});for(r=0;r<o;++r)s.push(u);s.push(f)}return s}function fn(e,t){var n;n=t["spans_"+e.id];var r,i;if(n){r=0;for(i=[];r<t.text.length;++r)i.push(Jn(n[r]));n=i}else n=null;r=an(e,t);var s,o,u,a,f;if(!n)return r;if(!r)return n;for(i=0;i<n.length;++i)if(s=n[i],o=r[i],s&&o){u=0;e:for(;u<o.length;++u){a=o[u];for(f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}}else o&&(n[i]=o);return n}function ln(e,t,n){var r=null,i,s,o,u;if(e.iter(t.line,n.line+1,function(e){var t,n;if(e.markedSpans)for(t=0;t<e.markedSpans.length;++t)n=e.markedSpans[t].marker,n.readOnly&&(!r||-1==mr(r,n))&&(r||(r=[])).push(n)}),!r)return null;e=[{from:t,to:n}];for(t=0;t<r.length;++t){n=r[t],i=n.find();for(s=0;s<e.length;++s)(o=e[s],Ot(o.to,i.from)||Ot(i.to,o.from))||(u=[s,1],(Ot(o.from,i.from)||!n.inclusiveLeft&&At(o.from,i.from))&&u.push({from:o.from,to:i.from}),(Ot(i.to,o.to)||!n.inclusiveRight&&At(o.to,i.to))&&u.push({from:i.to,to:o.to}),e.splice.apply(e,u),s+=u.length-1)}return e}function cn(e,t){var n=Ui&&e.markedSpans,r,i,s;if(n)for(s=0;s<n.length;++s)(i=n[s],i.marker.collapsed)&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!r||r.width<i.marker.width)&&(r=i.marker);return r}function hn(e){return cn(e,e.text.length+1)}function pn(e,t){for(var n;n=cn(t,-1);)t=Bn(e,n.find().from.line);return t}function dn(e,t){var n=Ui&&t.markedSpans,r,i;if(n)for(i=0;i<n.length;++i)if((r=n[i],r.marker.collapsed)&&(null==r.from||0==r.from&&r.marker.inclusiveLeft&&vn(e,t,r)))return!0}function vn(e,t,n){var r,i,s;if(null==n.to)return r=n.marker.find().to,i=Bn(e,r.line),vn(e,i,un(i.markedSpans,n.marker));if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(r=0;r<t.markedSpans.length;++r)if(s=t.markedSpans[r],s.marker.collapsed&&s.from==n.to&&(s.marker.inclusiveLeft||n.marker.inclusiveRight)&&vn(e,t,s))return!0}function mn(e){var t=e.markedSpans,n;if(t){for(n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function gn(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function yn(e){return function(){var t=!this.cm.curOp,n;t&&R(this.cm);try{n=e.apply(this,arguments)}finally{t&&U(this.cm)}return n}}function bn(e){return null!=e.height?e.height:(e.node.parentNode&&1==e.node.parentNode.nodeType||Tr(e.cm.display.measure,Sr("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}function wn(e,t,n,r){var i=new bi(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),zt(e,t,function(t){if((t.widgets||(t.widgets=[])).push(i),i.line=t,!dn(e.doc,t)||i.showIfHidden){var n=Un(e,t)<e.display.scroller.scrollTop;In(t,t.height+bn(i)),n&&(e.curOp.updateScrollPos={scrollTop:e.doc.scrollTop+i.height,scrollLeft:e.doc.scrollLeft})}return!0}),i}function En(e,t,n){return e={text:e},gn(e,t),e.height=n?n(e):1,e}function Sn(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),mn(e),gn(e,n),t=r?r(e):1,t!=e.height&&In(e,t),ar(e,"change")}function xn(e,t,n,r,i){var s=e.options.flattenSpans,o="",u=null,e=new tn(t,e.options.tabSize),a,f;for(""==t&&n.blankLine&&n.blankLine(r);!e.eol();)a=n.token(e,r),5e3<e.pos&&(s=!1,e.pos=Math.min(t.length,e.start+5e4),a=null),f=e.current(),e.start=e.pos,s&&u==a?o+=f:(o&&i(o,u),o=f,u=a);o&&i(o,u)}function Tn(e,t,n){var r=[e.state.modeGen],i,s;xn(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)});for(n=0;n<e.state.overlays.length;++n)i=e.state.overlays[n],s=1,xn(e,t.text,i.mode,!0,function(e,t){for(var n=s,o=e.length,u,a;o;)a=r[s],u=a.length,u<=o?o-=u:(r.splice(s,1,a.slice(0,o),r[s+1],a.slice(o)),o=0),s+=2;if(t)if(i.opaque)r.splice(n,s-n,e,t),s=n+2;else for(;n<s;n+=2)a=r[n+1],r[n+1]=a?a+" "+t:t});return r}function Nn(e,t,n){var r=e.doc.mode,e=new tn(t.text,e.options.tabSize);for(""==t.text&&r.blankLine&&r.blankLine(n);!e.eol()&&5e3>=e.pos;)r.token(e,n),e.start=e.pos}function Cn(e){return e?wi[e]||(wi[e]="cm-"+e.replace(/ +/g," cm-")):null}function kn(e,t,n){for(var r,i=t,s,o,u=!0,a,f,l,c,h,p;r=cn(i,-1);)u=!1,i=Bn(e.doc,r.find().from.line),s||(s=i);r={pre:Sr("pre"),col:0,pos:0,display:!n,measure:null,addedOne:!1,cm:e},i.textClass&&(r.pre.className=i.textClass);do{r.measure=i==t&&n,r.pos=0,r.addToken=r.measure?An:Ln,n&&o&&i!=t&&!r.addedOne&&(n[0]=r.pre.appendChild(Lr(e.display.measure)),r.addedOne=!0);e:{var d=i;o=r,a=(i.styles&&i.styles[0]==e.state.modeGen||(i.styles=Tn(e,i,i.stateAfter=A(e,qn(i)))),i.styles);var v=d.markedSpans,m=void 0,g=void 0,y=void 0,b=void 0,w=void 0,E=g=void 0,S=void 0;if(v)for(var d=d.text.length,x=0,m=1,T="",N=void 0,C=0,k=void 0,L=void 0,O=void 0,M=void 0;;){if(C==x){k=L=O="",M=null,C=Infinity,g=null;for(y=0;y<v.length;++y)b=v[y],w=b.marker,b.from<=x&&(null==b.to||b.to>x)?(null!=b.to&&C>b.to&&(C=b.to,L=""),w.className&&(k+=" "+w.className),w.startStyle&&b.from==x&&(O+=" "+w.startStyle),w.endStyle&&b.to==C&&(L+=" "+w.endStyle),w.collapsed&&(!M||M.marker.width<w.width)&&(M=b)):b.from>x&&C>b.from&&(C=b.from),"bookmark"==w.type&&b.from==x&&w.replacedWith&&(g=w.replacedWith);if(M&&(M.from||0)==x&&(On(o,(null==M.to?d:M.to)-x,null!=M.from&&M.marker.replacedWith),null==M.to)){o=M.marker.find();break e}g&&!M&&On(o,0,g)}if(x>=d)break;for(g=Math.min(d,C);;){if(T){if(E=x+T.length,M||(S=E>g?T.slice(0,g-x):T,o.addToken(o,S,N?N+k:k,O,x+S.length==C?L:"")),E>=g){T=T.slice(g-x),x=g;break}x=E,O=""}T=a[m++],N=Cn(a[m++])}}else for(m=1;m<a.length;m+=2)o.addToken(o,a[m],Cn(a[m+1]));o=void 0}a=o,o=i==s,a&&(i=Bn(e.doc,a.to.line),u=!1)}while(a);return n&&!r.addedOne&&(n[0]=r.pre.appendChild(u?Sr("span"," "):Lr(e.display.measure))),r.pre.firstChild||dn(e.doc,t)||r.pre.appendChild(document.createTextNode(" ")),n&&Fr&&(f=zn(i))&&(l=f.length-1,f[l].from==f[l].to&&--l,c=f[l],h=f[l-1],c.from+1==c.to&&h&&c.level<h.level&&(p=n[r.pos-1],p&&p.parentNode.insertBefore(p.measureRight=Lr(e.display.measure),p.nextSibling))),r.pre}function Ln(e,t,n,r,i){var s,o,u,a,f,l,c,h;if(t){if(Ei.test(t)){s=document.createDocumentFragment();for(o=0;Ei.lastIndex=o,u=Ei.exec(t),a=u?u.index-o:t.length-o,a&&(s.appendChild(document.createTextNode(t.slice(o,o+a))),e.col+=a),!!u;)o+=a+1,"	"==u[0]?(f=e.cm.options.tabSize,l=f-e.col%f,s.appendChild(Sr("span",pr(l),"cm-tab")),e.col+=l):(c=Sr("span","•","cm-invalidchar"),c.title="\\u"+u[0].charCodeAt(0).toString(16),s.appendChild(c),e.col+=1)}else e.col+=t.length,s=document.createTextNode(t);if(n||r||i||e.measure)return h=n||"",r&&(h+=r),i&&(h+=i),e.pre.appendChild(Sr("span",[s],h));e.pre.appendChild(s)}}function An(e,t,n,r,i){for(var s,o,u=0;u<t.length;++u)s=t.charAt(u),o=0==u,"�"<=s&&"�">s&&u<t.length-1?(s=t.slice(u,u+2),++u):u&&e.cm.options.lineWrapping&&Pi.test(t.slice(u-1,u+1))&&e.pre.appendChild(Sr("wbr")),e.measure[e.pos]=Ln(e,s,n,o&&r,u==t.length-1&&i),e.pos+=s.length;t.length&&(e.addedOne=!0)}function On(e,t,n){n&&(e.display||(n=n.cloneNode(!0)),e.pre.appendChild(n),e.measure&&t&&(e.measure[e.pos]=n,e.addedOne=!0)),e.pos+=t}function Mn(e,t,n,r,i){function s(e){return n?n[e]:null}var o=t.from,u=t.to,a=t.text,f=Bn(e,o.line),l=Bn(e,u.line),c=dr(a),h=s(a.length-1),p=u.line-o.line;if(0==o.ch&&0==u.ch&&""==c){for(var d=0,v=a.length-1,m=[];d<v;++d)m.push(En(a[d],s(d),i));Sn(l,l.text,h,i),p&&e.remove(o.line,p),m.length&&e.insert(o.line,m)}else if(f==l)if(1==a.length)Sn(f,f.text.slice(0,o.ch)+c+f.text.slice(u.ch),h,i);else{m=[],d=1;for(v=a.length-1;d<v;++d)m.push(En(a[d],s(d),i));m.push(En(c+f.text.slice(u.ch),h,i)),Sn(f,f.text.slice(0,o.ch)+a[0],s(0),i),e.insert(o.line+1,m)}else if(1==a.length)Sn(f,f.text.slice(0,o.ch)+a[0]+l.text.slice(u.ch),s(0),i),e.remove(o.line+1,p);else{Sn(f,f.text.slice(0,o.ch)+a[0],s(0),i),Sn(l,c+l.text.slice(u.ch),h,i),d=1,v=a.length-1;for(m=[];d<v;++d)m.push(En(a[d],s(d),i));1<p&&e.remove(o.line+1,p-1),e.insert(o.line+1,m)}ar(e,"change",e,t),Bt(e,r.anchor,r.head,null,!0)}function _n(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,r=0;t<n;++t)e[t].parent=this,r+=e[t].height;this.height=r}function Dn(e){var t,n,r,i,s;this.children=e,r=n=t=0;for(i=e.length;r<i;++r)s=e[r],t+=s.chunkSize(),n+=s.height,s.parent=this;this.size=t,this.height=n,this.parent=null}function Pn(e,t,n){function r(e,i,s){var o,u,a;if(e.linked)for(o=0;o<e.linked.length;++o)(u=e.linked[o],u.doc!=i)&&(a=s&&u.sharedHist,!n||a)&&(t(u.doc,a),r(u.doc,e,a))}r(e,null,!0)}function Hn(e,t){if(t.cm)throw Error("This document is already in use.");e.doc=t,t.cm=e,i(e),n(e),e.options.lineWrapping||f(e),e.options.mode=t.modeOption,V(e)}function Bn(e,t){for(var n,r,i,t=t-e.first;!e.lines;)for(n=0;;++n){if(r=e.children[n],i=r.chunkSize(),t<i){e=r;break}t-=i}return e.lines[t]}function jn(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text,i==n.line&&(e=e.slice(0,n.ch)),i==t.line&&(e=e.slice(t.ch)),r.push(e),++i}),r}function Fn(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function In(e,t){for(var n=t-e.height,r=e;r;r=r.parent)r.height+=n}function qn(e){var t,n,r;if(null==e.parent)return null;t=e.parent,e=mr(t.lines,e);for(n=t.parent;n;t=n,n=n.parent)for(r=0;n.children[r]!=t;++r)e+=n.children[r].chunkSize();return e+t.first}function Rn(e,t){var n=e.first,r,i,s,o,u,a;e:do{s=0;for(o=e.children.length;s<o;++s){if(r=e.children[s],i=r.height,t<i){e=r;continue e}t-=i,n+=r.chunkSize()}return n}while(!e.lines);s=0;for(o=e.lines.length;s<o&&!(u=e.lines[s],a=u.height,t<a);++s)t-=a;return n+s}function Un(e,t){var n,r,i,s,o,t=pn(e.doc,t);n=0,r=t.parent;for(s=0;s<r.lines.length&&(i=r.lines[s],i!=t);++s)n+=i.height;for(i=r.parent;i;r=i,i=r.parent)for(s=0;s<i.children.length&&(o=i.children[s],o!=r);++s)n+=o.height;return n}function zn(e){var t=e.order;return null==t&&(t=e.order=Fi(e.text)),t}function Wn(){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function Xn(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function Vn(e,t){var n={from:t.from,to:gt(t),text:jn(e,t.from,t.to)};return Xn(e,n,t.from.line,t.to.line+1),Pn(e,function(e){Xn(e,n,t.from.line,t.to.line+1)},!0),n}function $n(e,t,n,r){var i=e.history,s,o,u;if(i.undone.length=0,s=+(new Date),o=dr(i.done),o&&(i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastTime>s-600||"*"==t.origin.charAt(0))))u=dr(o.changes),At(t.from,t.to)&&At(t.from,u.to)?u.to=gt(t):o.changes.push(Vn(e,t)),o.anchorAfter=n.anchor,o.headAfter=n.head;else{o={changes:[Vn(e,t)],anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:n.anchor,headAfter:n.head};for(i.done.push(o);i.done.length>i.undoDepth;)i.done.shift();0>i.dirtyCounter?i.dirtyCounter=NaN:i.dirtyCounter++}i.lastTime=s,i.lastOp=r,i.lastOrigin=t.origin}function Jn(e){if(!e)return null;for(var t=0,n;t<e.length;++t)e[t].marker.explicitlyCleared?n||(n=e.slice(0,t)):n&&n.push(e[t]);return n?n.length?n:null:e}function Kn(e,t){for(var n,r,i,s,o=0,u=[];o<e.length;++o){n=e[o];var a=n.changes,f=[];u.push({changes:f,anchorBefore:n.anchorBefore,headBefore:n.headBefore,anchorAfter:n.anchorAfter,headAfter:n.headAfter});for(n=0;n<a.length;++n)if(r=a[n],f.push({from:r.from,to:r.to,text:r.text}),t)for(s in r)(i=s.match(/^spans_(\d+)$/))&&-1<mr(t,Number(i[1]))&&(dr(f)[s]=r[s],delete r[s])}return u}function Qn(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Gn(e,t,n,r){for(var i,s,o,u,a=0;a<e.length;++a){i=e[a],s=!0;for(o=0;o<i.changes.length;++o)if(u=i.changes[o],i.copied||(u.from=Mt(u.from),u.to=Mt(u.to)),n<u.from.line)u.from.line+=r,u.to.line+=r;else if(t<=u.to.line){s=!1;break}i.copied||(i.anchorBefore=Mt(i.anchorBefore),i.headBefore=Mt(i.headBefore),i.anchorAfter=Mt(i.anchorAfter),i.readAfter=Mt(i.headAfter),i.copied=!0),s?(Qn(i.anchorBefore),Qn(i.headBefore),Qn(i.anchorAfter),Qn(i.headAfter)):(e.splice(0,a+1),a=0)}}function Yn(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;Gn(e.done,n,r,i),Gn(e.undone,n,r,i)}function Zn(){rr(this)}function er(e){return e.stop||(e.stop=Zn),e}function tr(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function nr(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function rr(e){tr(e),nr(e)}function ir(e){var t=e.which;return null==t&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),Yr&&e.ctrlKey&&1==t&&(t=3),t}function sr(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}),(e[t]||(e[t]=[])).push(n))}function or(e,t,n){var r;if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else if(r=e._handlers&&e._handlers[t],!!r)for(e=0;e<r.length;++e)if(r[e]==n){r.splice(e,1);break}}function ur(e,t){var n=e._handlers&&e._handlers[t],r,i;if(n){r=Array.prototype.slice.call(arguments,2);for(i=0;i<n.length;++i)n[i].apply(null,r)}}function ar(e,t){function n(e){return function(){e.apply(null,i)}}var r=e._handlers&&e._handlers[t],i,s;if(r){i=Array.prototype.slice.call(arguments,2),Ci||(++ki,Ci=[],setTimeout(fr,0));for(s=0;s<r.length;++s)Ci.push(n(r[s]))}}function fr(){var e,t;--ki,e=Ci,Ci=null;for(t=0;t<e.length;++t)e[t]()}function lr(e,t){var n=e._handlers&&e._handlers[t];return n&&0<n.length}function cr(){this.id=null}function hr(e,t,n){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var r=0,i=0;r<t;++r)"	"==e.charAt(r)?i+=n-i%n:++i;return i}function pr(e){for(;Oi.length<=e;)Oi.push(dr(Oi)+" ");return Oi[e]}function dr(e){return e[e.length-1]}function vr(e){Qr?(e.selectionStart=0,e.selectionEnd=e.value.length):e.select()}function mr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;++n)if(e[n]==t)return n;return-1}function gr(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function yr(e){for(var t=[],n=0;n<e;++n)t.push(void 0);return t}function br(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function wr(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||Mi.test(e))}function Er(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Sr(e,t,n,r){e=document.createElement(e);if(n&&(e.className=n),r&&(e.style.cssText=r),"string"==typeof t)Nr(e,t);else if(t)for(n=0;n<t.length;++n)e.appendChild(t[n]);return e}function xr(e){if(Fr)for(;e.firstChild;)e.removeChild(e.firstChild);else e.innerHTML="";return e}function Tr(e,t){return xr(e).appendChild(t)}function Nr(e,t){qr?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function Cr(e){return e.getBoundingClientRect()}function kr(e){if(null!=Hi)return Hi;var t=Sr("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return Tr(e,t),t.offsetWidth&&(Hi=t.offsetHeight-t.clientHeight),Hi||0}function Lr(e){if(null==Bi){var t=Sr("span","​");Tr(e,Sr("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Bi=1>=t.offsetWidth&&2<t.offsetHeight&&!Ir)}return Bi?Sr("span","​"):Sr("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Ar(e,t,n,r){var i,s;if(!e)return r(t,n,"ltr");for(i=0;i<e.length;++i)s=e[i],(s.from<n&&s.to>t||t==n&&s.to==t)&&r(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr")}function Or(e){return e.level%2?e.from:e.to}function Mr(e){return(e=zn(e))?e[0].level%2?e[0].to:e[0].from:0}function _r(e){var t=zn(e);return t?Or(dr(t)):e.text.length}function Dr(e,t){var n=Bn(e.doc,t),r=pn(e.doc,n),i,s;return r!=n&&(t=qn(r)),i=zn(r),s=i?i[0].level%2?_r(r):Mr(r):0,Lt(t,s)}function Pr(e,t){for(var n,r,i,s;n=hn(r=Bn(e.doc,t));)t=n.find().to.line;return i=zn(r),s=i?i[0].level%2?Mr(r):_r(r):r.text.length,Lt(t,s)}function Hr(e,t,n,r){var i=zn(e),s,o,u,a;if(!i)return Br(e,t,n,r);r=r?function(t,n){do t+=n;while(0<t&&_i.test(e.text.charAt(t)));return t}:function(e,t){return e+t},s=i[0].level;for(o=0;o<i.length&&!(u=i[o],a=u.level%2==s,u.from<t&&u.to>t||a&&(u.from==t||u.to==t));++o);for(t=r(t,u.level%2?-n:n);null!=t;)if(u.level%2==s){if(!(t<u.from||t>u.to))break;t=(u=i[o+=n])&&(0<n==u.level%2?r(u.to,-1):r(u.from,1))}else if(t==(u.level%2?u.to:u.from))t=(u=i[--o])&&Or(u);else{if(t!=Or(u))break;t=(u=i[++o])&&(u.level%2?u.to:u.from)}return 0>t||t>e.text.length?null:t}function Br(e,t,n,r){t+=n;if(r)for(;0<t&&_i.test(e.text.charAt(t));)t+=n;return 0>t||t>e.text.length?null:t}var jr=/gecko\/\d/i.test(navigator.userAgent),Fr=/MSIE \d/.test(navigator.userAgent),Ir=Fr&&(null==document.documentMode||8>document.documentMode),qr=Fr&&(null==document.documentMode||9>document.documentMode),Rr=/WebKit\//.test(navigator.userAgent),Ur=Rr&&/Qt\/\d+\.\d+/.test(navigator.userAgent),zr=/Chrome\//.test(navigator.userAgent),Wr=/Opera\//.test(navigator.userAgent),Xr=/Apple Computer/.test(navigator.vendor),Vr=/KHTML\//.test(navigator.userAgent),$r=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Jr=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Kr=/PhantomJS/.test(navigator.userAgent),Qr=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Gr=Qr||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),Yr=Qr||/Mac/.test(navigator.platform),Zr=/windows/i.test(navigator.platform),ei=Wr&&navigator.userAgent.match(/Version\/(\d*\.\d*)/),ti,ni,ri,ii,si,oi,ui,ai,fi,li,ci,hi,pi,di,vi,mi,gi,yi,bi,wi,Ei,Si,xi,Ti,Ni,Ci,ki,Li,Ai,Oi,Mi,_i,Di,Pi,Hi,Bi,ji,Fi;ei&&(ei=Number(ei[1]));var Ii=Yr&&(Ur||Wr&&(null==ei||12.11>ei)),qi=jr||Fr&&!qr,Ri=!1,Ui=!1;si=ni=0,oi=null,Fr?oi=-0.53:jr?oi=15:zr?oi=-0.7:Xr&&(oi=-1/3),ai=null,e.Pos=Lt,e.prototype={focus:function(){window.focus(),G(this),dt(this),J(this)},setOption:function(e,t){var n=this
.options,r=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,li.hasOwnProperty(e)&&z(this,li[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e){this.state.keyMaps.push(e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(("string"==typeof e?t[n].name:t[n])==e)return t.splice(n,1),!0},addOverlay:z(null,function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,V(this)}),removeOverlay:z(null,function(e){for(var t=this.state.overlays,n=0;n<t.length;++n)if(t[n].modeSpec==e){t.splice(n,1),this.state.modeGen++,V(this);break}}),indentLine:z(null,function(e,t,n){"string"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),Pt(this.doc,e)&&Ut(this,e,t,n)}),indentSelection:z(null,function(e){var t=this.doc.sel,n;if(At(t.from,t.to))return Ut(this,t.from.line,e);n=t.to.line-(t.to.ch?0:1);for(t=t.from.line;t<=n;++t)Ut(this,t,e)}),getTokenAt:function(e){for(var t=this.doc,n,e=_t(t,e),r=A(this,e.line),i=this.doc.mode,t=Bn(t,e.line),t=new tn(t.text,this.options.tabSize);t.pos<e.ch&&!t.eol();)t.start=t.pos,n=i.token(t,r);return{start:t.start,end:t.pos,string:t.current(),className:n||null,type:n||null,state:r}},getStateAfter:function(e){var t=this.doc;return e=Math.max(t.first,Math.min(null==e?t.first+t.size-1:e,t.first+t.size-1)),A(this,e+1)},cursorCoords:function(e,t){var n,r=this.doc.sel;return n=null==e?r.head:"object"==typeof e?_t(this.doc,e):e?r.from:r.to,H(this,n,t||"page")},charCoords:function(e,t){return P(this,_t(this.doc,e),t||"page")},coordsChar:function(e){var t=Cr(this.display.lineSpace);return j(this,e.left-t.left-(window.pageXOffset||(document.documentElement||document.body).scrollLeft),e.top-t.top-(window.pageYOffset||(document.documentElement||document.body).scrollTop))},defaultTextHeight:function(){return I(this.display)},setGutterMarker:z(null,function(e,t,n){return zt(this,e,function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&Er(r)&&(e.gutterMarkers=null),!0})}),clearGutter:z(null,function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,V(t,r,r+1),Er(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineClass:z(null,function(e,t,n){return zt(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[r]){if(RegExp("\\b"+n+"\\b").test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:z(null,function(e,t,n){return zt(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[r],s;if(!i)return!1;if(null==n)e[r]=null;else{if(s=i.replace(RegExp("^"+n+"\\b\\s*|\\s*\\b"+n+"\\b"),""),s==i)return!1;e[r]=s||null}return!0})}),addLineWidget:z(null,function(e,t,n){return wn(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){var t;if("number"==typeof e){if(!Pt(this.doc,e)||(t=e,e=Bn(this.doc,e),!e))return null}else if(t=qn(e),null==t)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,r,i){var s=this.display,o,u,a,f,e=H(this,_t(this.doc,e));o=e.bottom,u=e.left,t.style.position="absolute",s.sizer.appendChild(t),"over"==r?o=e.top:("above"==r||"near"==r)&&(a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth),("above"==r||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)),t.style.top=o+s.lineSpace.offsetTop+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&qt(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:z(null,ht),execCommand:function(e){return gi[e](this)},findPosH:function(e,t,n,r){var i=1,s;0>t&&(i=-1,t=-t),s=0;for(e=_t(this.doc,e);s<t&&(e=Wt(this.doc,e,i,n,r),!e.hitSide);++s);return e},moveH:z(null,function(e,t){var n=this.doc.sel,n=n.shift||n.extend||At(n.from,n.to)?Wt(this.doc,n.head,e,t,this.options.rtlMoveVisually):0>e?n.from:n.to;Ht(this.doc,n,n,e)}),deleteH:z(null,function(e,t){var n=this.doc.sel;At(n.from,n.to)?kt(this.doc,"",n.from,Wt(this.doc,n.head,e,t,!1),"+delete"):kt(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,n,r){var i=1,s,o;0>t&&(i=-1,t=-t),s=0;for(e=_t(this.doc,e);s<t&&(o=H(this,e,"div"),null==r?r=o.left:o.left=r,e=Xt(this,o,i,n),!e.hitSide);++s);return e},moveV:z(null,function(e,t){var n=this.doc.sel,r=H(this,n.head,"div"),i;null!=n.goalColumn&&(r.left=n.goalColumn),i=Xt(this,r,e,t),"page"==t&&(this.display.scrollbarV.scrollTop+=P(this,i,"div").top-r.top),Ht(this.doc,i,i,e),n.goalColumn=r.left}),toggleOverwrite:function(){(this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},scrollTo:z(null,function(e,t){this.curOp.updateScrollPos={scrollLeft:e,scrollTop:t}}),getScrollInfo:function(){var e=this.display.scroller,t=Li;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:function(e){"number"==typeof e&&(e=Lt(e,0)),e&&null==e.line?qt(this,e.left,e.top,e.right,e.bottom):(e=e?_t(this.doc,e):this.doc.sel.head,It(this,e))},setSize:function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(""+e)?e+"px":e}null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.refresh()},on:function(e,t){sr(this,e,t)},off:function(e,t){or(this,e,t)},operation:function(e){return X(this,e)},refresh:z(null,function(){_(this),this.curOp.updateScrollPos={scrollTop:this.doc.scrollTop,scrollLeft:this.doc.scrollLeft},V(this)}),swapDoc:z(null,function(e){var t=this.doc;return t.cm=null,Hn(this,e),_(this),this.curOp.updateScrollPos={scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},li=e.optionHandlers={},ci=e.defaults={},hi=e.Init={toString:function(){return"CodeMirror.Init"}},Jt("value","",function(e,t){e.setValue(t)},!0),Jt("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Jt("indentUnit",2,n,!0),Jt("indentWithTabs",!1),Jt("smartIndent",!0),Jt("tabSize",4,function(e){n(e),_(e),V(e)},!0),Jt("electricChars",!0),Jt("rtlMoveVisually",!Zr),Jt("theme","default",function(e){s(e),o(e)},!0),Jt("keyMap","default",function(e){var t=yi[e.options.keyMap].style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(t?" cm-keymap-"+t:"")}),Jt("extraKeys",null),Jt("onKeyEvent",null),Jt("onDragEvent",null),Jt("lineWrapping",!1,function(e){e.options.lineWrapping?(e.display.wrapper.className=e.display.wrapper.className+" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),f(e)),i(e),V(e),_(e),setTimeout(function(){c(e.display,e.doc.height)},100)},!0),Jt("gutters",[],function(e){l(e.options),o(e)},!0),Jt("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?v(e.display)+"px":"0",e.refresh()},!0),Jt("lineNumbers",!1,function(e){l(e.options),o(e)},!0),Jt("firstLineNumber",1,o,!0),Jt("lineNumberFormatter",function(e){return e},o,!0),Jt("showCursorWhenSelecting",!1,x,!0),Jt("readOnly",!1,function(e,t){t=="nocursor"?(vt(e),e.display.input.blur()):t||Q(e,!0)}),Jt("dragDrop",!0),Jt("cursorBlinkRate",530),Jt("cursorHeight",1),Jt("workTime",100),Jt("workDelay",100),Jt("flattenSpans",!0),Jt("pollInterval",100),Jt("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),Jt("viewportMargin",10,function(e){e.refresh()},!0),Jt("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Jt("autofocus",null),pi=e.modes={},di=e.mimeModes={},e.defineMode=function(t,n){if(e.defaults.mode||"null"==t||(e.defaults.mode=t),2<arguments.length){n.dependencies=[];for(var r=2;r<arguments.length;++r)n.dependencies.push(arguments[r])}pi[t]=n},e.defineMIME=function(e,t){di[e]=t},e.resolveMode=function(t){if("string"==typeof t&&di.hasOwnProperty(t))t=di[t];else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var r,i,s;if(n=e.resolveMode(n),r=pi[n.name],!r)return e.getMode(t,"text/plain");if(r=r(t,n),vi.hasOwnProperty(n.name))for(s in i=vi[n.name],i)i.hasOwnProperty(s)&&(r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=i[s]);return r.name=n.name,r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null"),vi=e.modeExtensions={},e.extendMode=function(e,t){var n=vi.hasOwnProperty(e)?vi[e]:vi[e]={};gr(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineOption=Jt,mi=[],e.defineInitHook=function(e){mi.push(e)},e.copyState=Kt,e.startState=Qt,e.innerMode=function(e,t){for(;e.innerMode;)var n=e.innerMode(t),t=n.state,e=n.mode;return n||{mode:e,state:t}},gi=e.commands={selectAll:function(e){e.setSelection(Lt(e.firstLine(),0),Lt(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=!At(t,n);r||e.getLine(t.line).length!=t.ch?e.replaceRange("",t,r?n:Lt(t.line),"+delete"):e.replaceRange("",t,Lt(t.line+1,0),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",Lt(t,0),Lt(t),"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(Lt(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Lt(e.lastLine()))},goLineStart:function(e){e.extendSelection(Dr(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=Dr(e,t.line),r=e.getLineHandle(n.line),i=zn(r),s,o;i&&0!=i[0].level?e.extendSelection(n):(s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch,e.extendSelection(Lt(n.line,o?0:s)))},goLineEnd:function(e){e.extendSelection(Pr(e,e.getCursor().line))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("	","end","+input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);0<t.ch&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),Lt(t.line,t.ch-1),Lt(t.line,t.ch+1))},newlineAndIndent:function(e){z(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},yi=e.keyMap={},yi.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},yi.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordBefore","Ctrl-Delete":"delWordAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},yi.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordBefore","Ctrl-Alt-Backspace":"delWordAfter","Alt-Delete":"delWordAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},yi["default"]=Yr?yi.macDefault:yi.pcDefault,yi.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},e.lookupKey=Yt,e.isModifierKey=Zt,e.keyName=en,e.fromTextArea=function(t,n){function r(){t.value=a.getValue()}var i,s,o,u,a;if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),null==n.autofocus){i=document.body;try{i=document.activeElement}catch(f){}n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form){sr(t.form,"submit",r),s=t.form,o=s.submit;try{u=s.submit=function(){r(),s.submit=o,s.submit(),s.submit=u}}catch(l){}}return t.style.display="none",a=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n),a.save=r,a.getTextArea=function(){return t},a.toTextArea=function(){r(),t.parentNode.removeChild(a.getWrapperElement()),t.style.display="",t.form&&(or(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=o))},a},tn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos),n;return n="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)),n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},backUp:function(e){this.pos-=e},column:function(){return hr(this.string,this.start,this.tabSize)},indentation:function(){return hr(this.string,null,this.tabSize)},match:function(e,t,n){var r,i;if("string"!=typeof e)return(i=this.string.slice(this.pos).match(e),i&&0<i.index)?null:(i&&!1!==t&&(this.pos+=i[0].length),i);if(r=function(e){return n?e.toLowerCase():e},r(this.string).indexOf(r(e),this.pos)==this.pos)return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)}},e.StringStream=tn,e.TextMarker=nn,nn.prototype.clear=function(){var e,t,n,r,i,s,o;if(!this.explicitlyCleared){(t=(e=this.doc.cm)&&!e.curOp)&&R(e),r=n=null;for(o=0;o<this.lines.length;++o){i=this.lines[o],s=un(i.markedSpans,this),null!=s.to&&(r=qn(i));for(var u=i,f=i.markedSpans,l=s,c=void 0,h=0;h<f.length;++h)f[h]!=l&&(c||(c=[])).push(f[h]);u.markedSpans=c,null!=s.from?n=qn(i):this.collapsed&&!dn(this.doc,i)&&e&&In(i,I(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(o=0;o<this.lines.length;++o)i=pn(e.doc,this.lines[o]),s=a(e.doc,i),s>e.display.maxLineLength&&(e.display.maxLine=i,e.display.maxLineLength=s,e.display.maxLineChanged=!0);null!=n&&e&&V(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.collapsed&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&jt(e)),t&&U(e),ar(this,"clear")}},nn.prototype.find=function(){for(var e,t,n,r,i,s=0;s<this.lines.length;++s)n=this.lines[s],r=un(n.markedSpans,this),(null!=r.from||null!=r.to)&&(i=qn(n),null!=r.from&&(e=Lt(i,r.from)),null!=r.to&&(t=Lt(i,r.to)));return"bookmark"==this.type?e:e&&{from:e,to:t}},nn.prototype.getOptions=function(e){var t=this.replacedWith;return{className:this.className,inclusiveLeft:this.inclusiveLeft,inclusiveRight:this.inclusiveRight,atomic:this.atomic,collapsed:this.collapsed,clearOnEnter:this.clearOnEnter,replacedWith:e?t&&t.cloneNode(!0):t,readOnly:this.readOnly,startStyle:this.startStyle,endStyle:this.endStyle}},nn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=mr(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},nn.prototype.detachLine=function(e){if(this.lines.splice(mr(this.lines,e),1),!this.lines.length&&this.doc.cm)e=this.doc.cm.curOp,(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},e.SharedTextMarker=sn,sn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ar(this,"clear")}},sn.prototype.find=function(){return this.primary.find()},sn.prototype.getOptions=function(e){return e=this.primary.getOptions(e),e.shared=!0,e},bi=e.LineWidget=function(e,t,n){for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t},bi.prototype.clear=yn(function(){var e=this.line.widgets,t=qn(this.line),n;if(null!=t&&e){for(n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(this.line.widgets=null),In(this.line,Math.max(0,this.line.height-bn(this))),V(this.cm,t,t+1)}}),bi.prototype.changed=yn(function(){var e=this.height,t,n;(this.height=null,t=bn(this)-e,t)&&(In(this.line,this.line.height+t),n=qn(this.line),V(this.cm,n,n+1))}),wi={},Ei=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g,_n.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n,r=e,i=e+t;r<i;++r){n=this.lines[r],this.height-=n.height;var s=n;s.parent=null,mn(s),ar(n,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e)),e=0;for(n=t.length;e<n;++e)t[e].parent=this},iterN:function(e,t,n){for(t=e+t;e<t;++e)if(n(this.lines[e]))return!0}},Dn.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){var n,r,i,s,o,u;this.size-=t;for(n=0;n<this.children.length;++n)if(r=this.children[n],i=r.chunkSize(),e<i){if(s=Math.min(t,i-e),o=r.height,r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null),0==(t-=s))break;e=0}else e-=i;25>this.size-t&&(u=[],this.collapse(u),this.children=[new _n(u)],this.children[0].parent=this)},collapse:function(e){for(var t=0,n=this.children.length;t<n;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){var r,i,s,o;this.size+=t.length,this.height+=n,r=0;for(i=this.children.length;r<i;++r){if(s=this.children[r],o=s.chunkSize(),e<=o){if(s.insertInner(e,t,n),s.lines&&50<s.lines.length){for(;50<s.lines.length;)e=s.lines.splice(s.lines.length-25,25),e=new _n(e),s.height-=e.height,this.children.splice(r+1,0,e),e.parent=this;this.maybeSpill()}break}e-=o}},maybeSpill:function(){var e,t,n,r;if(!(10>=this.children.length)){e=this;do t=e.children.splice(e.children.length-5,5),t=new Dn(t),e.parent?(e.size-=t.size,e.height-=t.height,r=mr(e.parent.children,e),e.parent.children.splice(r+1,0,t)):(n=new Dn(e.children),n.parent=e,e.children=[n,t],e=n),t.parent=e.parent;while(10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r,i,s,o=0,u=this.children.length;o<u;++o)if(r=this.children[o],i=r.chunkSize(),e<i){if(s=Math.min(t,i-e),r.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=i}},Si=0,xi=e.Doc=function(e,t,n){if(!(this instanceof xi))return new xi(e,t,n);null==n&&(n=0),Dn.call(this,[new _n([En("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=Wn(),this.frontier=n,n=Lt(n,0),this.sel={from:n,to:n,head:n,anchor:n,shift:!1,extend:!1,goalColumn:null},this.id=++Si,this.modeOption=t,"string"==typeof e&&(e=ji(e)),Mn(this,{from:n,to:n,text:e},null,{head:n,anchor:n})},xi.prototype=function(e,t){function n(){}n.prototype=e;var r=new n;return t&&gr(t,r),r}(Dn.prototype,{iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0,i=t.length;r<i;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Fn(this,this.first,this.first+this.size);return!1===e?t:t.join(e||"\n")},setValue:function(e){var t=Lt(this.first,0),n=this.first+this.size-1;Et(this,{from:t,to:Lt(n,Bn(this,n).text.length),text:ji(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,n,r){t=_t(this,t),n=n?_t(this,n):t,kt(this,e,t,n,r)},getRange:function(e,t,n){return e=jn(this,_t(this,e),_t(this,t)),!1===n?e:e.join(n||"\n")},getLine:function(e){return(e=this.getLineHandle(e))&&e.text},setLine:function(e,t){Pt(this,e)&&kt(this,t,Lt(e,0),_t(this,Lt(e)))},removeLine:function(e){Pt(this,e)&&kt(this,"",Lt(e,0),_t(this,Lt(e+1,0)))},getLineHandle:function(e){if(Pt(this,e))return Bn(this,e)},getLineNumber:function(e){return qn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return _t(this,e)},getCursor:function(e){var t=this.sel,n;return n=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||!1===e?t.to:t.from,Mt(n)},somethingSelected:function(){return!At(this.sel.head,this.sel.anchor)},setCursor:W(function(e,t,n){e=_t(this,"number"==typeof e?Lt(e,t||0):e),n?Ht(this,e):Bt(this,e,e)}),setSelection:W(function(e,t){Bt(this,_t(this,e),_t(this,t||e))}),extendSelection:W(function(e,t){Ht(this,_t(this,e),t&&_t(this,t))}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,n){Et(this,{from:this.sel.from,to:this.sel.to,text:ji(e),origin:n},t||"around")},undo:W(function(){xt(this,"undo")}),redo:W(function(){xt(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=Wn()},markClean:function(){this.history.dirtyCounter=0,this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return 0==this.history.dirtyCounter},getHistory:function(){return{done:Kn(this.history.done),undone:Kn(this.history.undone)}},setHistory:function(e){var t=this.history=Wn();t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,n){return rn(this,_t(this,e),_t(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft};return e=_t(this,e),rn(this,e,e,n,"bookmark")},findMarksAt:function(e){var t,n,r,i;if(e=_t(this,e),t=[],n=Bn(this,e.line).markedSpans,n)for(r=0;r<n.length;++r)i=n[r],(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker);return t},getAllMarks:function(){var e=[];return this.iter(function(t){var t=t.markedSpans,n;if(t)for(n=0;n<t.length;++n)null!=t[n].from&&e.push(t[n].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){r=r.text.length+1;if(r>e)return t=e,!0;e-=r,++n}),_t(this,Lt(n,t))},indexFromPos:function(e){var e=_t(this,e),t=e.ch;return e.line<this.first||0>e.ch?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new xi(Fn(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){var t,n,r;return e||(e={}),t=this.first,n=this.first+this.size,null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to),r=new xi(Fn(this,t,n),e.mode||this.modeOption,t),e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],r},unlinkDoc:function(t){var n,r,i;if(t instanceof e&&(t=t.doc),this.linked)for(n=0;n<this.linked.length;++n)if(r=this.linked[n],r.doc==t){this.linked.splice(n,1),t.unlinkDoc(this);break}t.history==this.history&&(i=[t.id],Pn(t,function(e){i.push(e.id)},!0),t.history=Wn(),t.history.done=Kn(this.history.done,i),t.history.undone=Kn(this.history.undone,i))},iterLinkedDocs:function(e){Pn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),xi.prototype.eachLine=xi.prototype.iter,Ti=["iter","insert","remove","copy","getEditor"];for(Ni in xi.prototype)xi.prototype.hasOwnProperty(Ni)&&0>mr(Ti,Ni)&&(e.prototype[Ni]=function(e){return function(){return e.apply(this.doc,arguments)}}(xi.prototype[Ni]));e.e_stop=rr,e.e_preventDefault=tr,e.e_stopPropagation=nr,ki=0,e.on=sr,e.off=or,e.signal=ur,Li=30,Ai=e.Pass={toString:function(){return"CodeMirror.Pass"}},cr.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},e.countColumn=hr,Oi=[""],Mi=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,_i=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/,e.replaceGetRect=function(e){Cr=e},Di=function(){if(qr)return!1;var e=Sr("div");return"draggable"in e||"dragDrop"in e}(),Pi=/^$/,jr?Pi=/$'/:Xr?Pi=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:zr&&(Pi=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/),ji=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length,i,s,o;t<=r;)i=e.indexOf("\n",t),-1==i&&(i=e.length),s=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),o=s.indexOf("\r"),-1!=o?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1);return n}:function(e){return e.split(/\r\n?|\n/)},e.splitLines=ji;var zi=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return!t||t.parentElement()!=e?!1:0!=t.compareEndPoints("StartToEnd",t)},Wi=function(){var e=Sr("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Xi={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};return e.keyNames=Xi,function(){for(var e=0;10>e;e++)Xi[e+48]=""+e;for(e=65;90>=e;e++)Xi[e]=String.fromCharCode(e);for(e=1;12>=e;e++)Xi[e+111]=Xi[e+63235]="F"+e}(),Fi=function(){function e(e){return 255>=e?t.charAt(e):1424<=e&&1524>=e?"R":1536<=e&&1791>=e?n.charAt(e-1536):1792<=e&&2220>=e?"r":"L"}var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/;return function(t){var n,a,f,l,c,h,p,d;if(!r.test(t))return!1;n=t.length,a=[];for(d=0;d<n;++d)a.push(c=e(t.charCodeAt(d)));d=0;for(f="L";d<n;++d)c=a[d],"m"==c?a[d]=f:f=c;d=0;for(f="L";d<n;++d)c=a[d],"1"==c&&"r"==f?a[d]="n":s.test(c)&&(f=c,"r"==c&&(a[d]="R"));d=1;for(f=a[0];d<n-1;++d)c=a[d],"+"==c&&"1"==f&&"1"==a[d+1]?a[d]="1":","==c&&f==a[d+1]&&("1"==f||"n"==f)&&(a[d]=f),f=c;for(d=0;d<n;++d)if(c=a[d],","==c)a[d]="N";else if("%"==c){for(h=d+1;h<n&&"%"==a[h];++h);l=d&&"!"==a[d-1]||h<n-1&&"1"==a[h]?"1":"N";for(f=d;f<h;++f)a[f]=l;d=h-1}d=0;for(f="L";d<n;++d)c=a[d],"L"==f&&"1"==c?a[d]="L":s.test(c)&&(f=c);for(d=0;d<n;++d)if(i.test(a[d])){for(h=d+1;h<n&&i.test(a[h]);++h);f="L"==(h<n-1?a[h]:"L"),l="L"==(d?a[d-1]:"L")||f?"L":"R";for(f=d;f<h;++f)a[f]=l;d=h-1}c=[];for(d=0;d<n;)if(o.test(a[d])){f=d;for(++d;d<n&&o.test(a[d]);++d);c.push({from:f,to:d,level:0})}else{l=d,h=c.length;for(++d;d<n&&"L"!=a[d];++d);for(f=l;f<d;)if(u.test(a[f])){l<f&&c.splice(h,0,{from:l,to:f,level:1}),l=f;for(++f;f<d&&u.test(a[f]);++f);c.splice(h,0,{from:l,to:f,level:2}),l=f}else++f;l<d&&c.splice(h,0,{from:l,to:d,level:1})}return 1==c[0].level&&(p=t.match(/^\s+/))&&(c[0].from=p[0].length,c.unshift({from:0,to:p[0].length,level:0})),1==dr(c).level&&(p=t.match(/\s+$/))&&(dr(c).to-=p[0].length,c.push({from:n-p[0].length,to:n,level:0})),c[0].level!=dr(c).level&&c.push({from:n,to:n,level:c[0].level}),c}}(),e.version="3.1",e}();