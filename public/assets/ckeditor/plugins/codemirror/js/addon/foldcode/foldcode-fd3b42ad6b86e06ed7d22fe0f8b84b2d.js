CodeMirror.tagRangeFinder=function(e,t){for(var n=RegExp("^[A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*"),r=e.getLine(t.line),i=!1,s=null,o=t.ch;!i;){o=r.indexOf("<",o);if(-1==o)return;if(o+1<r.length&&"/"==r[o+1])o++;else if(r.substr(o+1).match(n)){var u=r.indexOf(">",o+1);if(-1==u){for(var i=t.line+1,a=!1,f=e.lineCount();i<f&&!a;){var l=e.getLine(i),u=l.indexOf(">");if(-1!=u&&(a=!0,l=l.lastIndexOf("/",u),-1!=l&&l<u&&(l=r.substr(l,u-l+1),!l.match(/\/\s*\>/))))return;i++}i=!0}else f=r.lastIndexOf("/",u),-1==f?i=!0:(l=r.substr(f,u-f+1),l.match(/\/\s*\>/)||(i=!0));i&&((s=r.substr(o+1).match(n))?(s=s[0],-1!=r.indexOf("</"+s+">",o)&&(i=!1)):i=!1),i||o++}else o++}if(i){n=RegExp("(\\<\\/"+s+"\\>)|(\\<"+s+"\\>)|(\\<"+s+"\\s)|(\\<"+s+"$)"),s="</"+s+">",o=1,i=t.line+1;for(f=e.lineCount();i<f;){r=e.getLine(i);if(r=r.match(n))for(a=0;a<r.length;a++)if(r[a]==s?o--:o++,!o)return{from:CodeMirror.Pos(t.line,u+1),to:CodeMirror.Pos(i,r.index)};i++}}},CodeMirror.braceRangeFinder=function(e,t){for(var n=t.line,r=e.getLine(n),i=r.length,s,o;;){i=r.lastIndexOf("{",i);if(i<t.ch)break;o=e.getTokenAt(CodeMirror.Pos(n,i+1)).type;if(!/^(comment|string)/.test(o)){s=i;break}i-=1}if(!(null==s||r.lastIndexOf("}")>s)){var r=1,i=e.lineCount(),u,a,f=n+1;e:for(;f<i;++f)for(var l=e.getLine(f),c=0;;){var h=l.indexOf("{",c),c=l.indexOf("}",c);0>h&&(h=l.length),0>c&&(c=l.length),c=Math.min(h,c);if(c==l.length)break;if(e.getTokenAt(CodeMirror.Pos(f,c+1)).type==o)if(c==h)++r;else if(!--r){u=f,a=c;break e}++c}if(null!=u&&u!=n+1)return{from:CodeMirror.Pos(n,s+1),to:CodeMirror.Pos(u,a)}}},CodeMirror.indentRangeFinder=function(e,t){for(var n=e.getOption("tabSize"),r=e.getLine(t.line),i=CodeMirror.countColumn(r,null,n),s=t.line+1,o=e.lineCount();s<o;++s){var u=e.getLine(s);if(CodeMirror.countColumn(u,null,n)<i&&CodeMirror.countColumn(e.getLine(s-1),null,n)>i)return{from:CodeMirror.Pos(t.line,r.length),to:CodeMirror.Pos(s,u.length)}}},CodeMirror.newFoldFunction=function(e,t){null==t&&(t="â†”");if("string"==typeof t){var n=document.createTextNode(t),t=document.createElement("span");t.appendChild(n),t.className="CodeMirror-foldmarker"}return function(n,r){"number"==typeof r&&(r=CodeMirror.Pos(r,0));var i=e(n,r);if(i){for(var s=n.findMarksAt(i.from),o=0,u=0;u<s.length;++u)s[u].__isFold&&(++o,s[u].clear());if(!o){s=t.cloneNode(!0),CodeMirror.on(s,"mousedown",function(){a.clear()});var a=n.markText(i.from,i.to,{replacedWith:s,clearOnEnter:!0,__isFold:!0})}}}};