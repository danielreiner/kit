(function(){function e(e,t,n){return e=e.getWrapperElement().appendChild(document.createElement("div")),e.className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top",e.innerHTML=t,e}CodeMirror.defineExtension("openDialog",function(t,n,r){function i(){o||(o=!0,s.parentNode.removeChild(s))}var s=e(this,t,r&&r.bottom),o=!1,u=this,a=s.getElementsByTagName("input")[0];if(a)CodeMirror.on(a,"keydown",function(e){if(13==e.keyCode||27==e.keyCode)CodeMirror.e_stop(e),i(),u.focus(),13==e.keyCode&&n(a.value)}),r&&r.value&&(a.value=r.value),a.focus(),CodeMirror.on(a,"blur",i);else if(t=s.getElementsByTagName("button")[0])CodeMirror.on(t,"click",function(){i(),u.focus()}),t.focus(),CodeMirror.on(t,"blur",i);return i}),CodeMirror.defineExtension("openConfirm",function(t,n,r){function i(){o||(o=!0,s.parentNode.removeChild(s),u.focus())}var s=e(this,t,r&&r.bottom),t=s.getElementsByTagName("button"),o=!1,u=this,a=1;t[0].focus();for(r=0;r<t.length;++r){var f=t[r];(function(e){CodeMirror.on(f,"click",function(t){CodeMirror.e_preventDefault(t),i(),e&&e(u)})})(n[r]),CodeMirror.on(f,"blur",function(){--a,setTimeout(function(){0>=a&&i()},200)}),CodeMirror.on(f,"focus",function(){++a})}})})();